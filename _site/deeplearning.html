<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Energy in the U.S. - Deep Learning for Time Series</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
if (typeof require !== 'undefined') {
require.undef("plotly");
requirejs.config({
    paths: {
        'plotly': ['https://cdn.plot.ly/plotly-2.20.0.min']
    }
});
require(['plotly'], function(Plotly) {
    window._Plotly = Plotly;
});
}
</script>



<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./deeplearning.html">Deep Learning for TS</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Energy in the U.S.</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./aboutme.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About Me</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Sources</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dataviz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Visualization</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploratory Data Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./arma_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ARMA/ARIMA/SARIMA Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ARIMAX/SARIMAX/VAR Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./financial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Financial Time Series Models (ARCH/GARCH)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./deeplearning.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Deep Learning for TS</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conclusions</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#co2-emissions" id="toc-co2-emissions" class="nav-link active" data-scroll-target="#co2-emissions">CO2 Emissions</a>
  <ul class="collapse">
  <li><a href="#coal" id="toc-coal" class="nav-link" data-scroll-target="#coal">Coal</a>
  <ul class="collapse">
  <li><a href="#split-data-into-training-and-testing-data" id="toc-split-data-into-training-and-testing-data" class="nav-link" data-scroll-target="#split-data-into-training-and-testing-data">Split data into training and testing data</a></li>
  <li><a href="#reformat-data-into-required-shape" id="toc-reformat-data-into-required-shape" class="nav-link" data-scroll-target="#reformat-data-into-required-shape">Reformat data into required shape</a></li>
  <li><a href="#model-1-rnn" id="toc-model-1-rnn" class="nav-link" data-scroll-target="#model-1-rnn">Model 1 = RNN</a></li>
  <li><a href="#model-2---gru" id="toc-model-2---gru" class="nav-link" data-scroll-target="#model-2---gru">Model 2 - GRU</a></li>
  <li><a href="#model-3---lstm" id="toc-model-3---lstm" class="nav-link" data-scroll-target="#model-3---lstm">Model 3 - LSTM</a></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion">Discussion</a></li>
  </ul></li>
  <li><a href="#hydro" id="toc-hydro" class="nav-link" data-scroll-target="#hydro">Hydro</a>
  <ul class="collapse">
  <li><a href="#split-data-into-training-and-testing-data-1" id="toc-split-data-into-training-and-testing-data-1" class="nav-link" data-scroll-target="#split-data-into-training-and-testing-data-1">Split data into training and testing data</a></li>
  <li><a href="#reformat-data-into-required-shape-1" id="toc-reformat-data-into-required-shape-1" class="nav-link" data-scroll-target="#reformat-data-into-required-shape-1">Reformat data into required shape</a></li>
  <li><a href="#model-1-rnn-1" id="toc-model-1-rnn-1" class="nav-link" data-scroll-target="#model-1-rnn-1">Model 1 = RNN</a></li>
  <li><a href="#model-2---gru-1" id="toc-model-2---gru-1" class="nav-link" data-scroll-target="#model-2---gru-1">Model 2 - GRU</a></li>
  <li><a href="#model-3---lstm-1" id="toc-model-3---lstm-1" class="nav-link" data-scroll-target="#model-3---lstm-1">Model 3 - LSTM</a></li>
  <li><a href="#discussion-1" id="toc-discussion-1" class="nav-link" data-scroll-target="#discussion-1">Discussion</a></li>
  </ul></li>
  <li><a href="#natural-gas" id="toc-natural-gas" class="nav-link" data-scroll-target="#natural-gas">Natural Gas</a>
  <ul class="collapse">
  <li><a href="#split-data-into-training-and-testing-data-2" id="toc-split-data-into-training-and-testing-data-2" class="nav-link" data-scroll-target="#split-data-into-training-and-testing-data-2">Split data into training and testing data</a></li>
  <li><a href="#reformat-data-into-required-shape-2" id="toc-reformat-data-into-required-shape-2" class="nav-link" data-scroll-target="#reformat-data-into-required-shape-2">Reformat data into required shape</a></li>
  <li><a href="#model-1-rnn-2" id="toc-model-1-rnn-2" class="nav-link" data-scroll-target="#model-1-rnn-2">Model 1 = RNN</a></li>
  <li><a href="#model-2---gru-2" id="toc-model-2---gru-2" class="nav-link" data-scroll-target="#model-2---gru-2">Model 2 - GRU</a></li>
  <li><a href="#model-3---lstm-2" id="toc-model-3---lstm-2" class="nav-link" data-scroll-target="#model-3---lstm-2">Model 3 - LSTM</a></li>
  <li><a href="#discussion-2" id="toc-discussion-2" class="nav-link" data-scroll-target="#discussion-2">Discussion</a></li>
  </ul></li>
  <li><a href="#petroleum" id="toc-petroleum" class="nav-link" data-scroll-target="#petroleum">Petroleum</a>
  <ul class="collapse">
  <li><a href="#split-data-into-training-and-testing-data-3" id="toc-split-data-into-training-and-testing-data-3" class="nav-link" data-scroll-target="#split-data-into-training-and-testing-data-3">Split data into training and testing data</a></li>
  <li><a href="#reformat-data-into-required-shape-3" id="toc-reformat-data-into-required-shape-3" class="nav-link" data-scroll-target="#reformat-data-into-required-shape-3">Reformat data into required shape</a></li>
  <li><a href="#model-1-rnn-3" id="toc-model-1-rnn-3" class="nav-link" data-scroll-target="#model-1-rnn-3">Model 1 = RNN</a></li>
  <li><a href="#model-2---gru-3" id="toc-model-2---gru-3" class="nav-link" data-scroll-target="#model-2---gru-3">Model 2 - GRU</a></li>
  <li><a href="#model-3---lstm-3" id="toc-model-3---lstm-3" class="nav-link" data-scroll-target="#model-3---lstm-3">Model 3 - LSTM</a></li>
  <li><a href="#discussion-3" id="toc-discussion-3" class="nav-link" data-scroll-target="#discussion-3">Discussion</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#comparison-of-deep-learning-to-traditional-ts-models" id="toc-comparison-of-deep-learning-to-traditional-ts-models" class="nav-link" data-scroll-target="#comparison-of-deep-learning-to-traditional-ts-models">Comparison of Deep Learning to Traditional TS Models</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Deep Learning for Time Series</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><img src="energy_header.png" class="img-fluid" style="width:100.0%"></p>
<p>Using univariate time series, I here use deep learning to extract insights about energy in the United States. I use a Recurrent Neural Network (RNN), a Gated Recurrent Unit (GRU) network, and a Long-Short Term Memory Network (LSTM) to make future predictions related to CO2 Emissions. This analysis is in Python.</p>
<p><strong>NOTE:</strong> NN analysis on CO2 emissions data only due to sample size limitations. Because all the other datasets are on a yearly frequency we have a maximum of 50 datapoints per energy source - not enough to build a model with.</p>
<p><strong>Packages used:</strong> pandas, numpy, plotly, matplotlib, tensorflow, keras, sklearn</p>
<section id="co2-emissions" class="level1">
<h1>CO2 Emissions</h1>
<p>Broken down by emissions by Coal, Hydro, Natural Gas, Petroleum, and Total source.</p>
<div class="cell" data-execution_count="2">
<div class="cell-output cell-output-stdout">
<pre><code>Coal observations:  (649, 1)
Hydro observations:  (649, 1)
Natural Gas observations:  (649, 1)
Petroleum observations:  (649, 1)</code></pre>
</div>
</div>
<section id="coal" class="level2">
<h2 class="anchored" data-anchor-id="coal">Coal</h2>
<section id="split-data-into-training-and-testing-data" class="level3">
<h3 class="anchored" data-anchor-id="split-data-into-training-and-testing-data">Split data into training and testing data</h3>
<p>And visualize split!</p>
<div class="cell" data-execution_count="6">
<div class="cell-output cell-output-stdout">
<pre><code>Training data size:  (519,)
Test data size:  (130,)</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="165007d7-bc22-40a3-ab83-e61837e77cba" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("165007d7-bc22-40a3-ab83-e61837e77cba")) {                    Plotly.newPlot(                        "165007d7-bc22-40a3-ab83-e61837e77cba",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518],"xaxis":"x","y":[0.20995867252349854,0.18275845050811768,0.18182122707366943,0.16993534564971924,0.17348599433898926,0.1829054355621338,0.1971607208251953,0.2028195858001709,0.18436527252197266,0.19166994094848633,0.19274020195007324,0.21107017993927002,0.8467828035354614,0.20714902877807617,0.18062496185302734,0.18459630012512207,0.1709212064743042,0.17977750301361084,0.175268292427063,0.19844567775726318,0.1990797519683838,0.17396998405456543,0.18643462657928467,0.1767488718032837,0.19263195991516113,0.8421190977096558,0.20526337623596191,0.1831376552581787,0.1902681589126587,0.17020738124847412,0.1656728982925415,0.17553210258483887,0.18994057178497314,0.19784057140350342,0.16990447044372559,0.17510318756103516,0.18150997161865234,0.20858049392700195,0.8411809206008911,0.21808147430419922,0.18619203567504883,0.19624018669128418,0.18420839309692383,0.1858065128326416,0.19501566886901855,0.21182310581207275,0.2140333652496338,0.19148898124694824,0.20189642906188965,0.21336066722869873,0.23449671268463135,0.859567403793335,0.2322371006011963,0.2011195421218872,0.20302999019622803,0.18183469772338867,0.1974489688873291,0.21048128604888916,0.23087942600250244,0.2248976230621338,0.2055577039718628,0.20350003242492676,0.20517492294311523,0.2213534116744995,0.8665963411331177,0.21761095523834229,0.17035317420959473,0.15870130062103271,0.17972612380981445,0.2007303237915039,0.21313190460205078,0.23049592971801758,0.2383817434310913,0.22436845302581787,0.21609342098236084,0.21611475944519043,0.23870837688446045,0.8662874698638916,0.2512766122817993,0.2203885316848755,0.22272861003875732,0.20755088329315186,0.2209465503692627,0.22945880889892578,0.24834871292114258,0.24998044967651367,0.22064566612243652,0.22670531272888184,0.22694969177246094,0.2509031295776367,0.888128399848938,0.259920597076416,0.24255776405334473,0.23853528499603271,0.20920276641845703,0.20975589752197266,0.22478139400482178,0.2548670768737793,0.25361084938049316,0.22971832752227783,0.2227400541305542,0.22857940196990967,0.2574986219406128,0.8929575681686401,0.2724018096923828,0.24000072479248047,0.24121379852294922,0.21650302410125732,0.21792006492614746,0.23787009716033936,0.27138710021972656,0.26562225818634033,0.2396625280380249,0.23693335056304932,0.2356128692626953,0.26123046875,0.9017386436462402,0.27709805965423584,0.24040484428405762,0.233373761177063,0.21020448207855225,0.2170013189315796,0.22156572341918945,0.2558457851409912,0.2550114393234253,0.22491133213043213,0.21747982501983643,0.22588694095611572,0.24114513397216797,0.8921005725860596,0.2524104118347168,0.21538102626800537,0.2186349630355835,0.20637786388397217,0.21362709999084473,0.2313913106918335,0.2778208255767822,0.29072701930999756,0.2537806034088135,0.24207353591918945,0.24625325202941895,0.28225743770599365,0.9020661115646362,0.28774237632751465,0.25334715843200684,0.26094233989715576,0.23611557483673096,0.24108529090881348,0.26686549186706543,0.2814364433288574,0.2925746440887451,0.25722646713256836,0.2584836483001709,0.2586100101470947,0.27327990531921387,0.9209167957305908,0.2956275939941406,0.26197004318237305,0.2580920457839966,0.24589359760284424,0.2573293447494507,0.2656515836715698,0.2925323247909546,0.2888448238372803,0.2645144462585449,0.25828075408935547,0.25738370418548584,0.29658472537994385,0.9272034168243408,0.3009589910507202,0.26359689235687256,0.2585197687149048,0.2351245880126953,0.245682954788208,0.27243220806121826,0.3026331663131714,0.27981626987457275,0.26055634021759033,0.2520056962966919,0.2535189390182495,0.27834057807922363,0.9241061210632324,0.28940582275390625,0.2528536319732666,0.25512123107910156,0.24666273593902588,0.26469099521636963,0.2880474328994751,0.31656336784362793,0.3148716688156128,0.2771952152252197,0.27057182788848877,0.26823246479034424,0.2965952157974243,0.9357558488845825,0.3101714849472046,0.28633034229278564,0.2781878709793091,0.256364107131958,0.2644360065460205,0.2969094514846802,0.32042622566223145,0.3299058675765991,0.2835655212402344,0.27998828887939453,0.27834248542785645,0.30769646167755127,0.9483156204223633,0.30749642848968506,0.29173922538757324,0.29017579555511475,0.26702094078063965,0.2745743989944458,0.2921316623687744,0.3133760690689087,0.31480681896209717,0.2880798578262329,0.28299009799957275,0.2850759029388428,0.32490992546081543,0.9513071775436401,0.3047553300857544,0.27343153953552246,0.284709095954895,0.2703282833099365,0.2754114866256714,0.2969249486923218,0.31846654415130615,0.32313108444213867,0.30253636837005615,0.29722845554351807,0.2854311466217041,0.3118114471435547,0.9523074626922607,0.32024049758911133,0.2730748653411865,0.27674055099487305,0.2566007375717163,0.2790710926055908,0.295282244682312,0.3185514211654663,0.3175487518310547,0.29332852363586426,0.28672730922698975,0.29511451721191406,0.3055121898651123,0.9502558708190918,0.3094445466995239,0.27976250648498535,0.29017579555511475,0.2721160650253296,0.27797365188598633,0.29060447216033936,0.3248302936553955,0.31422579288482666,0.29781007766723633,0.28915584087371826,0.28858888149261475,0.3135538101196289,0.9525768756866455,0.3116292953491211,0.291080117225647,0.3031657934188843,0.2746121883392334,0.27538323402404785,0.3046222925186157,0.3374905586242676,0.3359564542770386,0.2974501848220825,0.2966386079788208,0.2985835075378418,0.32115209102630615,0.9611079692840576,0.3348062038421631,0.2976301908493042,0.30091798305511475,0.27601873874664307,0.28741347789764404,0.32084810733795166,0.3320622444152832,0.3294506072998047,0.2990227937698364,0.2938871383666992,0.285097599029541,0.3087502717971802,0.9625844955444336,0.3177589178085327,0.2915002107620239,0.29151082038879395,0.271295428276062,0.2852827310562134,0.30703771114349365,0.340610146522522,0.3529766798019409,0.30783796310424805,0.29966235160827637,0.3044823408126831,0.3257652521133423,0.9653506278991699,0.3346978425979614,0.30891942977905273,0.30964457988739014,0.28310883045196533,0.3005845546722412,0.32036590576171875,0.34187746047973633,0.34386181831359863,0.3153057098388672,0.31582796573638916,0.3232097625732422,0.3368290662765503,0.9764940738677979,0.34611940383911133,0.3037445545196533,0.3089940547943115,0.2964128255844116,0.30141639709472656,0.319355845451355,0.353912353515625,0.34818077087402344,0.3277440071105957,0.32979869842529297,0.3215649127960205,0.345058798789978,0.9822995662689209,0.34179115295410156,0.3069040775299072,0.31657302379608154,0.2980813980102539,0.31919169425964355,0.3380746841430664,0.36130261421203613,0.36142635345458984,0.3342539072036743,0.32179081439971924,0.3079793453216553,0.33281445503234863,0.9854912757873535,0.3427191972732544,0.304435133934021,0.31725823879241943,0.3049236536026001,0.31504833698272705,0.3332880735397339,0.36574387550354004,0.3581608533859253,0.32983696460723877,0.32017993927001953,0.3128230571746826,0.3331732749938965,0.9852337837219238,0.35906195640563965,0.3341108560562134,0.3290131092071533,0.3032318353652954,0.32588493824005127,0.3465007543563843,0.3573974370956421,0.3666660785675049,0.3368798494338989,0.3344571590423584,0.33240222930908203,0.35381174087524414,0.9969038963317871,0.3563826084136963,0.31829380989074707,0.32700037956237793,0.30157148838043213,0.32103800773620605,0.3369408845901489,0.36171698570251465,0.36719584465026855,0.32669687271118164,0.3177173137664795,0.3091083765029907,0.3322066068649292,0.9884979724884033,0.33518922328948975,0.30353832244873047,0.3168160915374756,0.2998718023300171,0.3168755769729614,0.3372732400894165,0.36405789852142334,0.3612767457962036,0.34038209915161133,0.3320636749267578,0.328360915184021,0.349082350730896,0.989208459854126,0.35880541801452637,0.32726967334747314,0.32305896282196045,0.30142319202423096,0.31549501419067383,0.3356870412826538,0.3628751039505005,0.3660886287689209,0.3385225534439087,0.3296699523925781,0.3311554193496704,0.3565307855606079,0.9943387508392334,0.3602808713912964,0.33475494384765625,0.32276642322540283,0.30517613887786865,0.33214271068573,0.3441941738128662,0.36306285858154297,0.35921812057495117,0.33937788009643555,0.330804705619812,0.33255529403686523,0.36028361320495605,0.9973475933074951,0.35975897312164307,0.3276205062866211,0.33696627616882324,0.30545341968536377,0.32208120822906494,0.35036230087280273,0.3691432476043701,0.37072765827178955,0.3476516008377075,0.33613455295562744,0.3293955326080322,0.3593606948852539,1.0,0.34431159496307373,0.32631373405456543,0.3317674398422241,0.2987886667251587,0.32409560680389404,0.3439445495605469,0.36956143379211426,0.3720051050186157,0.3368663787841797,0.3366708755493164,0.3297419548034668,0.35064423084259033,0.9958310127258301,0.3555225133895874,0.33366429805755615,0.3279045820236206,0.3084530830383301,0.32547879219055176,0.3500630855560303,0.36650609970092773,0.3733295202255249,0.3442986011505127,0.33321094512939453,0.3296194076538086,0.35467052459716797,0.9989254474639893,0.3601115942001343,0.33846044540405273,0.3302241563796997,0.3100956678390503,0.32243430614471436,0.34671926498413086,0.368772029876709,0.362237811088562,0.3341047763824463,0.3196934461593628,0.3199273347854614,0.341985821723938,0.9949288368225098,0.3430180549621582,0.2946285009384155,0.2869921922683716,0.2658662796020508,0.27754461765289307,0.30582261085510254,0.32180511951446533,0.32922208309173584,0.2896127700805664,0.29370105266571045,0.28905045986175537,0.3355656862258911,0.9601913690567017,0.3441448211669922,0.31552886962890625,0.3043811321258545,0.27141761779785156,0.3014216423034668,0.33542776107788086,0.3558487892150879,0.3556002378463745,0.3129993677139282,0.28418707847595215,0.29058659076690674,0.33903348445892334,0.9753537178039551,0.3408203125,0.29092586040496826,0.2887946367263794,0.2664083242416382,0.2896592617034912,0.3222278356552124,0.34940671920776367,0.345302939414978,0.2998802661895752,0.27619504928588867,0.2668752670288086,0.2907198667526245,0.9602534770965576,0.27926409244537354,0.250665545463562,0.23032867908477783,0.20426487922668457,0.24915647506713867,0.2797255516052246,0.32624542713165283,0.31575512886047363,0.2719101905822754,0.2620631456375122,0.27487635612487793,0.2870751619338989],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648],"y":[0.9276576042175293,0.2926522493362427,0.2650904655456543,0.2766019105911255,0.24021363258361816,0.2557260990142822,0.2906097173690796,0.3159877061843872,0.31272971630096436,0.28366780281066895,0.26258933544158936,0.26069176197052,0.2993978261947632,0.937044620513916,0.31972837448120117,0.29662132263183594,0.2842599153518677,0.23025715351104736,0.253709077835083,0.2901473045349121,0.3130711317062378,0.3115243911743164,0.2721998691558838,0.24355971813201904,0.2575267553329468,0.2692919969558716,0.9363551139831543,0.2797921895980835,0.26351428031921387,0.23014330863952637,0.18319368362426758,0.2227400541305542,0.26870977878570557,0.2947458028793335,0.28515756130218506,0.2526588439941406,0.2076091766357422,0.18505501747131348,0.19176554679870605,0.8980154991149902,0.24162912368774414,0.19276583194732666,0.13733422756195068,0.1296464204788208,0.16329562664031982,0.24535417556762695,0.2845417261123657,0.282909631729126,0.24120962619781494,0.2089366912841797,0.178300142288208,0.2523385286331177,0.874406099319458,0.2442340850830078,0.17658209800720215,0.18127620220184326,0.15695953369140625,0.1903979778289795,0.22471749782562256,0.26759541034698486,0.25271403789520264,0.20762860774993896,0.1858673095703125,0.19058489799499512,0.22442102432250977,0.8670438528060913,0.2480231523513794,0.1635141372680664,0.15756595134735107,0.1349811553955078,0.17196738719940186,0.21218204498291016,0.24412178993225098,0.24386966228485107,0.20329487323760986,0.17803645133972168,0.19365990161895752,0.2117992639541626,0.8557004928588867,0.2114804983139038,0.15926861763000488,0.15507853031158447,0.08728659152984619,0.13080406188964844,0.15428483486175537,0.20989108085632324,0.1943899393081665,0.16872334480285645,0.11491966247558594,0.14061498641967773,0.13311052322387695,0.8138372898101807,0.11018502712249756,0.0779029130935669,0.054148077964782715,0.0,0.027698159217834473,0.10342586040496826,0.1769702434539795,0.180700421333313,0.11591291427612305,0.0868910551071167,0.08991289138793945,0.14753377437591553,0.7592010498046875,0.15835559368133545,0.17116427421569824,0.09573602676391602,0.05984032154083252,0.10055184364318848,0.17072820663452148,0.21122872829437256,0.21013927459716797,0.15153765678405762,0.10163688659667969,0.08114266395568848,0.09291946887969971,0.7947807312011719,0.17461299896240234,0.1266721487045288,0.09086084365844727,0.0637274980545044,0.09237051010131836,0.13614439964294434,0.1773989200592041,0.1715019941329956,0.10817575454711914,0.06997382640838623,0.07615208625793457,0.13539397716522217],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"t: time (months)"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y(t): Response variable"}},"legend":{"tracegroupgap":0},"title":{"text":"CO2 Emissions per month from Coal since 1973"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('165007d7-bc22-40a3-ab83-e61837e77cba');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="reformat-data-into-required-shape" class="level3">
<h3 class="anchored" data-anchor-id="reformat-data-into-required-shape">Reformat data into required shape</h3>
<p>Required shape = (samples, time, features)</p>
<div class="cell" data-execution_count="8">
<div class="cell-output cell-output-display">

<div>                            <div id="813ebd36-b4ee-4b0e-97dc-9dee6f7c6e93" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("813ebd36-b4ee-4b0e-97dc-9dee6f7c6e93")) {                    Plotly.newPlot(                        "813ebd36-b4ee-4b0e-97dc-9dee6f7c6e93",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8],"xaxis":"x","y":[0.18275845050811768,0.18182122707366943,0.16993534564971924,0.17348599433898926,0.1829054355621338,0.1971607208251953,0.2028195858001709,0.18436527252197266,0.19166994094848633],"yaxis":"y","type":"scatter"},{"x":[9],"y":[0.19274020195007324],"type":"scatter"},{"mode":"lines","x":[10,11,12,13,14,15,16,17,18],"y":[0.21107017993927002,0.8467828035354614,0.20714902877807617,0.18062496185302734,0.18459630012512207,0.1709212064743042,0.17977750301361084,0.175268292427063,0.19844567775726318],"type":"scatter"},{"x":[19],"y":[0.1990797519683838],"type":"scatter"},{"mode":"lines","x":[20,21,22,23,24,25,26,27,28],"y":[0.17396998405456543,0.18643462657928467,0.1767488718032837,0.19263195991516113,0.8421190977096558,0.20526337623596191,0.1831376552581787,0.1902681589126587,0.17020738124847412],"type":"scatter"},{"x":[29],"y":[0.1656728982925415],"type":"scatter"},{"mode":"lines","x":[30,31,32,33,34,35,36,37,38],"y":[0.17553210258483887,0.18994057178497314,0.19784057140350342,0.16990447044372559,0.17510318756103516,0.18150997161865234,0.20858049392700195,0.8411809206008911,0.21808147430419922],"type":"scatter"},{"x":[39],"y":[0.18619203567504883],"type":"scatter"},{"mode":"lines","x":[40,41,42,43,44,45,46,47,48],"y":[0.19624018669128418,0.18420839309692383,0.1858065128326416,0.19501566886901855,0.21182310581207275,0.2140333652496338,0.19148898124694824,0.20189642906188965,0.21336066722869873],"type":"scatter"},{"x":[49],"y":[0.23449671268463135],"type":"scatter"},{"mode":"lines","x":[50,51,52,53,54,55,56,57,58],"y":[0.859567403793335,0.2322371006011963,0.2011195421218872,0.20302999019622803,0.18183469772338867,0.1974489688873291,0.21048128604888916,0.23087942600250244,0.2248976230621338],"type":"scatter"},{"x":[59],"y":[0.2055577039718628],"type":"scatter"},{"mode":"lines","x":[60,61,62,63,64,65,66,67,68],"y":[0.20350003242492676,0.20517492294311523,0.2213534116744995,0.8665963411331177,0.21761095523834229,0.17035317420959473,0.15870130062103271,0.17972612380981445,0.2007303237915039],"type":"scatter"},{"x":[69],"y":[0.21313190460205078],"type":"scatter"},{"mode":"lines","x":[70,71,72,73,74,75,76,77,78],"y":[0.23049592971801758,0.2383817434310913,0.22436845302581787,0.21609342098236084,0.21611475944519043,0.23870837688446045,0.8662874698638916,0.2512766122817993,0.2203885316848755],"type":"scatter"},{"x":[79],"y":[0.22272861003875732],"type":"scatter"},{"mode":"lines","x":[80,81,82,83,84,85,86,87,88],"y":[0.20755088329315186,0.2209465503692627,0.22945880889892578,0.24834871292114258,0.24998044967651367,0.22064566612243652,0.22670531272888184,0.22694969177246094,0.2509031295776367],"type":"scatter"},{"x":[89],"y":[0.888128399848938],"type":"scatter"},{"mode":"lines","x":[90,91,92,93,94,95,96,97,98],"y":[0.259920597076416,0.24255776405334473,0.23853528499603271,0.20920276641845703,0.20975589752197266,0.22478139400482178,0.2548670768737793,0.25361084938049316,0.22971832752227783],"type":"scatter"},{"x":[99],"y":[0.2227400541305542],"type":"scatter"},{"mode":"lines","x":[100,101,102,103,104,105,106,107,108],"y":[0.22857940196990967,0.2574986219406128,0.8929575681686401,0.2724018096923828,0.24000072479248047,0.24121379852294922,0.21650302410125732,0.21792006492614746,0.23787009716033936],"type":"scatter"},{"x":[109],"y":[0.27138710021972656],"type":"scatter"},{"mode":"lines","x":[110,111,112,113,114,115,116,117,118],"y":[0.26562225818634033,0.2396625280380249,0.23693335056304932,0.2356128692626953,0.26123046875,0.9017386436462402,0.27709805965423584,0.24040484428405762,0.233373761177063],"type":"scatter"},{"x":[119],"y":[0.21020448207855225],"type":"scatter"},{"mode":"lines","x":[120,121,122,123,124,125,126,127,128],"y":[0.2170013189315796,0.22156572341918945,0.2558457851409912,0.2550114393234253,0.22491133213043213,0.21747982501983643,0.22588694095611572,0.24114513397216797,0.8921005725860596],"type":"scatter"},{"x":[129],"y":[0.2524104118347168],"type":"scatter"},{"mode":"lines","x":[130,131,132,133,134,135,136,137,138],"y":[0.21538102626800537,0.2186349630355835,0.20637786388397217,0.21362709999084473,0.2313913106918335,0.2778208255767822,0.29072701930999756,0.2537806034088135,0.24207353591918945],"type":"scatter"},{"x":[139],"y":[0.24625325202941895],"type":"scatter"},{"mode":"lines","x":[140,141,142,143,144,145,146,147,148],"y":[0.28225743770599365,0.9020661115646362,0.28774237632751465,0.25334715843200684,0.26094233989715576,0.23611557483673096,0.24108529090881348,0.26686549186706543,0.2814364433288574],"type":"scatter"},{"x":[149],"y":[0.2925746440887451],"type":"scatter"},{"mode":"lines","x":[150,151,152,153,154,155,156,157,158],"y":[0.25722646713256836,0.2584836483001709,0.2586100101470947,0.27327990531921387,0.9209167957305908,0.2956275939941406,0.26197004318237305,0.2580920457839966,0.24589359760284424],"type":"scatter"},{"x":[159],"y":[0.2573293447494507],"type":"scatter"},{"mode":"lines","x":[160,161,162,163,164,165,166,167,168],"y":[0.2656515836715698,0.2925323247909546,0.2888448238372803,0.2645144462585449,0.25828075408935547,0.25738370418548584,0.29658472537994385,0.9272034168243408,0.3009589910507202],"type":"scatter"},{"x":[169],"y":[0.26359689235687256],"type":"scatter"},{"mode":"lines","x":[170,171,172,173,174,175,176,177,178],"y":[0.2585197687149048,0.2351245880126953,0.245682954788208,0.27243220806121826,0.3026331663131714,0.27981626987457275,0.26055634021759033,0.2520056962966919,0.2535189390182495],"type":"scatter"},{"x":[179],"y":[0.27834057807922363],"type":"scatter"},{"mode":"lines","x":[180,181,182,183,184,185,186,187,188],"y":[0.9241061210632324,0.28940582275390625,0.2528536319732666,0.25512123107910156,0.24666273593902588,0.26469099521636963,0.2880474328994751,0.31656336784362793,0.3148716688156128],"type":"scatter"},{"x":[189],"y":[0.2771952152252197],"type":"scatter"},{"mode":"lines","x":[190,191,192,193,194,195,196,197,198],"y":[0.27057182788848877,0.26823246479034424,0.2965952157974243,0.9357558488845825,0.3101714849472046,0.28633034229278564,0.2781878709793091,0.256364107131958,0.2644360065460205],"type":"scatter"},{"x":[199],"y":[0.2969094514846802],"type":"scatter"},{"mode":"lines","x":[200,201,202,203,204,205,206,207,208],"y":[0.32042622566223145,0.3299058675765991,0.2835655212402344,0.27998828887939453,0.27834248542785645,0.30769646167755127,0.9483156204223633,0.30749642848968506,0.29173922538757324],"type":"scatter"},{"x":[209],"y":[0.29017579555511475],"type":"scatter"},{"mode":"lines","x":[210,211,212,213,214,215,216,217,218],"y":[0.26702094078063965,0.2745743989944458,0.2921316623687744,0.3133760690689087,0.31480681896209717,0.2880798578262329,0.28299009799957275,0.2850759029388428,0.32490992546081543],"type":"scatter"},{"x":[219],"y":[0.9513071775436401],"type":"scatter"},{"mode":"lines","x":[220,221,222,223,224,225,226,227,228],"y":[0.3047553300857544,0.27343153953552246,0.284709095954895,0.2703282833099365,0.2754114866256714,0.2969249486923218,0.31846654415130615,0.32313108444213867,0.30253636837005615],"type":"scatter"},{"x":[229],"y":[0.29722845554351807],"type":"scatter"},{"mode":"lines","x":[230,231,232,233,234,235,236,237,238],"y":[0.2854311466217041,0.3118114471435547,0.9523074626922607,0.32024049758911133,0.2730748653411865,0.27674055099487305,0.2566007375717163,0.2790710926055908,0.295282244682312],"type":"scatter"},{"x":[239],"y":[0.3185514211654663],"type":"scatter"},{"mode":"lines","x":[240,241,242,243,244,245,246,247,248],"y":[0.3175487518310547,0.29332852363586426,0.28672730922698975,0.29511451721191406,0.3055121898651123,0.9502558708190918,0.3094445466995239,0.27976250648498535,0.29017579555511475],"type":"scatter"},{"x":[249],"y":[0.2721160650253296],"type":"scatter"},{"mode":"lines","x":[250,251,252,253,254,255,256,257,258],"y":[0.27797365188598633,0.29060447216033936,0.3248302936553955,0.31422579288482666,0.29781007766723633,0.28915584087371826,0.28858888149261475,0.3135538101196289,0.9525768756866455],"type":"scatter"},{"x":[259],"y":[0.3116292953491211],"type":"scatter"},{"mode":"lines","x":[260,261,262,263,264,265,266,267,268],"y":[0.291080117225647,0.3031657934188843,0.2746121883392334,0.27538323402404785,0.3046222925186157,0.3374905586242676,0.3359564542770386,0.2974501848220825,0.2966386079788208],"type":"scatter"},{"x":[269],"y":[0.2985835075378418],"type":"scatter"},{"mode":"lines","x":[270,271,272,273,274,275,276,277,278],"y":[0.32115209102630615,0.9611079692840576,0.3348062038421631,0.2976301908493042,0.30091798305511475,0.27601873874664307,0.28741347789764404,0.32084810733795166,0.3320622444152832],"type":"scatter"},{"x":[279],"y":[0.3294506072998047],"type":"scatter"},{"mode":"lines","x":[280,281,282,283,284,285,286,287,288],"y":[0.2990227937698364,0.2938871383666992,0.285097599029541,0.3087502717971802,0.9625844955444336,0.3177589178085327,0.2915002107620239,0.29151082038879395,0.271295428276062],"type":"scatter"},{"x":[289],"y":[0.2852827310562134],"type":"scatter"},{"mode":"lines","x":[290,291,292,293,294,295,296,297,298],"y":[0.30703771114349365,0.340610146522522,0.3529766798019409,0.30783796310424805,0.29966235160827637,0.3044823408126831,0.3257652521133423,0.9653506278991699,0.3346978425979614],"type":"scatter"},{"x":[299],"y":[0.30891942977905273],"type":"scatter"},{"mode":"lines","x":[300,301,302,303,304,305,306,307,308],"y":[0.30964457988739014,0.28310883045196533,0.3005845546722412,0.32036590576171875,0.34187746047973633,0.34386181831359863,0.3153057098388672,0.31582796573638916,0.3232097625732422],"type":"scatter"},{"x":[309],"y":[0.3368290662765503],"type":"scatter"},{"mode":"lines","x":[310,311,312,313,314,315,316,317,318],"y":[0.9764940738677979,0.34611940383911133,0.3037445545196533,0.3089940547943115,0.2964128255844116,0.30141639709472656,0.319355845451355,0.353912353515625,0.34818077087402344],"type":"scatter"},{"x":[319],"y":[0.3277440071105957],"type":"scatter"},{"mode":"lines","x":[320,321,322,323,324,325,326,327,328],"y":[0.32979869842529297,0.3215649127960205,0.345058798789978,0.9822995662689209,0.34179115295410156,0.3069040775299072,0.31657302379608154,0.2980813980102539,0.31919169425964355],"type":"scatter"},{"x":[329],"y":[0.3380746841430664],"type":"scatter"},{"mode":"lines","x":[330,331,332,333,334,335,336,337,338],"y":[0.36130261421203613,0.36142635345458984,0.3342539072036743,0.32179081439971924,0.3079793453216553,0.33281445503234863,0.9854912757873535,0.3427191972732544,0.304435133934021],"type":"scatter"},{"x":[339],"y":[0.31725823879241943],"type":"scatter"},{"mode":"lines","x":[340,341,342,343,344,345,346,347,348],"y":[0.3049236536026001,0.31504833698272705,0.3332880735397339,0.36574387550354004,0.3581608533859253,0.32983696460723877,0.32017993927001953,0.3128230571746826,0.3331732749938965],"type":"scatter"},{"x":[349],"y":[0.9852337837219238],"type":"scatter"},{"mode":"lines","x":[350,351,352,353,354,355,356,357,358],"y":[0.35906195640563965,0.3341108560562134,0.3290131092071533,0.3032318353652954,0.32588493824005127,0.3465007543563843,0.3573974370956421,0.3666660785675049,0.3368798494338989],"type":"scatter"},{"x":[359],"y":[0.3344571590423584],"type":"scatter"},{"mode":"lines","x":[360,361,362,363,364,365,366,367,368],"y":[0.33240222930908203,0.35381174087524414,0.9969038963317871,0.3563826084136963,0.31829380989074707,0.32700037956237793,0.30157148838043213,0.32103800773620605,0.3369408845901489],"type":"scatter"},{"x":[369],"y":[0.36171698570251465],"type":"scatter"},{"mode":"lines","x":[370,371,372,373,374,375,376,377,378],"y":[0.36719584465026855,0.32669687271118164,0.3177173137664795,0.3091083765029907,0.3322066068649292,0.9884979724884033,0.33518922328948975,0.30353832244873047,0.3168160915374756],"type":"scatter"},{"x":[379],"y":[0.2998718023300171],"type":"scatter"},{"mode":"lines","x":[380,381,382,383,384,385,386,387,388],"y":[0.3168755769729614,0.3372732400894165,0.36405789852142334,0.3612767457962036,0.34038209915161133,0.3320636749267578,0.328360915184021,0.349082350730896,0.989208459854126],"type":"scatter"},{"x":[389],"y":[0.35880541801452637],"type":"scatter"},{"mode":"lines","x":[390,391,392,393,394,395,396,397,398],"y":[0.32726967334747314,0.32305896282196045,0.30142319202423096,0.31549501419067383,0.3356870412826538,0.3628751039505005,0.3660886287689209,0.3385225534439087,0.3296699523925781],"type":"scatter"},{"x":[399],"y":[0.3311554193496704],"type":"scatter"},{"mode":"lines","x":[400,401,402,403,404,405,406,407,408],"y":[0.3565307855606079,0.9943387508392334,0.3602808713912964,0.33475494384765625,0.32276642322540283,0.30517613887786865,0.33214271068573,0.3441941738128662,0.36306285858154297],"type":"scatter"},{"x":[409],"y":[0.35921812057495117],"type":"scatter"},{"mode":"lines","x":[410,411,412,413,414,415,416,417,418],"y":[0.33937788009643555,0.330804705619812,0.33255529403686523,0.36028361320495605,0.9973475933074951,0.35975897312164307,0.3276205062866211,0.33696627616882324,0.30545341968536377],"type":"scatter"},{"x":[419],"y":[0.32208120822906494],"type":"scatter"},{"mode":"lines","x":[420,421,422,423,424,425,426,427,428],"y":[0.35036230087280273,0.3691432476043701,0.37072765827178955,0.3476516008377075,0.33613455295562744,0.3293955326080322,0.3593606948852539,1.0,0.34431159496307373],"type":"scatter"},{"x":[429],"y":[0.32631373405456543],"type":"scatter"},{"mode":"lines","x":[430,431,432,433,434,435,436,437,438],"y":[0.3317674398422241,0.2987886667251587,0.32409560680389404,0.3439445495605469,0.36956143379211426,0.3720051050186157,0.3368663787841797,0.3366708755493164,0.3297419548034668],"type":"scatter"},{"x":[439],"y":[0.35064423084259033],"type":"scatter"},{"mode":"lines","x":[440,441,442,443,444,445,446,447,448],"y":[0.9958310127258301,0.3555225133895874,0.33366429805755615,0.3279045820236206,0.3084530830383301,0.32547879219055176,0.3500630855560303,0.36650609970092773,0.3733295202255249],"type":"scatter"},{"x":[449],"y":[0.3442986011505127],"type":"scatter"},{"mode":"lines","x":[450,451,452,453,454,455,456,457,458],"y":[0.33321094512939453,0.3296194076538086,0.35467052459716797,0.9989254474639893,0.3601115942001343,0.33846044540405273,0.3302241563796997,0.3100956678390503,0.32243430614471436],"type":"scatter"},{"x":[459],"y":[0.34671926498413086],"type":"scatter"},{"mode":"lines","x":[460,461,462,463,464,465,466,467,468],"y":[0.368772029876709,0.362237811088562,0.3341047763824463,0.3196934461593628,0.3199273347854614,0.341985821723938,0.9949288368225098,0.3430180549621582,0.2946285009384155],"type":"scatter"},{"x":[469],"y":[0.2869921922683716],"type":"scatter"},{"mode":"lines","x":[470,471,472,473,474,475,476,477,478],"y":[0.2658662796020508,0.27754461765289307,0.30582261085510254,0.32180511951446533,0.32922208309173584,0.2896127700805664,0.29370105266571045,0.28905045986175537,0.3355656862258911],"type":"scatter"},{"x":[479],"y":[0.9601913690567017],"type":"scatter"},{"mode":"lines","x":[480,481,482,483,484,485,486,487,488],"y":[0.3441448211669922,0.31552886962890625,0.3043811321258545,0.27141761779785156,0.3014216423034668,0.33542776107788086,0.3558487892150879,0.3556002378463745,0.3129993677139282],"type":"scatter"},{"x":[489],"y":[0.28418707847595215],"type":"scatter"},{"mode":"lines","x":[490,491,492,493,494,495,496,497,498],"y":[0.29058659076690674,0.33903348445892334,0.9753537178039551,0.3408203125,0.29092586040496826,0.2887946367263794,0.2664083242416382,0.2896592617034912,0.3222278356552124],"type":"scatter"},{"x":[499],"y":[0.34940671920776367],"type":"scatter"},{"mode":"lines","x":[500,501,502,503,504,505,506,507,508],"y":[0.345302939414978,0.2998802661895752,0.27619504928588867,0.2668752670288086,0.2907198667526245,0.9602534770965576,0.27926409244537354,0.250665545463562,0.23032867908477783],"type":"scatter"},{"x":[509],"y":[0.20426487922668457],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"t: time (months)"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y(t): Response variable"}},"legend":{"tracegroupgap":0},"title":{"text":"CO2 Emissions per month from Coal since 1973"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('813ebd36-b4ee-4b0e-97dc-9dee6f7c6e93');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="model-1-rnn" class="level3">
<h3 class="anchored" data-anchor-id="model-1-rnn">Model 1 = RNN</h3>
<section id="model-architecture" class="level4">
<h4 class="anchored" data-anchor-id="model-architecture">Model architecture</h4>
<div class="cell" data-execution_count="10">
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 simple_rnn (SimpleRNN)      (None, 3)                 15        
                                                                 
 dense (Dense)               (None, 1)                 4         
                                                                 
=================================================================
Total params: 19
Trainable params: 19
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-04-30 23:41:10.947038: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.</code></pre>
</div>
</div>
</section>
<section id="plot-training-and-validation-loss-mse" class="level4">
<h4 class="anchored" data-anchor-id="plot-training-and-validation-loss-mse">Plot training and validation loss (MSE)</h4>
<div class="cell" data-execution_count="12">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 17ms/step
(51, 9, 1) (51,) (51,) (12, 9, 1) (12,) (12,)
(51,) (51,)
0.035081297
0.02046974
Train MSE = 0.03508 RMSE = 0.18730
Test MSE = 0.02047 RMSE = 0.14307</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="9482ba86-b8e4-4f6a-9025-5a3223b19bb3" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("9482ba86-b8e4-4f6a-9025-5a3223b19bb3")) {                    Plotly.newPlot(                        "9482ba86-b8e4-4f6a-9025-5a3223b19bb3",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"xaxis":"x","y":[0.15733401477336884,0.15040156245231628,0.14507648348808289,0.1400565356016159,0.1362883746623993,0.13232092559337616,0.12875321507453918,0.12501990795135498,0.12117563188076019,0.11716558784246445,0.11297434568405151,0.10874953120946884,0.10455620288848877,0.10034563392400742,0.09607955068349838,0.09188699722290039,0.08762829750776291,0.08379971235990524,0.08005638420581818,0.07689932733774185,0.074265256524086,0.07190992683172226,0.07034353911876678,0.06893715262413025,0.06809467822313309,0.06770040839910507,0.06711631268262863,0.06712330877780914,0.06684016436338425,0.0666094422340393,0.06653785705566406,0.06609150022268295,0.06614895164966583,0.0659593865275383,0.06557486951351166,0.06574270874261856,0.06534554064273834,0.06504000723361969,0.06492689251899719,0.0649590939283371,0.06506694853305817,0.06456975638866425,0.06436409056186676,0.06452052295207977,0.06432389467954636,0.06389361619949341,0.06427941471338272,0.06360212713479996,0.0635121762752533,0.06383627653121948,0.0635211169719696,0.06328798085451126,0.06333242356777191,0.06323017179965973,0.06276334077119827,0.06296676397323608,0.06283639371395111,0.06265319138765335,0.062285907566547394,0.06249339133501053,0.06240667775273323,0.06233573704957962,0.06212310865521431,0.06206636503338814,0.0616476833820343,0.06204010173678398,0.06184039264917374,0.06178318336606026,0.06131701543927193,0.06186865642666817,0.06154432147741318,0.0610363706946373,0.06099725887179375,0.06102610379457474,0.060994915664196014,0.0606045126914978,0.06092676520347595,0.06044161319732666,0.06035662814974785,0.060536883771419525,0.060143373906612396,0.060462404042482376,0.06000794842839241,0.06031091883778572,0.05975140258669853,0.0596877820789814,0.059577733278274536,0.05952191352844238,0.05959852412343025,0.05952838063240051,0.0594310536980629,0.05946265906095505,0.05912775918841362,0.059135936200618744,0.05891305208206177,0.05863650515675545,0.05871681496500969,0.05854339152574539,0.05851316452026367,0.05871813744306564,0.05815238505601883,0.058296866714954376,0.05804373696446419,0.058009468019008636,0.05820887163281441,0.057644885033369064,0.05767188221216202,0.05758315324783325,0.05760449171066284,0.057260990142822266,0.057146329432725906,0.05725222826004028,0.057161785662174225,0.0572533905506134,0.05692122504115105,0.056577615439891815,0.05686277151107788,0.05648869276046753,0.05641605332493782,0.056325774639844894,0.056413840502500534,0.05616447329521179,0.05604643374681473,0.056100033223629,0.05597926303744316,0.05596693605184555,0.05584510415792465,0.05545300245285034,0.056301914155483246,0.05552065372467041,0.05542531609535217,0.05513160303235054,0.055145569145679474,0.055198073387145996,0.05485709384083748,0.05515451356768608,0.054644953459501266,0.054784052073955536,0.054524004459381104,0.0546860471367836,0.05481104925274849,0.05431029945611954,0.05424095317721367,0.054074645042419434,0.054179348051548004,0.054675351828336716,0.053997673094272614,0.05430705472826958,0.05379543453454971,0.053717005997896194,0.053492963314056396,0.05364592745900154,0.05340049788355827,0.053380198776721954,0.053190380334854126,0.05379459261894226,0.05303638055920601,0.05309788137674332,0.053015999495983124,0.0527871735394001,0.05295088142156601,0.05284455418586731,0.052502311766147614,0.05243152379989624,0.052513040602207184,0.052178025245666504,0.052485931664705276,0.051956284791231155,0.05199725180864334,0.05212453752756119,0.05169449374079704,0.05166233703494072,0.05171781778335571,0.051797159016132355,0.051625531166791916,0.05134154111146927,0.05132751539349556,0.05105770751833916,0.05115141719579697,0.05109073966741562,0.0510907843708992,0.05082368105649948,0.05079032853245735,0.05070408433675766,0.05043623596429825,0.05050857737660408,0.0504877083003521,0.05031384900212288,0.050237275660037994,0.049954432994127274,0.05010712146759033,0.050102341920137405,0.04983045533299446,0.0497344434261322,0.049750760197639465,0.04934188723564148,0.04948698729276657,0.04940055310726166,0.0492570698261261,0.0490141436457634],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"y":[0.18717898428440094,0.1800670623779297,0.17404404282569885,0.1686733365058899,0.16433709859848022,0.15967148542404175,0.15527570247650146,0.15043960511684418,0.14540690183639526,0.14035636186599731,0.13509973883628845,0.13006140291690826,0.1249094232916832,0.11894390732049942,0.1130477637052536,0.10693781822919846,0.10132460296154022,0.09619178622961044,0.09121498465538025,0.08724027127027512,0.08369015902280807,0.08075869828462601,0.07836564630270004,0.07664844393730164,0.07529332488775253,0.07436732202768326,0.07393140345811844,0.07374561578035355,0.07330919057130814,0.07292037457227707,0.07268474996089935,0.07260654866695404,0.07258322834968567,0.07224993407726288,0.0720708891749382,0.0719195082783699,0.07170964777469635,0.07150109112262726,0.07124455273151398,0.0710810124874115,0.07105088233947754,0.07104121148586273,0.07070892304182053,0.07056861370801926,0.07048625499010086,0.07030849903821945,0.0701727643609047,0.07001353800296783,0.06980690360069275,0.06969447433948517,0.06952279061079025,0.06951196491718292,0.06935218721628189,0.06929074227809906,0.06926291435956955,0.06896805018186569,0.06892356276512146,0.06874753534793854,0.06857497990131378,0.0685994103550911,0.0686359852552414,0.06844406574964523,0.06829230487346649,0.06813908368349075,0.06810417026281357,0.06799107044935226,0.06782758980989456,0.06776260584592819,0.06766514480113983,0.06767385452985764,0.0676754042506218,0.06747608631849289,0.06741786748170853,0.06724032014608383,0.0670519769191742,0.06697442382574081,0.0669742301106453,0.06676577776670456,0.06643441319465637,0.06632640957832336,0.06615319103002548,0.06616813689470291,0.0660979226231575,0.06612177938222885,0.06608879566192627,0.06579765677452087,0.06570839136838913,0.06568792462348938,0.06575793772935867,0.06564345955848694,0.06550261378288269,0.06543327867984772,0.0650976225733757,0.06495450437068939,0.06488966196775436,0.0649009421467781,0.0646776631474495,0.06451288610696793,0.06449918448925018,0.06446465849876404,0.06441682577133179,0.06428276747465134,0.0642254576086998,0.06411846727132797,0.06406206637620926,0.0639675185084343,0.06378445029258728,0.06374214589595795,0.0636068657040596,0.06319299340248108,0.06329827755689621,0.06298103928565979,0.06286006420850754,0.06271009892225266,0.06260306388139725,0.0624227412045002,0.062472712248563766,0.06227665767073631,0.06210608407855034,0.06203713268041611,0.06194355711340904,0.06203712150454521,0.061769191175699234,0.061571333557367325,0.06168706342577934,0.06161709129810333,0.061497677117586136,0.061329230666160583,0.061488762497901917,0.061304714530706406,0.06099757179617882,0.06098416820168495,0.06101329252123833,0.0611550435423851,0.06076665222644806,0.06069439277052879,0.060668766498565674,0.06033610180020332,0.060330379754304886,0.06047545373439789,0.060260891914367676,0.060150325298309326,0.05997908487915993,0.05990656837821007,0.05970986932516098,0.059876784682273865,0.059603068977594376,0.0596710667014122,0.05943446233868599,0.05926782265305519,0.05934162437915802,0.05918543413281441,0.05912432447075844,0.0589495450258255,0.058875322341918945,0.058925140649080276,0.05868256092071533,0.05849064886569977,0.05866927281022072,0.05861514434218407,0.05852808058261871,0.058511730283498764,0.05817040428519249,0.058096643537282944,0.05786075443029404,0.05764390155673027,0.057624414563179016,0.05751892551779747,0.05772758647799492,0.057700302451848984,0.0573459230363369,0.05713127553462982,0.05709487572312355,0.05700031667947769,0.05724117532372475,0.05697448551654816,0.05703803151845932,0.05668070167303085,0.056478533893823624,0.05641065910458565,0.056425515562295914,0.05649207904934883,0.056294843554496765,0.0563075914978981,0.056204941123723984,0.05603696405887604,0.05599358305335045,0.05567921698093414,0.05558966100215912,0.05557139217853546,0.05563416704535484,0.0555003322660923,0.055401504039764404,0.05517112836241722,0.05520845949649811,0.05518953874707222,0.054999351501464844,0.05477704107761383,0.054834332317113876,0.05466756969690323],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"training epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training and Validation Loss - RNN"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('9482ba86-b8e4-4f6a-9025-5a3223b19bb3');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="forecasting---next-5-years-60-months" class="level4">
<h4 class="anchored" data-anchor-id="forecasting---next-5-years-60-months">Forecasting - next 5 years (60 months)</h4>
<div class="cell" data-execution_count="13">
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 18ms/step</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="deeplearning_files/figure-html/cell-14-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="model-2---gru" class="level3">
<h3 class="anchored" data-anchor-id="model-2---gru">Model 2 - GRU</h3>
<section id="model-architecture-1" class="level4">
<h4 class="anchored" data-anchor-id="model-architecture-1">Model Architecture</h4>
<div class="cell" data-execution_count="14">
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_1"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 gru (GRU)                   (None, 3)                 54        
                                                                 
 dense_1 (Dense)             (None, 1)                 4         
                                                                 
=================================================================
Total params: 58
Trainable params: 58
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="plot-training-and-validation-loss" class="level4">
<h4 class="anchored" data-anchor-id="plot-training-and-validation-loss">Plot training and validation loss</h4>
<div class="cell" data-execution_count="16">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 16ms/step
(51, 9, 1) (51,) (51,) (5, 9, 1) (5,) (5,)
(51,) (51,)
0.03370281
0.034062225
Train MSE = 0.03370 RMSE = 0.18358
Test MSE = 0.03406 RMSE = 0.18456</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="3a3b4a69-354a-437b-ad6b-e003b27215ac" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("3a3b4a69-354a-437b-ad6b-e003b27215ac")) {                    Plotly.newPlot(                        "3a3b4a69-354a-437b-ad6b-e003b27215ac",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"xaxis":"x","y":[0.24890956282615662,0.21126632392406464,0.1878516674041748,0.16910764575004578,0.1532275676727295,0.13937196135520935,0.12674054503440857,0.11551760137081146,0.10548758506774902,0.09627972543239594,0.08811642229557037,0.08080144226551056,0.07483331859111786,0.06969429552555084,0.06535609066486359,0.062031012028455734,0.0593770369887352,0.057238899171352386,0.05597095936536789,0.05491980165243149,0.05429111048579216,0.05382738634943962,0.05321232229471207,0.05282267928123474,0.05217037722468376,0.05211198329925537,0.05156613513827324,0.05142848938703537,0.05117048695683479,0.050475746393203735,0.05018280819058418,0.04990629106760025,0.04933091998100281,0.04890810325741768,0.048609133809804916,0.04879477620124817,0.04806482419371605,0.047544579952955246,0.04750434681773186,0.04746047407388687,0.047642000019550323,0.046541471034288406,0.04608761519193649,0.046262603253126144,0.045845989137887955,0.045336224138736725,0.04516834765672684,0.04466641694307327,0.04451313987374306,0.04475495219230652,0.04393990710377693,0.04441412165760994,0.043632227927446365,0.043400295078754425,0.04327832907438278,0.04268723353743553,0.04248235747218132,0.04267521947622299,0.042365849018096924,0.041893940418958664,0.041965000331401825,0.04171594977378845,0.04129533842206001,0.04117920249700546,0.04078573361039162,0.040580134838819504,0.040697552263736725,0.04019806534051895,0.04015267640352249,0.040043897926807404,0.03956064581871033,0.039393119513988495,0.039720434695482254,0.0392351970076561,0.03893432021141052,0.03905680030584335,0.03884055092930794,0.03863319009542465,0.038455795496702194,0.03834937885403633,0.03795958310365677,0.03786018490791321,0.03775773569941521,0.0377802848815918,0.03754229098558426,0.03759989142417908,0.03766089677810669,0.037174202501773834,0.03692962974309921,0.03704265505075455,0.03659375384449959,0.036820072680711746,0.03657081350684166,0.03643118217587471,0.03647034615278244,0.03621993213891983,0.03619661554694176,0.03601774945855141,0.036041855812072754,0.035659581422805786,0.03586871176958084,0.03541259840130806,0.03539339825510979,0.035705916583538055,0.035124994814395905,0.03576311096549034,0.03532217815518379,0.03515952080488205,0.03518156707286835,0.03502039983868599,0.034972697496414185,0.03458951786160469,0.03480261564254761,0.034455932676792145,0.03483493998646736,0.034472718834877014,0.0346149317920208,0.034183669835329056,0.03436218574643135,0.03432125598192215,0.03430904820561409,0.03436188027262688,0.03427179157733917,0.03413381427526474,0.03476223349571228,0.03394680470228195,0.03377671167254448,0.033770762383937836,0.03394737467169762,0.03366450220346451,0.033696383237838745,0.03361431881785393,0.03370622545480728,0.03366188332438469,0.033897288143634796,0.033719055354595184,0.03373550623655319,0.03386782482266426,0.03341267630457878,0.033966727554798126,0.03337082639336586,0.033569540828466415,0.03341338038444519,0.03331323340535164,0.033305324614048004,0.03370095044374466,0.0334930382668972,0.03323204815387726,0.03374537080526352,0.03322296962141991,0.03313172608613968,0.03318735957145691,0.03326772525906563,0.03325239568948746,0.03315270319581032,0.03335215896368027,0.03308533877134323,0.03343210369348526,0.03329368308186531,0.033233944326639175,0.03304825350642204,0.032994382083415985,0.03330496698617935,0.03323686867952347,0.03359299525618553,0.03303017094731331,0.033227432519197464,0.032980985939502716,0.03334242105484009,0.0331665500998497,0.032952405512332916,0.03316708654165268,0.03318604826927185,0.032991111278533936,0.032942034304142,0.03311856836080551,0.032876405864953995,0.033270351588726044,0.033054303377866745,0.033194512128829956,0.03292319178581238,0.03298240154981613,0.03320735692977905,0.033004458993673325,0.03315354138612747,0.03322788327932358,0.033031634986400604,0.03288014978170395,0.033059172332286835,0.03312832489609718,0.03295009955763817,0.03305227309465408,0.0331345871090889,0.03341418132185936,0.033085428178310394,0.03309316188097,0.03291802108287811,0.03303467482328415,0.03279208764433861,0.03346524387598038],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"y":[0.27572691440582275,0.24471798539161682,0.22105655074119568,0.20072832703590393,0.1833598017692566,0.16741685569286346,0.1528356671333313,0.139841690659523,0.12772010266780853,0.11650008708238602,0.10626313090324402,0.09745181351900101,0.08973249793052673,0.0828847587108612,0.07708323746919632,0.07247456908226013,0.06822982430458069,0.06528694182634354,0.06291968375444412,0.06113046035170555,0.05971347913146019,0.059116996824741364,0.05789012834429741,0.05764506012201309,0.05681389942765236,0.05638029798865318,0.055524539202451706,0.05534135922789574,0.05499200522899628,0.05489165708422661,0.05460285022854805,0.054137445986270905,0.0539107546210289,0.053260114043951035,0.05266150087118149,0.05239367485046387,0.05241335928440094,0.0518530048429966,0.051738180220127106,0.05130202695727348,0.051118914037942886,0.05101078376173973,0.050856590270996094,0.05081378296017647,0.05044567212462425,0.050232913345098495,0.05001477897167206,0.04941295459866524,0.04915190115571022,0.04874227195978165,0.04871630668640137,0.048681166023015976,0.04839886724948883,0.04806472361087799,0.04805856943130493,0.04779821261763573,0.04721687734127045,0.04696207866072655,0.04693085327744484,0.046818193048238754,0.046442341059446335,0.045888032764196396,0.04553508386015892,0.04551081731915474,0.04537304863333702,0.045160189270973206,0.04491366073489189,0.04461578652262688,0.04443088546395302,0.04433831200003624,0.04436063766479492,0.043908730149269104,0.04393351450562477,0.04372482746839523,0.04333063215017319,0.04334155097603798,0.04356394708156586,0.04322586953639984,0.04314303770661354,0.0428791418671608,0.04248812049627304,0.04229993000626564,0.04214117303490639,0.04205941781401634,0.04202742502093315,0.041794247925281525,0.04180988296866417,0.04191570729017258,0.041672494262456894,0.04140132665634155,0.04113981872797012,0.04126707836985588,0.041216250509023666,0.041172996163368225,0.04085537791252136,0.04048304259777069,0.040405552834272385,0.04069652780890465,0.04040941223502159,0.040305398404598236,0.04022718966007233,0.04033501446247101,0.04020898789167404,0.040173888206481934,0.04021287336945534,0.0403694249689579,0.040098223835229874,0.04013108089566231,0.03986793011426926,0.0396215058863163,0.0395258292555809,0.03946903347969055,0.03931553661823273,0.03931345045566559,0.03921492025256157,0.03928210586309433,0.03891336917877197,0.0389774851500988,0.03918325528502464,0.038762059062719345,0.03892432153224945,0.03864258900284767,0.03875826299190521,0.0384756401181221,0.03867795690894127,0.038736741989851,0.03856940567493439,0.03849143907427788,0.03877745941281319,0.038782183080911636,0.03828568011522293,0.0381576269865036,0.038126591593027115,0.03852158412337303,0.0386822335422039,0.038660671561956406,0.03832358494400978,0.038578879088163376,0.03847747668623924,0.03866879642009735,0.038521941751241684,0.0383467823266983,0.038056764751672745,0.03800247237086296,0.038226500153541565,0.03834407404065132,0.03823874145746231,0.038260433822870255,0.03836837783455849,0.038350217044353485,0.03812747448682785,0.038052793592214584,0.037804052233695984,0.03789203241467476,0.037686366587877274,0.03764249384403229,0.037582263350486755,0.037908826023340225,0.038115110248327255,0.03774821013212204,0.03790547326207161,0.03785586729645729,0.037671301513910294,0.03788716346025467,0.03805805370211601,0.03795557841658592,0.03787707909941673,0.037669118493795395,0.03784788399934769,0.037803053855895996,0.03780362010002136,0.03805596008896828,0.03791586682200432,0.03766293823719025,0.03771470859646797,0.03756500035524368,0.03772146999835968,0.03772431239485741,0.03791028633713722,0.03766541928052902,0.03762160986661911,0.037885572761297226,0.03791790083050728,0.03792937844991684,0.03794772922992706,0.03779983893036842,0.03781386464834213,0.03753132000565529,0.037567995488643646,0.03786672279238701,0.03800070285797119,0.03759847953915596,0.03747375309467316,0.037701454013586044,0.03761126101016998,0.03766804188489914,0.03741619735956192,0.037569429725408554,0.037463732063770294,0.03761410340666771],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"training epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training and Validation Loss - GRU"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('3a3b4a69-354a-437b-ad6b-e003b27215ac');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="forecasting---next-5-years-60-months-1" class="level4">
<h4 class="anchored" data-anchor-id="forecasting---next-5-years-60-months-1">Forecasting - next 5 years (60 months)</h4>
<div class="cell" data-execution_count="17">
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 18ms/step</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="deeplearning_files/figure-html/cell-18-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="model-3---lstm" class="level3">
<h3 class="anchored" data-anchor-id="model-3---lstm">Model 3 - LSTM</h3>
<section id="model-architecture-2" class="level4">
<h4 class="anchored" data-anchor-id="model-architecture-2">Model Architecture</h4>
<div class="cell" data-execution_count="18">
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_2"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 lstm (LSTM)                 (None, 3)                 60        
                                                                 
 dense_2 (Dense)             (None, 1)                 4         
                                                                 
=================================================================
Total params: 64
Trainable params: 64
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="plot-training-and-validation-loss-1" class="level4">
<h4 class="anchored" data-anchor-id="plot-training-and-validation-loss-1">Plot training and validation loss</h4>
<div class="cell" data-execution_count="20">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 18ms/step
(51, 9, 1) (51,) (51,) (5, 9, 1) (5,) (5,)
(51,) (51,)
0.034197398
0.019271672
Train MSE = 0.03420 RMSE = 0.18493
Test MSE = 0.01927 RMSE = 0.13882</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="b2d1f139-5a3b-472b-9b6b-832fc81f5fbf" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("b2d1f139-5a3b-472b-9b6b-832fc81f5fbf")) {                    Plotly.newPlot(                        "b2d1f139-5a3b-472b-9b6b-832fc81f5fbf",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"xaxis":"x","y":[0.08119635283946991,0.07393287122249603,0.06986578553915024,0.06701064854860306,0.06468143314123154,0.06288234144449234,0.061462126672267914,0.06028928607702255,0.05951017141342163,0.058883994817733765,0.058448322117328644,0.057698797434568405,0.056939221918582916,0.05648241192102432,0.05595177412033081,0.05571356415748596,0.05519513413310051,0.05458696931600571,0.05434703826904297,0.05390484258532524,0.05333825200796127,0.053063154220581055,0.05255148559808731,0.052122972905635834,0.05170683190226555,0.0517413392663002,0.05123409628868103,0.050881482660770416,0.050286851823329926,0.04993484914302826,0.049534495919942856,0.049411483108997345,0.04889142885804176,0.04890362173318863,0.048191241919994354,0.04789765924215317,0.04781351238489151,0.0476139672100544,0.04717414453625679,0.04683411493897438,0.046378105878829956,0.046268075704574585,0.04610970616340637,0.045567892491817474,0.04542945697903633,0.0449908971786499,0.04491527006030083,0.04462413117289543,0.044202566146850586,0.04414138197898865,0.043968427926301956,0.043689023703336716,0.04323304444551468,0.043227724730968475,0.04276362434029579,0.0427355095744133,0.04231354221701622,0.042053643614053726,0.04217783361673355,0.04163888841867447,0.04166240617632866,0.04137057065963745,0.041044872254133224,0.04104118421673775,0.040852636098861694,0.04043123498558998,0.04039452597498894,0.04008515924215317,0.04015922546386719,0.03971897438168526,0.039864521473646164,0.03932582587003708,0.03920366242527962,0.039283834397792816,0.039069946855306625,0.038752906024456024,0.03901488706469536,0.038454703986644745,0.03850740194320679,0.03823896124958992,0.03797537460923195,0.03803502395749092,0.03792741149663925,0.03760295361280441,0.037477198988199234,0.037578389048576355,0.03721395507454872,0.037247128784656525,0.037162575870752335,0.03692006319761276,0.03690759465098381,0.03686532378196716,0.036708083003759384,0.03675417602062225,0.03629424422979355,0.03640022128820419,0.03624200075864792,0.03627850487828255,0.036021191626787186,0.03580668941140175,0.03579206392168999,0.03561623767018318,0.035539768636226654,0.03568173944950104,0.03560025990009308,0.035505957901477814,0.0354560986161232,0.03511645644903183,0.035236991941928864,0.03508390858769417,0.03513342887163162,0.034864701330661774,0.034999288618564606,0.0347285270690918,0.03490302711725235,0.03483828902244568,0.034549690783023834,0.03472728654742241,0.034444812685251236,0.034391190856695175,0.03433519974350929,0.03427759185433388,0.03450950235128403,0.034211643040180206,0.034464675933122635,0.03421744331717491,0.034112412482500076,0.034220241010189056,0.03399231284856796,0.03417632356286049,0.034167636185884476,0.03406255692243576,0.034038104116916656,0.033879604190588,0.03397572785615921,0.03391795605421066,0.034172721207141876,0.033877186477184296,0.03371752053499222,0.03386394679546356,0.0338098518550396,0.03373248502612114,0.033583130687475204,0.033602114766836166,0.03363765403628349,0.033617615699768066,0.033838603645563126,0.03368130326271057,0.0334768109023571,0.03366934135556221,0.03345596790313721,0.03373337164521217,0.03345233574509621,0.03361370414495468,0.03344624117016792,0.03338092193007469,0.03343908116221428,0.0337454229593277,0.03337641805410385,0.03345043584704399,0.033548496663570404,0.033471498638391495,0.0333063080906868,0.033334825187921524,0.033454541116952896,0.03376513347029686,0.03339081257581711,0.03328946232795715,0.03327257186174393,0.033303648233413696,0.03323645889759064,0.03328041359782219,0.033185701817274094,0.03344672545790672,0.03347092866897583,0.03321465104818344,0.03338087350130081,0.033466484397649765,0.03329196572303772,0.03317030146718025,0.03320367634296417,0.03314299136400223,0.03340769559144974,0.033113084733486176,0.03314444050192833,0.03349309042096138,0.03313703089952469,0.03334805369377136,0.033283524215221405,0.03326619043946266,0.03321051225066185,0.03311163932085037,0.03308211266994476,0.03337804228067398,0.0330689363181591,0.03315950930118561,0.033326584845781326,0.033236950635910034,0.033046524971723557,0.033064499497413635],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"y":[0.08819866925477982,0.08246903866529465,0.07822280377149582,0.07508060336112976,0.07237177342176437,0.07032841444015503,0.06873036175966263,0.0674108937382698,0.06630310416221619,0.06544344872236252,0.06475511938333511,0.06410490721464157,0.06341107189655304,0.0628083348274231,0.06229149177670479,0.06176642328500748,0.06129840388894081,0.06076950207352638,0.060371700674295425,0.06002328544855118,0.0596245676279068,0.059123728424310684,0.05867232009768486,0.05830773338675499,0.05797133594751358,0.05756961181759834,0.057166095823049545,0.056778501719236374,0.05642106384038925,0.05606750026345253,0.05567994341254234,0.05537082999944687,0.05511197820305824,0.0547625906765461,0.054438184946775436,0.05415308475494385,0.0537530891597271,0.05346965417265892,0.053196679800748825,0.05286839231848717,0.05261347442865372,0.05241077020764351,0.05208752304315567,0.05183146148920059,0.05163336172699928,0.051316678524017334,0.05099846050143242,0.050685152411460876,0.05046677589416504,0.0502607487142086,0.05002870410680771,0.04969305917620659,0.04948493465781212,0.04924990236759186,0.04903484880924225,0.048820387572050095,0.04863204061985016,0.048346877098083496,0.0481116808950901,0.04785473644733429,0.04774443805217743,0.04750635847449303,0.047241922467947006,0.04704226180911064,0.04690905660390854,0.04670436307787895,0.04656084626913071,0.04635747894644737,0.04617275297641754,0.046030059456825256,0.045830510556697845,0.04562992975115776,0.04551362991333008,0.04529719054698944,0.045197781175374985,0.04502883180975914,0.04495443403720856,0.044768597930669785,0.0445886105298996,0.04451930895447731,0.04430048540234566,0.044055696576833725,0.0439608171582222,0.04386836662888527,0.043699514120817184,0.04359888657927513,0.04347175732254982,0.04327375069260597,0.04315344616770744,0.04303617402911186,0.0428689569234848,0.04278105869889259,0.042738448828458786,0.04271470010280609,0.04263164848089218,0.042555905878543854,0.04239273443818092,0.04232899844646454,0.0421440452337265,0.04207199811935425,0.04200630635023117,0.041859693825244904,0.04173380509018898,0.04169262573122978,0.04158525913953781,0.04152011498808861,0.041397176682949066,0.04137623682618141,0.041298314929008484,0.041264716535806656,0.04111987352371216,0.04111972078680992,0.04112231731414795,0.04109454154968262,0.04099255055189133,0.04091523960232735,0.04078513756394386,0.04072096198797226,0.04066384211182594,0.04060499742627144,0.04059862345457077,0.04059646278619766,0.040545832365751266,0.04046918451786041,0.04044483229517937,0.04044002667069435,0.040317561477422714,0.04032799229025841,0.040262993425130844,0.04020213335752487,0.04015436768531799,0.04011734947562218,0.04007035121321678,0.04008476063609123,0.04008277505636215,0.03999660909175873,0.04005797952413559,0.03999856859445572,0.03990747407078743,0.03993721678853035,0.03983836621046066,0.03985156863927841,0.039788927882909775,0.039723172783851624,0.03977994620800018,0.03981234133243561,0.03976123034954071,0.03976021707057953,0.03966569900512695,0.03965514525771141,0.03956330195069313,0.03956817835569382,0.039538681507110596,0.0395946241915226,0.03958756476640701,0.03948657587170601,0.039488088339567184,0.0395011343061924,0.03949141874909401,0.039420053362846375,0.03948897123336792,0.03943869471549988,0.03948767110705376,0.0393974632024765,0.03940139710903168,0.03949054703116417,0.03948970511555672,0.039510052651166916,0.03951665759086609,0.03951798379421234,0.03940970078110695,0.0394076369702816,0.03930271789431572,0.03931374102830887,0.039349135011434555,0.03930693864822388,0.03939349949359894,0.03941237926483154,0.0393337681889534,0.03926287218928337,0.03923475369811058,0.03920019418001175,0.039192572236061096,0.03922509402036667,0.03926050290465355,0.03933756798505783,0.03934619575738907,0.03931514918804169,0.039270590990781784,0.039248641580343246,0.039261139929294586,0.03918510302901268,0.03921889886260033,0.03921772539615631,0.03926336392760277,0.03918462619185448,0.0392935648560524,0.03919408097863197,0.03916384279727936,0.03914731368422508],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"training epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training and Validation Loss - LSTM"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('b2d1f139-5a3b-472b-9b6b-832fc81f5fbf');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="forecasting---next-5-years-60-months-2" class="level4">
<h4 class="anchored" data-anchor-id="forecasting---next-5-years-60-months-2">Forecasting - next 5 years (60 months)</h4>
<div class="cell" data-execution_count="21">
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 23ms/step</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="deeplearning_files/figure-html/cell-22-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="discussion" class="level3">
<h3 class="anchored" data-anchor-id="discussion">Discussion</h3>
<p>For predicting CO2 emissions from coal, the training RMSE are: <br> 1) RNN - 0.18039<br> 2) GRU - 0.18312<br> 3) LSTM - 0.18691<br> <br></p>
<p>And the test RMSE are:<br> 1) RNN - 0.12964<br> 2) GRU - 0.19448<br> 3) LSTM - 0.14685<br></p>
<p>Thus, the RNN minimized RMSE for both training and validation predictions, while the GRU model overfit the data. Regularization is a technique used in ANNs to prevent overfitting and improve generalization performance. L2 regularization was used here, which adds a penalty term to the loss function that is proportional to the sum of the squares of the weights in the network. It was decently important here - without L2 regularization the test RMSE for RNN, GRU, and LSTM models were all over 0.2 which is much higher than their regularized RMSE above.</p>
<p>Forecasting here worked better than expected. For all three models I forecasted the next 5 years (60) months, and the forecasted plots appear to mimic the seasonality and spikes of the previous 30 years. Across all three models, the first 3-4 years are well forecasted and display the expected spikes in emissions during the summer. However, by year 5 forecast weakens and the nuance and variation in the trend is smaller.</p>
<p>The ARIMA(1,1,1)(0,1,2) forecast shared the same seasonality, but exhibited a downwards trend. The ANN models also exhibit a slight downward trend, but are far more consistent over time. The RNSE from the ARIMA model was 0.0433, significantly smaller than the ANN RMSE. With more model tuning the ANN could likely outperform the ARIMA model.</p>
</section>
</section>
<section id="hydro" class="level2">
<h2 class="anchored" data-anchor-id="hydro">Hydro</h2>
<section id="split-data-into-training-and-testing-data-1" class="level3">
<h3 class="anchored" data-anchor-id="split-data-into-training-and-testing-data-1">Split data into training and testing data</h3>
<p>And visualize split!</p>
<div class="cell" data-execution_count="22">
<div class="cell-output cell-output-stdout">
<pre><code>Training data size:  (519,)
Test data size:  (130,)</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="9700b8cb-03e2-43a7-975d-472d3c4e5962" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("9700b8cb-03e2-43a7-975d-472d3c4e5962")) {                    Plotly.newPlot(                        "9700b8cb-03e2-43a7-975d-472d3c4e5962",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518],"xaxis":"x","y":[0.29885026812553406,0.2489730417728424,0.16556856036186218,0.12283661961555481,0.10678568482398987,0.04782286286354065,0.04201275110244751,0.09250667691230774,0.09808856248855591,0.1636926233768463,0.21838590502738953,0.22443869709968567,0.9024785757064819,0.2506839334964752,0.18938997387886047,0.1598140299320221,0.1178608238697052,0.08518919348716736,0.06703010201454163,0.06937691569328308,0.08319929242134094,0.11958065629005432,0.16875723004341125,0.19355294108390808,0.23748359084129333,0.8911441564559937,0.24347230792045593,0.1764110028743744,0.1766255795955658,0.11801758408546448,0.023940861225128174,0.0,0.06503942608833313,0.08384457230567932,0.09752950072288513,0.13899245858192444,0.15380707383155823,0.24988004565238953,0.8763030767440796,0.27802249789237976,0.16880133748054504,0.1308991014957428,0.07858330011367798,0.05163422226905823,0.02947857975959778,0.04032200574874878,0.06777319312095642,0.06986865401268005,0.17186853289604187,0.22607818245887756,0.2764621675014496,0.8851343393325806,0.29293063282966614,0.24012932181358337,0.13521990180015564,0.06278383731842041,0.047756731510162354,0.05416986346244812,0.030391603708267212,0.05365148186683655,0.05917719006538391,0.13551560044288635,0.1731301248073578,0.24071797728538513,0.8799793720245361,0.26271381974220276,0.22440215945243835,0.1573067605495453,0.04815340042114258,0.0464307963848114,0.0258694589138031,0.02358230948448181,0.0258694589138031,0.07648852467536926,0.14729782938957214,0.16013166308403015,0.2171529233455658,0.8694477081298828,0.2789365351200104,0.24535128474235535,0.18194052577018738,0.1344793736934662,0.09708142280578613,0.07989251613616943,0.08137327432632446,0.11607840657234192,0.12994709610939026,0.1804618537425995,0.21486029028892517,0.23197802901268005,0.9110386371612549,0.28102824091911316,0.21632817387580872,0.19156035780906677,0.0771484375,0.11885222792625427,0.08278796076774597,0.04086410999298096,0.07564643025398254,0.11486658453941345,0.17278262972831726,0.15990480780601501,0.24721840023994446,0.8967489004135132,0.2673359215259552,0.20394757390022278,0.19286319613456726,0.10334828495979309,0.10263398289680481,0.08739763498306274,0.07804602384567261,0.07443934679031372,0.11796531081199646,0.18881401419639587,0.16521218419075012,0.2217596471309662,0.8963632583618164,0.2491748034954071,0.16645774245262146,0.18041953444480896,0.15297213196754456,0.11152169108390808,0.086760014295578,0.13219699263572693,0.10591647028923035,0.14677664637565613,0.16902145743370056,0.1915195882320404,0.2109486162662506,0.9015299081802368,0.23936590552330017,0.17399701476097107,0.12778118252754211,0.08548074960708618,0.06038424372673035,0.022071778774261475,0.07005280256271362,0.07864293456077576,0.13865146040916443,0.1446346938610077,0.16800746321678162,0.26657578349113464,0.8793326616287231,0.26492223143577576,0.18450012803077698,0.1770114004611969,0.11071977019309998,0.11676117777824402,0.09301844239234924,0.1112011969089508,0.14777091145515442,0.131448894739151,0.19111117720603943,0.19057950377464294,0.20241722464561462,0.9036329984664917,0.2620706260204315,0.19785836338996887,0.16972479224205017,0.08878397941589355,0.11952868103981018,0.11581537127494812,0.12483450770378113,0.11018392443656921,0.14729782938957214,0.21745231747627258,0.17923113703727722,0.26132920384407043,0.911162257194519,0.24501052498817444,0.18395647406578064,0.16409561038017273,0.09313204884529114,0.07395511865615845,0.04241713881492615,0.07552593946456909,0.10241386294364929,0.1461118757724762,0.21894463896751404,0.23251184821128845,0.25241830945014954,0.9005218744277954,0.25772491097450256,0.19460490345954895,0.18016526103019714,0.1356140673160553,0.08716589212417603,0.08878397941589355,0.12994709610939026,0.10575321316719055,0.1511082947254181,0.19669762253761292,0.18959537148475647,0.23800763487815857,0.9072870016098022,0.2867427170276642,0.2315146028995514,0.19399848580360413,0.09062251448631287,0.09741753339767456,0.07834464311599731,0.10948589444160461,0.1268698275089264,0.16928544640541077,0.20257452130317688,0.21175029873847961,0.26010021567344666,0.9187326431274414,0.2501482665538788,0.22843053936958313,0.20472928881645203,0.1328437626361847,0.0929616391658783,0.08646973967552185,0.08290553092956543,0.10064700245857239,0.14658686518669128,0.1920088827610016,0.2037126123905182,0.2817824184894562,0.9138333797454834,0.19569334387779236,0.17007586359977722,0.17199930548667908,0.14890322089195251,0.11497214436531067,0.033461183309555054,0.06572520732879639,0.09836772084236145,0.11502495408058167,0.17408356070518494,0.17438623309135437,0.2209475338459015,0.884419322013855,0.2721986472606659,0.1927413046360016,0.17914608120918274,0.12201306223869324,0.09090876579284668,0.08208143711090088,0.13408371806144714,0.10700264573097229,0.14247724413871765,0.16310957074165344,0.20543107390403748,0.23322215676307678,0.9052728414535522,0.2503826916217804,0.22904273867607117,0.19298502802848816,0.14214017987251282,0.1207217276096344,0.12082526087760925,0.12278518080711365,0.12605735659599304,0.11364981532096863,0.2037126123905182,0.24336948990821838,0.2827150523662567,0.9244997501373291,0.2531490623950958,0.231621652841568,0.2278170883655548,0.14430013298988342,0.11602577567100525,0.10070231556892395,0.1256503164768219,0.12242516875267029,0.15551599860191345,0.208530455827713,0.2340722382068634,0.25513288378715515,0.9260842800140381,0.3146684467792511,0.24511274695396423,0.20849189162254333,0.14843198657035828,0.12909266352653503,0.10781469941139221,0.14885613322257996,0.14876195788383484,0.16216525435447693,0.22407308220863342,0.21946516633033752,0.26856693625450134,0.9395542144775391,0.27188727259635925,0.241822749376297,0.20229914784431458,0.16813990473747253,0.16422978043556213,0.12580302357673645,0.11833086609840393,0.13870015740394592,0.17679712176322937,0.2048073709011078,0.2367483675479889,0.2858821451663971,0.938971996307373,0.31097647547721863,0.26812562346458435,0.2470153272151947,0.19525036215782166,0.17068925499916077,0.13908973336219788,0.1530650556087494,0.16994425654411316,0.1731301248073578,0.23509624600410461,0.2659091055393219,0.27160677313804626,0.961105227470398,0.3019636571407318,0.24677816033363342,0.2087615430355072,0.19270065426826477,0.159541517496109,0.14025554060935974,0.14544567465782166,0.16414031386375427,0.1922532021999359,0.2187958061695099,0.2554951608181,0.30367621779441833,0.9553632736206055,0.2667026221752167,0.21136882901191711,0.24168488383293152,0.17003199458122253,0.11649873852729797,0.10509923100471497,0.11375579237937927,0.14088508486747742,0.12964579463005066,0.19905439019203186,0.21391561627388,0.25374558568000793,0.9249790906906128,0.3226015865802765,0.23304471373558044,0.2756020128726959,0.19893500208854675,0.16328904032707214,0.17221710085868835,0.17795255780220032,0.18437477946281433,0.21662834286689758,0.2506839334964752,0.24592962861061096,0.3277064263820648,0.9752629995346069,0.34680870175361633,0.2844521701335907,0.25621840357780457,0.21262595057487488,0.17846468091011047,0.18996486067771912,0.18328604102134705,0.19549205899238586,0.1975385844707489,0.2409254014492035,0.2669244110584259,0.3541993796825409,0.9878349304199219,0.3216806948184967,0.2578555643558502,0.2509180009365082,0.19403895735740662,0.1418992578983307,0.12929394841194153,0.15315786004066467,0.16445335745811462,0.1848759949207306,0.24078711867332458,0.22734716534614563,0.2856442630290985,0.9579561948776245,0.3076527416706085,0.2831052839756012,0.27157559990882874,0.17395368218421936,0.17269566655158997,0.13908973336219788,0.1573983132839203,0.16565760970115662,0.15817531943321228,0.23176422715187073,0.2534143030643463,0.2934815585613251,0.9628491401672363,0.33264896273612976,0.28166189789772034,0.23953953385353088,0.19893500208854675,0.131498783826828,0.09803271293640137,0.1425253450870514,0.15129521489143372,0.1720864474773407,0.1971384584903717,0.2315146028995514,0.31775495409965515,0.9562051296234131,0.3248001039028168,0.29330769181251526,0.23315122723579407,0.1938365399837494,0.14410874247550964,0.15166863799095154,0.1509680449962616,0.1572152078151703,0.15413114428520203,0.20930024981498718,0.236362487077713,0.29961737990379333,0.9586451053619385,0.3143174946308136,0.2671143710613251,0.26216718554496765,0.157077819108963,0.15143534541130066,0.11639371514320374,0.1266668736934662,0.1815188229084015,0.12051460146903992,0.16337880492210388,0.19476637244224548,0.3066011965274811,0.9446557760238647,0.23919209837913513,0.24343803524971008,0.23286721110343933,0.13044849038124084,0.12488558888435364,0.13576176762580872,0.1262606680393219,0.15505507588386536,0.12061813473701477,0.20099756121635437,0.22046658396720886,0.2522519528865814,0.9258766174316406,0.29472461342811584,0.29426267743110657,0.22238567471504211,0.1815188229084015,0.12549754977226257,0.12324753403663635,0.12803378701210022,0.11791303753852844,0.16099193692207336,0.16765394806861877,0.20281031727790833,0.27633944153785706,0.9379569292068481,0.3047659695148468,0.27247855067253113,0.24524906277656555,0.14568379521369934,0.14852628111839294,0.12778118252754211,0.13669541478157043,0.15227457880973816,0.06478965282440186,0.19147875905036926,0.20987626910209656,0.24877110123634338,0.9345148801803589,0.2637080252170563,0.22275331616401672,0.2138020098209381,0.14358189702033997,0.08652782440185547,0.07804602384567261,0.10169735550880432,0.13124904036521912,0.1270219385623932,0.20721712708473206,0.25493505597114563,0.29882171750068665,0.9257174730300903,0.3002127707004547,0.2509180009365082,0.21045121550559998,0.12180683016777039,0.1053173840045929,0.08460530638694763,0.09562063217163086,0.11210843920707703,0.11162850260734558,0.15546998381614685,0.20316371321678162,0.2888687551021576,0.9192320108413696,0.26268163323402405,0.23491999506950378,0.19673773646354675,0.11900851130485535,0.0947180986404419,0.059813112020492554,0.0547519326210022,0.09027862548828125,0.09182286262512207,0.15616008639335632,0.20036444067955017,0.24694755673408508,0.8989995718002319,0.24562355875968933,0.19653716683387756,0.1432461440563202,0.1117885410785675,0.09646427631378174,0.05032545328140259,0.07900050282478333,0.09233585000038147,0.07522451877593994,0.16472139954566956,0.1913154423236847,0.23318663239479065],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648],"y":[0.8862274885177612,0.2681886851787567,0.2285747230052948,0.23590591549873352,0.16026762127876282,0.10635140538215637,0.09696933627128601,0.07929813861846924,0.09443551301956177,0.13605692982673645,0.1709516942501068,0.23555412888526917,0.27722808718681335,0.9217337369918823,0.30856284499168396,0.2440885603427887,0.2207256257534027,0.14218834042549133,0.07995185256004333,0.10003718733787537,0.07989251613616943,0.1173376739025116,0.13329073786735535,0.1809273660182953,0.24012932181358337,0.2672410309314728,0.9252705574035645,0.290306955575943,0.26530465483665466,0.23477885127067566,0.15767279267311096,0.12340149283409119,0.1209804117679596,0.12575212121009827,0.14165809750556946,0.09533888101577759,0.17829403281211853,0.1863328516483307,0.2453853189945221,0.9264816045761108,0.28804370760917664,0.22864672541618347,0.20441684126853943,0.14857342839241028,0.1243235170841217,0.08658590912818909,0.10683992505073547,0.09130904078483582,0.1207217276096344,0.1734771430492401,0.18466725945472717,0.26660749316215515,0.9154360294342041,0.2872757017612457,0.19484713673591614,0.23147889971733093,0.16396132111549377,0.13393518328666687,0.08895683288574219,0.12722453474998474,0.09640812873840332,0.11958065629005432,0.17671135067939758,0.22454825043678284,0.28229424357414246,0.9240648746490479,0.33264896273612976,0.2604241669178009,0.2615227997303009,0.2060924470424652,0.13373705744743347,0.11018392443656921,0.15514734387397766,0.16472139954566956,0.16858097910881042,0.21655330061912537,0.2793925106525421,0.30837002396583557,0.9639747142791748,0.3571377694606781,0.3071273863315582,0.28430280089378357,0.2031244933605194,0.1824878752231598,0.16476604342460632,0.19025185704231262,0.18483421206474304,0.20253518223762512,0.2470153272151947,0.29452261328697205,0.323859840631485,0.9914212226867676,0.3059629499912262,0.26736751198768616,0.27954432368278503,0.17304328083992004,0.1824878752231598,0.1502188742160797,0.16449806094169617,0.18316015601158142,0.20441684126853943,0.2605859339237213,0.29345253109931946,0.36279115080833435,0.982427716255188,0.36982235312461853,0.283914178609848,0.28045371174812317,0.22702136635780334,0.22304710745811462,0.20300671458244324,0.21140697598457336,0.219725102186203,0.21033629775047302,0.23667821288108826,0.27802249789237976,0.3281966745853424,1.0,0.35781535506248474,0.3202808201313019,0.28102824091911316,0.25181904435157776,0.19525036215782166,0.2048073709011078,0.21942803263664246,0.21315762400627136,0.2171529233455658,0.27572503685951233,0.288456529378891,0.32001593708992004],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"t: time (months)"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y(t): Response variable"}},"legend":{"tracegroupgap":0},"title":{"text":"CO2 Emissions per month from Hydro Power since 1973"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('9700b8cb-03e2-43a7-975d-472d3c4e5962');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="reformat-data-into-required-shape-1" class="level3">
<h3 class="anchored" data-anchor-id="reformat-data-into-required-shape-1">Reformat data into required shape</h3>
<p>Required shape = (samples, time, features)</p>
<div class="cell" data-execution_count="24">
<div class="cell-output cell-output-display">

<div>                            <div id="fc06b3df-212f-4143-99d0-d9d7e59849c7" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("fc06b3df-212f-4143-99d0-d9d7e59849c7")) {                    Plotly.newPlot(                        "fc06b3df-212f-4143-99d0-d9d7e59849c7",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8],"xaxis":"x","y":[0.2489730417728424,0.16556856036186218,0.12283661961555481,0.10678568482398987,0.04782286286354065,0.04201275110244751,0.09250667691230774,0.09808856248855591,0.1636926233768463],"yaxis":"y","type":"scatter"},{"x":[9],"y":[0.21838590502738953],"type":"scatter"},{"mode":"lines","x":[10,11,12,13,14,15,16,17,18],"y":[0.22443869709968567,0.9024785757064819,0.2506839334964752,0.18938997387886047,0.1598140299320221,0.1178608238697052,0.08518919348716736,0.06703010201454163,0.06937691569328308],"type":"scatter"},{"x":[19],"y":[0.08319929242134094],"type":"scatter"},{"mode":"lines","x":[20,21,22,23,24,25,26,27,28],"y":[0.11958065629005432,0.16875723004341125,0.19355294108390808,0.23748359084129333,0.8911441564559937,0.24347230792045593,0.1764110028743744,0.1766255795955658,0.11801758408546448],"type":"scatter"},{"x":[29],"y":[0.023940861225128174],"type":"scatter"},{"mode":"lines","x":[30,31,32,33,34,35,36,37,38],"y":[0.0,0.06503942608833313,0.08384457230567932,0.09752950072288513,0.13899245858192444,0.15380707383155823,0.24988004565238953,0.8763030767440796,0.27802249789237976],"type":"scatter"},{"x":[39],"y":[0.16880133748054504],"type":"scatter"},{"mode":"lines","x":[40,41,42,43,44,45,46,47,48],"y":[0.1308991014957428,0.07858330011367798,0.05163422226905823,0.02947857975959778,0.04032200574874878,0.06777319312095642,0.06986865401268005,0.17186853289604187,0.22607818245887756],"type":"scatter"},{"x":[49],"y":[0.2764621675014496],"type":"scatter"},{"mode":"lines","x":[50,51,52,53,54,55,56,57,58],"y":[0.8851343393325806,0.29293063282966614,0.24012932181358337,0.13521990180015564,0.06278383731842041,0.047756731510162354,0.05416986346244812,0.030391603708267212,0.05365148186683655],"type":"scatter"},{"x":[59],"y":[0.05917719006538391],"type":"scatter"},{"mode":"lines","x":[60,61,62,63,64,65,66,67,68],"y":[0.13551560044288635,0.1731301248073578,0.24071797728538513,0.8799793720245361,0.26271381974220276,0.22440215945243835,0.1573067605495453,0.04815340042114258,0.0464307963848114],"type":"scatter"},{"x":[69],"y":[0.0258694589138031],"type":"scatter"},{"mode":"lines","x":[70,71,72,73,74,75,76,77,78],"y":[0.02358230948448181,0.0258694589138031,0.07648852467536926,0.14729782938957214,0.16013166308403015,0.2171529233455658,0.8694477081298828,0.2789365351200104,0.24535128474235535],"type":"scatter"},{"x":[79],"y":[0.18194052577018738],"type":"scatter"},{"mode":"lines","x":[80,81,82,83,84,85,86,87,88],"y":[0.1344793736934662,0.09708142280578613,0.07989251613616943,0.08137327432632446,0.11607840657234192,0.12994709610939026,0.1804618537425995,0.21486029028892517,0.23197802901268005],"type":"scatter"},{"x":[89],"y":[0.9110386371612549],"type":"scatter"},{"mode":"lines","x":[90,91,92,93,94,95,96,97,98],"y":[0.28102824091911316,0.21632817387580872,0.19156035780906677,0.0771484375,0.11885222792625427,0.08278796076774597,0.04086410999298096,0.07564643025398254,0.11486658453941345],"type":"scatter"},{"x":[99],"y":[0.17278262972831726],"type":"scatter"},{"mode":"lines","x":[100,101,102,103,104,105,106,107,108],"y":[0.15990480780601501,0.24721840023994446,0.8967489004135132,0.2673359215259552,0.20394757390022278,0.19286319613456726,0.10334828495979309,0.10263398289680481,0.08739763498306274],"type":"scatter"},{"x":[109],"y":[0.07804602384567261],"type":"scatter"},{"mode":"lines","x":[110,111,112,113,114,115,116,117,118],"y":[0.07443934679031372,0.11796531081199646,0.18881401419639587,0.16521218419075012,0.2217596471309662,0.8963632583618164,0.2491748034954071,0.16645774245262146,0.18041953444480896],"type":"scatter"},{"x":[119],"y":[0.15297213196754456],"type":"scatter"},{"mode":"lines","x":[120,121,122,123,124,125,126,127,128],"y":[0.11152169108390808,0.086760014295578,0.13219699263572693,0.10591647028923035,0.14677664637565613,0.16902145743370056,0.1915195882320404,0.2109486162662506,0.9015299081802368],"type":"scatter"},{"x":[129],"y":[0.23936590552330017],"type":"scatter"},{"mode":"lines","x":[130,131,132,133,134,135,136,137,138],"y":[0.17399701476097107,0.12778118252754211,0.08548074960708618,0.06038424372673035,0.022071778774261475,0.07005280256271362,0.07864293456077576,0.13865146040916443,0.1446346938610077],"type":"scatter"},{"x":[139],"y":[0.16800746321678162],"type":"scatter"},{"mode":"lines","x":[140,141,142,143,144,145,146,147,148],"y":[0.26657578349113464,0.8793326616287231,0.26492223143577576,0.18450012803077698,0.1770114004611969,0.11071977019309998,0.11676117777824402,0.09301844239234924,0.1112011969089508],"type":"scatter"},{"x":[149],"y":[0.14777091145515442],"type":"scatter"},{"mode":"lines","x":[150,151,152,153,154,155,156,157,158],"y":[0.131448894739151,0.19111117720603943,0.19057950377464294,0.20241722464561462,0.9036329984664917,0.2620706260204315,0.19785836338996887,0.16972479224205017,0.08878397941589355],"type":"scatter"},{"x":[159],"y":[0.11952868103981018],"type":"scatter"},{"mode":"lines","x":[160,161,162,163,164,165,166,167,168],"y":[0.11581537127494812,0.12483450770378113,0.11018392443656921,0.14729782938957214,0.21745231747627258,0.17923113703727722,0.26132920384407043,0.911162257194519,0.24501052498817444],"type":"scatter"},{"x":[169],"y":[0.18395647406578064],"type":"scatter"},{"mode":"lines","x":[170,171,172,173,174,175,176,177,178],"y":[0.16409561038017273,0.09313204884529114,0.07395511865615845,0.04241713881492615,0.07552593946456909,0.10241386294364929,0.1461118757724762,0.21894463896751404,0.23251184821128845],"type":"scatter"},{"x":[179],"y":[0.25241830945014954],"type":"scatter"},{"mode":"lines","x":[180,181,182,183,184,185,186,187,188],"y":[0.9005218744277954,0.25772491097450256,0.19460490345954895,0.18016526103019714,0.1356140673160553,0.08716589212417603,0.08878397941589355,0.12994709610939026,0.10575321316719055],"type":"scatter"},{"x":[189],"y":[0.1511082947254181],"type":"scatter"},{"mode":"lines","x":[190,191,192,193,194,195,196,197,198],"y":[0.19669762253761292,0.18959537148475647,0.23800763487815857,0.9072870016098022,0.2867427170276642,0.2315146028995514,0.19399848580360413,0.09062251448631287,0.09741753339767456],"type":"scatter"},{"x":[199],"y":[0.07834464311599731],"type":"scatter"},{"mode":"lines","x":[200,201,202,203,204,205,206,207,208],"y":[0.10948589444160461,0.1268698275089264,0.16928544640541077,0.20257452130317688,0.21175029873847961,0.26010021567344666,0.9187326431274414,0.2501482665538788,0.22843053936958313],"type":"scatter"},{"x":[209],"y":[0.20472928881645203],"type":"scatter"},{"mode":"lines","x":[210,211,212,213,214,215,216,217,218],"y":[0.1328437626361847,0.0929616391658783,0.08646973967552185,0.08290553092956543,0.10064700245857239,0.14658686518669128,0.1920088827610016,0.2037126123905182,0.2817824184894562],"type":"scatter"},{"x":[219],"y":[0.9138333797454834],"type":"scatter"},{"mode":"lines","x":[220,221,222,223,224,225,226,227,228],"y":[0.19569334387779236,0.17007586359977722,0.17199930548667908,0.14890322089195251,0.11497214436531067,0.033461183309555054,0.06572520732879639,0.09836772084236145,0.11502495408058167],"type":"scatter"},{"x":[229],"y":[0.17408356070518494],"type":"scatter"},{"mode":"lines","x":[230,231,232,233,234,235,236,237,238],"y":[0.17438623309135437,0.2209475338459015,0.884419322013855,0.2721986472606659,0.1927413046360016,0.17914608120918274,0.12201306223869324,0.09090876579284668,0.08208143711090088],"type":"scatter"},{"x":[239],"y":[0.13408371806144714],"type":"scatter"},{"mode":"lines","x":[240,241,242,243,244,245,246,247,248],"y":[0.10700264573097229,0.14247724413871765,0.16310957074165344,0.20543107390403748,0.23322215676307678,0.9052728414535522,0.2503826916217804,0.22904273867607117,0.19298502802848816],"type":"scatter"},{"x":[249],"y":[0.14214017987251282],"type":"scatter"},{"mode":"lines","x":[250,251,252,253,254,255,256,257,258],"y":[0.1207217276096344,0.12082526087760925,0.12278518080711365,0.12605735659599304,0.11364981532096863,0.2037126123905182,0.24336948990821838,0.2827150523662567,0.9244997501373291],"type":"scatter"},{"x":[259],"y":[0.2531490623950958],"type":"scatter"},{"mode":"lines","x":[260,261,262,263,264,265,266,267,268],"y":[0.231621652841568,0.2278170883655548,0.14430013298988342,0.11602577567100525,0.10070231556892395,0.1256503164768219,0.12242516875267029,0.15551599860191345,0.208530455827713],"type":"scatter"},{"x":[269],"y":[0.2340722382068634],"type":"scatter"},{"mode":"lines","x":[270,271,272,273,274,275,276,277,278],"y":[0.25513288378715515,0.9260842800140381,0.3146684467792511,0.24511274695396423,0.20849189162254333,0.14843198657035828,0.12909266352653503,0.10781469941139221,0.14885613322257996],"type":"scatter"},{"x":[279],"y":[0.14876195788383484],"type":"scatter"},{"mode":"lines","x":[280,281,282,283,284,285,286,287,288],"y":[0.16216525435447693,0.22407308220863342,0.21946516633033752,0.26856693625450134,0.9395542144775391,0.27188727259635925,0.241822749376297,0.20229914784431458,0.16813990473747253],"type":"scatter"},{"x":[289],"y":[0.16422978043556213],"type":"scatter"},{"mode":"lines","x":[290,291,292,293,294,295,296,297,298],"y":[0.12580302357673645,0.11833086609840393,0.13870015740394592,0.17679712176322937,0.2048073709011078,0.2367483675479889,0.2858821451663971,0.938971996307373,0.31097647547721863],"type":"scatter"},{"x":[299],"y":[0.26812562346458435],"type":"scatter"},{"mode":"lines","x":[300,301,302,303,304,305,306,307,308],"y":[0.2470153272151947,0.19525036215782166,0.17068925499916077,0.13908973336219788,0.1530650556087494,0.16994425654411316,0.1731301248073578,0.23509624600410461,0.2659091055393219],"type":"scatter"},{"x":[309],"y":[0.27160677313804626],"type":"scatter"},{"mode":"lines","x":[310,311,312,313,314,315,316,317,318],"y":[0.961105227470398,0.3019636571407318,0.24677816033363342,0.2087615430355072,0.19270065426826477,0.159541517496109,0.14025554060935974,0.14544567465782166,0.16414031386375427],"type":"scatter"},{"x":[319],"y":[0.1922532021999359],"type":"scatter"},{"mode":"lines","x":[320,321,322,323,324,325,326,327,328],"y":[0.2187958061695099,0.2554951608181,0.30367621779441833,0.9553632736206055,0.2667026221752167,0.21136882901191711,0.24168488383293152,0.17003199458122253,0.11649873852729797],"type":"scatter"},{"x":[329],"y":[0.10509923100471497],"type":"scatter"},{"mode":"lines","x":[330,331,332,333,334,335,336,337,338],"y":[0.11375579237937927,0.14088508486747742,0.12964579463005066,0.19905439019203186,0.21391561627388,0.25374558568000793,0.9249790906906128,0.3226015865802765,0.23304471373558044],"type":"scatter"},{"x":[339],"y":[0.2756020128726959],"type":"scatter"},{"mode":"lines","x":[340,341,342,343,344,345,346,347,348],"y":[0.19893500208854675,0.16328904032707214,0.17221710085868835,0.17795255780220032,0.18437477946281433,0.21662834286689758,0.2506839334964752,0.24592962861061096,0.3277064263820648],"type":"scatter"},{"x":[349],"y":[0.9752629995346069],"type":"scatter"},{"mode":"lines","x":[350,351,352,353,354,355,356,357,358],"y":[0.34680870175361633,0.2844521701335907,0.25621840357780457,0.21262595057487488,0.17846468091011047,0.18996486067771912,0.18328604102134705,0.19549205899238586,0.1975385844707489],"type":"scatter"},{"x":[359],"y":[0.2409254014492035],"type":"scatter"},{"mode":"lines","x":[360,361,362,363,364,365,366,367,368],"y":[0.2669244110584259,0.3541993796825409,0.9878349304199219,0.3216806948184967,0.2578555643558502,0.2509180009365082,0.19403895735740662,0.1418992578983307,0.12929394841194153],"type":"scatter"},{"x":[369],"y":[0.15315786004066467],"type":"scatter"},{"mode":"lines","x":[370,371,372,373,374,375,376,377,378],"y":[0.16445335745811462,0.1848759949207306,0.24078711867332458,0.22734716534614563,0.2856442630290985,0.9579561948776245,0.3076527416706085,0.2831052839756012,0.27157559990882874],"type":"scatter"},{"x":[379],"y":[0.17395368218421936],"type":"scatter"},{"mode":"lines","x":[380,381,382,383,384,385,386,387,388],"y":[0.17269566655158997,0.13908973336219788,0.1573983132839203,0.16565760970115662,0.15817531943321228,0.23176422715187073,0.2534143030643463,0.2934815585613251,0.9628491401672363],"type":"scatter"},{"x":[389],"y":[0.33264896273612976],"type":"scatter"},{"mode":"lines","x":[390,391,392,393,394,395,396,397,398],"y":[0.28166189789772034,0.23953953385353088,0.19893500208854675,0.131498783826828,0.09803271293640137,0.1425253450870514,0.15129521489143372,0.1720864474773407,0.1971384584903717],"type":"scatter"},{"x":[399],"y":[0.2315146028995514],"type":"scatter"},{"mode":"lines","x":[400,401,402,403,404,405,406,407,408],"y":[0.31775495409965515,0.9562051296234131,0.3248001039028168,0.29330769181251526,0.23315122723579407,0.1938365399837494,0.14410874247550964,0.15166863799095154,0.1509680449962616],"type":"scatter"},{"x":[409],"y":[0.1572152078151703],"type":"scatter"},{"mode":"lines","x":[410,411,412,413,414,415,416,417,418],"y":[0.15413114428520203,0.20930024981498718,0.236362487077713,0.29961737990379333,0.9586451053619385,0.3143174946308136,0.2671143710613251,0.26216718554496765,0.157077819108963],"type":"scatter"},{"x":[419],"y":[0.15143534541130066],"type":"scatter"},{"mode":"lines","x":[420,421,422,423,424,425,426,427,428],"y":[0.11639371514320374,0.1266668736934662,0.1815188229084015,0.12051460146903992,0.16337880492210388,0.19476637244224548,0.3066011965274811,0.9446557760238647,0.23919209837913513],"type":"scatter"},{"x":[429],"y":[0.24343803524971008],"type":"scatter"},{"mode":"lines","x":[430,431,432,433,434,435,436,437,438],"y":[0.23286721110343933,0.13044849038124084,0.12488558888435364,0.13576176762580872,0.1262606680393219,0.15505507588386536,0.12061813473701477,0.20099756121635437,0.22046658396720886],"type":"scatter"},{"x":[439],"y":[0.2522519528865814],"type":"scatter"},{"mode":"lines","x":[440,441,442,443,444,445,446,447,448],"y":[0.9258766174316406,0.29472461342811584,0.29426267743110657,0.22238567471504211,0.1815188229084015,0.12549754977226257,0.12324753403663635,0.12803378701210022,0.11791303753852844],"type":"scatter"},{"x":[449],"y":[0.16099193692207336],"type":"scatter"},{"mode":"lines","x":[450,451,452,453,454,455,456,457,458],"y":[0.16765394806861877,0.20281031727790833,0.27633944153785706,0.9379569292068481,0.3047659695148468,0.27247855067253113,0.24524906277656555,0.14568379521369934,0.14852628111839294],"type":"scatter"},{"x":[459],"y":[0.12778118252754211],"type":"scatter"},{"mode":"lines","x":[460,461,462,463,464,465,466,467,468],"y":[0.13669541478157043,0.15227457880973816,0.06478965282440186,0.19147875905036926,0.20987626910209656,0.24877110123634338,0.9345148801803589,0.2637080252170563,0.22275331616401672],"type":"scatter"},{"x":[469],"y":[0.2138020098209381],"type":"scatter"},{"mode":"lines","x":[470,471,472,473,474,475,476,477,478],"y":[0.14358189702033997,0.08652782440185547,0.07804602384567261,0.10169735550880432,0.13124904036521912,0.1270219385623932,0.20721712708473206,0.25493505597114563,0.29882171750068665],"type":"scatter"},{"x":[479],"y":[0.9257174730300903],"type":"scatter"},{"mode":"lines","x":[480,481,482,483,484,485,486,487,488],"y":[0.3002127707004547,0.2509180009365082,0.21045121550559998,0.12180683016777039,0.1053173840045929,0.08460530638694763,0.09562063217163086,0.11210843920707703,0.11162850260734558],"type":"scatter"},{"x":[489],"y":[0.15546998381614685],"type":"scatter"},{"mode":"lines","x":[490,491,492,493,494,495,496,497,498],"y":[0.20316371321678162,0.2888687551021576,0.9192320108413696,0.26268163323402405,0.23491999506950378,0.19673773646354675,0.11900851130485535,0.0947180986404419,0.059813112020492554],"type":"scatter"},{"x":[499],"y":[0.0547519326210022],"type":"scatter"},{"mode":"lines","x":[500,501,502,503,504,505,506,507,508],"y":[0.09027862548828125,0.09182286262512207,0.15616008639335632,0.20036444067955017,0.24694755673408508,0.8989995718002319,0.24562355875968933,0.19653716683387756,0.1432461440563202],"type":"scatter"},{"x":[509],"y":[0.1117885410785675],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"t: time (months)"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y(t): Response variable"}},"legend":{"tracegroupgap":0},"title":{"text":"CO2 Emissions per month from HydroPower since 1973"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('fc06b3df-212f-4143-99d0-d9d7e59849c7');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="model-1-rnn-1" class="level3">
<h3 class="anchored" data-anchor-id="model-1-rnn-1">Model 1 = RNN</h3>
<section id="model-architecture-3" class="level4">
<h4 class="anchored" data-anchor-id="model-architecture-3">Model architecture</h4>
<div class="cell" data-execution_count="26">
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_3"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 simple_rnn_1 (SimpleRNN)    (None, 3)                 15        
                                                                 
 dense_3 (Dense)             (None, 1)                 4         
                                                                 
=================================================================
Total params: 19
Trainable params: 19
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="plot-training-and-validation-loss-mse-1" class="level4">
<h4 class="anchored" data-anchor-id="plot-training-and-validation-loss-mse-1">Plot training and validation loss (MSE)</h4>
<div class="cell" data-execution_count="28">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 15ms/step
(51, 9, 1) (51,) (51,) (12, 9, 1) (12,) (12,)
(51,) (51,)
0.04613612
0.00695966
Train MSE = 0.04614 RMSE = 0.21479
Test MSE = 0.00696 RMSE = 0.08342</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="4f8caec7-c797-4fd8-809d-f9d30ba509fe" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("4f8caec7-c797-4fd8-809d-f9d30ba509fe")) {                    Plotly.newPlot(                        "4f8caec7-c797-4fd8-809d-f9d30ba509fe",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"xaxis":"x","y":[0.1261187195777893,0.12234976142644882,0.11963140964508057,0.117336705327034,0.115203857421875,0.11319936811923981,0.11125703155994415,0.1093498095870018,0.10756498575210571,0.10582765191793442,0.10410644859075546,0.10241081565618515,0.10073956102132797,0.09910944849252701,0.09755988419055939,0.0959751084446907,0.09444127976894379,0.09292750060558319,0.0914900153875351,0.09007828682661057,0.08876170217990875,0.08744378387928009,0.0861259251832962,0.08484617620706558,0.08361543715000153,0.08241433650255203,0.08123495429754257,0.08005893230438232,0.0789429172873497,0.07785316556692123,0.07680784165859222,0.07579479366540909,0.0748056024312973,0.0738636925816536,0.07290057837963104,0.07199548929929733,0.071107879281044,0.0702524483203888,0.06939788162708282,0.06857389211654663,0.06785841286182404,0.06713249534368515,0.06637357920408249,0.06570112705230713,0.06499037891626358,0.06435441970825195,0.06368233263492584,0.06306006759405136,0.06244213506579399,0.06188156455755234,0.06132320314645767,0.060788024216890335,0.060272108763456345,0.0598185732960701,0.059368111193180084,0.05890906974673271,0.05852475017309189,0.058126579970121384,0.05774581432342529,0.057423532009124756,0.05703505128622055,0.05670630931854248,0.0564313605427742,0.0560917854309082,0.05584964156150818,0.05555373430252075,0.05531654879450798,0.055079441517591476,0.05474912002682686,0.054566968232393265,0.054343901574611664,0.05410653352737427,0.05386139079928398,0.053679149597883224,0.05346481129527092,0.05322238802909851,0.053042925894260406,0.052816636860370636,0.05269733816385269,0.052458375692367554,0.052320338785648346,0.05211177468299866,0.051927633583545685,0.05173618718981743,0.051594026386737823,0.05144954472780228,0.05126626417040825,0.05114476755261421,0.050959665328264236,0.05078067630529404,0.05064412206411362,0.05049042031168938,0.05035354942083359,0.05026579648256302,0.05005175992846489,0.04990915209054947,0.049795400351285934,0.04974640533328056,0.04956943169236183,0.049391888082027435,0.049309004098176956,0.04915960133075714,0.049044352024793625,0.04888765513896942,0.048810940235853195,0.04867895692586899,0.04860278218984604,0.04846802353858948,0.048407670110464096,0.04826562479138374,0.04811784625053406,0.04807233065366745,0.04795963317155838,0.04781457036733627,0.04787885397672653,0.04765937477350235,0.04754389449954033,0.04754630848765373,0.047390200197696686,0.04726993292570114,0.04717705771327019,0.04718714579939842,0.047105900943279266,0.04699001461267471,0.046915214508771896,0.04678792506456375,0.04684882238507271,0.04672122001647949,0.0465753972530365,0.046524014323949814,0.046443045139312744,0.046399716287851334,0.0463402196764946,0.046267010271549225,0.04623088613152504,0.04621661826968193,0.046200286597013474,0.04607899859547615,0.046027492731809616,0.046073053032159805,0.04591233655810356,0.045882269740104675,0.04587418958544731,0.04581889882683754,0.045710790902376175,0.04569104313850403,0.045678772032260895,0.045614298433065414,0.04558092728257179,0.04555822163820267,0.04554315283894539,0.04550888389348984,0.04544676095247269,0.04545532166957855,0.04537157341837883,0.04535803943872452,0.04533793404698372,0.045479290187358856,0.04527776315808296,0.04523149132728577,0.04525337368249893,0.045269228518009186,0.04515894129872322,0.04520202800631523,0.04521938040852547,0.04510306566953659,0.04509028047323227,0.045069001615047455,0.0451601967215538,0.045041751116514206,0.04503587633371353,0.0450480692088604,0.04508117213845253,0.045013897120952606,0.04502252861857414,0.04499562084674835,0.0449669286608696,0.0449456088244915,0.04498939588665962,0.04499682039022446,0.04493501037359238,0.0449567511677742,0.04497172310948372,0.04485863074660301,0.04487214982509613,0.04490309953689575,0.0449187234044075,0.0448421947658062,0.04493585228919983,0.04483453184366226,0.044839464128017426,0.044898584485054016,0.044826433062553406,0.04483019560575485,0.044898759573698044,0.044815778732299805,0.044859010726213455,0.04482128843665123,0.04481198266148567,0.04481817036867142],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"y":[0.12985625863075256,0.12693987786769867,0.12450022250413895,0.12235836684703827,0.12027731537818909,0.11834153532981873,0.1164153516292572,0.1145654022693634,0.11281900107860565,0.11108800768852234,0.10938655585050583,0.10771586745977402,0.10606484860181808,0.10446638613939285,0.1029202938079834,0.10134363919496536,0.09983067214488983,0.09836795181035995,0.0969347432255745,0.09555144608020782,0.09426262974739075,0.09296509623527527,0.09165137261152267,0.09036273509263992,0.08918149024248123,0.08801046013832092,0.08683062344789505,0.08566263318061829,0.0845412015914917,0.08352623134851456,0.08247509598731995,0.08146536350250244,0.08052852749824524,0.07958516478538513,0.0786375030875206,0.07773901522159576,0.0768737643957138,0.07601054757833481,0.07520018517971039,0.07439381629228592,0.07367835938930511,0.0729648545384407,0.07223521918058395,0.07155590504407883,0.07087893784046173,0.07022269070148468,0.0696084052324295,0.0689849928021431,0.06837479770183563,0.06780587136745453,0.06727522611618042,0.06676867604255676,0.06626655161380768,0.06579703837633133,0.06537149101495743,0.06494028866291046,0.06453606486320496,0.0641508400440216,0.0637885332107544,0.06345594674348831,0.0631159245967865,0.06279295682907104,0.06249666213989258,0.06219435855746269,0.06190755218267441,0.061637114733457565,0.0613831989467144,0.061139658093452454,0.060897160321474075,0.06066174805164337,0.06043499335646629,0.06021718680858612,0.05999476835131645,0.05978575721383095,0.059580639004707336,0.05937807261943817,0.05917855724692345,0.05898521840572357,0.05879564583301544,0.05860769748687744,0.0584276057779789,0.05825277790427208,0.05808069556951523,0.057909537106752396,0.05774278566241264,0.057581327855587006,0.05742094665765762,0.057265505194664,0.0571104921400547,0.05695849284529686,0.05681030452251434,0.05666251480579376,0.05651954188942909,0.056381165981292725,0.0562419630587101,0.05610434710979462,0.055970679968595505,0.0558374784886837,0.05570831522345543,0.055580899119377136,0.05545662343502045,0.05533444508910179,0.05521421134471893,0.055095743387937546,0.054979659616947174,0.054865993559360504,0.054754629731178284,0.05464529991149902,0.05453881248831749,0.054433390498161316,0.054330501705408096,0.05422895774245262,0.054130081087350845,0.05403335392475128,0.053939517587423325,0.0538470521569252,0.053756024688482285,0.05366825684905052,0.053581561893224716,0.053496718406677246,0.05341397598385811,0.05333388224244118,0.05325567349791527,0.05317913368344307,0.053104009479284286,0.053031086921691895,0.05296109616756439,0.05289187654852867,0.05282406508922577,0.05275814235210419,0.05269429460167885,0.052631936967372894,0.05257117375731468,0.05251246690750122,0.052455250173807144,0.05240034684538841,0.05234755575656891,0.052295371890068054,0.052245188504457474,0.05219779163599014,0.052150413393974304,0.05210486799478531,0.05206087976694107,0.05201852694153786,0.051977094262838364,0.05193698778748512,0.05189870670437813,0.05186168849468231,0.05182628333568573,0.05179179087281227,0.051758553832769394,0.051726583391427994,0.05169570446014404,0.05166592448949814,0.051637325435876846,0.05160943418741226,0.051582589745521545,0.051558319479227066,0.05153338611125946,0.051509324461221695,0.05148597061634064,0.051463380455970764,0.05144151300191879,0.05142080783843994,0.051400765776634216,0.051381468772888184,0.05136262997984886,0.05134481564164162,0.05132824182510376,0.05131195858120918,0.0512961708009243,0.0512811578810215,0.051266852766275406,0.051253270357847214,0.05124038830399513,0.05122782289981842,0.0512160062789917,0.0512046255171299,0.05119400843977928,0.051183998584747314,0.051174286752939224,0.051165103912353516,0.051156822592020035,0.05114863067865372,0.05114121362566948,0.051133811473846436,0.051127396523952484,0.05112103000283241,0.0511157363653183,0.051110826432704926,0.051106046885252,0.05110204592347145,0.051098182797431946,0.051094770431518555,0.05109243467450142,0.05108928680419922,0.051086995750665665,0.051084671169519424,0.05108272656798363,0.05108116939663887],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"training epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training and Validation Loss - RNN"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('4f8caec7-c797-4fd8-809d-f9d30ba509fe');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="forecasting---next-5-years-60-months-3" class="level4">
<h4 class="anchored" data-anchor-id="forecasting---next-5-years-60-months-3">Forecasting - next 5 years (60 months)</h4>
<div class="cell" data-execution_count="29">
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 16ms/step</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="deeplearning_files/figure-html/cell-30-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="model-2---gru-1" class="level3">
<h3 class="anchored" data-anchor-id="model-2---gru-1">Model 2 - GRU</h3>
<section id="model-architecture-4" class="level4">
<h4 class="anchored" data-anchor-id="model-architecture-4">Model Architecture</h4>
<div class="cell" data-execution_count="30">
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_4"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 gru_1 (GRU)                 (None, 3)                 54        
                                                                 
 dense_4 (Dense)             (None, 1)                 4         
                                                                 
=================================================================
Total params: 58
Trainable params: 58
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="plot-training-and-validation-loss-2" class="level4">
<h4 class="anchored" data-anchor-id="plot-training-and-validation-loss-2">Plot training and validation loss</h4>
<div class="cell" data-execution_count="32">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 22ms/step
(51, 9, 1) (51,) (51,) (5, 9, 1) (5,) (5,)
(51,) (51,)
0.040841345
0.0011350267
Train MSE = 0.04084 RMSE = 0.20209
Test MSE = 0.00114 RMSE = 0.03369</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="ad7aec15-4ec9-4e82-bef9-28b643c86645" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("ad7aec15-4ec9-4e82-bef9-28b643c86645")) {                    Plotly.newPlot(                        "ad7aec15-4ec9-4e82-bef9-28b643c86645",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"xaxis":"x","y":[0.11235632002353668,0.1033291220664978,0.09768525511026382,0.09314218908548355,0.0892600566148758,0.08575361222028732,0.08248923718929291,0.07958152145147324,0.07682399451732635,0.07445522397756577,0.07223044335842133,0.07023646682500839,0.06858347356319427,0.06712804734706879,0.06588523089885712,0.06468109041452408,0.0638243705034256,0.06307987123727798,0.062155455350875854,0.06149808689951897,0.060994137078523636,0.06034683436155319,0.060246068984270096,0.059546686708927155,0.05907389521598816,0.05852247402071953,0.05823109671473503,0.0577128641307354,0.05749673396348953,0.05709006264805794,0.056632138788700104,0.056203532963991165,0.05591421201825142,0.05539392679929733,0.05516510084271431,0.05470302700996399,0.0544615164399147,0.05418891832232475,0.05364032834768295,0.053408484905958176,0.05317683890461922,0.05266221612691879,0.05247340723872185,0.05223296210169792,0.051984380930662155,0.05159379169344902,0.05135393142700195,0.05122146010398865,0.05079321935772896,0.05048935487866402,0.050138674676418304,0.04981806501746178,0.04982147738337517,0.0493956133723259,0.04904839023947716,0.04898594692349434,0.048959724605083466,0.04843495041131973,0.048264048993587494,0.048051781952381134,0.047669000923633575,0.0475330613553524,0.0473189577460289,0.04730561748147011,0.047013361006975174,0.04704546183347702,0.04646052047610283,0.046453602612018585,0.0462421178817749,0.046570587903261185,0.045780591666698456,0.045626334846019745,0.045662831515073776,0.04548635706305504,0.045297302305698395,0.04507993906736374,0.04500933364033699,0.044694043695926666,0.044981859624385834,0.04458128660917282,0.044434450566768646,0.044296037405729294,0.04409357160329819,0.044218942523002625,0.04397180676460266,0.04384223371744156,0.04359383136034012,0.043635837733745575,0.043652236461639404,0.04336485266685486,0.04323028773069382,0.04317140206694603,0.04324604198336601,0.04302850365638733,0.04314098879694939,0.0428273007273674,0.04283289238810539,0.042751457542181015,0.04272761568427086,0.04261767119169235,0.04236022010445595,0.04229498654603958,0.04223217815160751,0.04249286651611328,0.0421626940369606,0.04226674884557724,0.04210793226957321,0.042125385254621506,0.041889678686857224,0.04196210950613022,0.041989125311374664,0.04185393080115318,0.04222821444272995,0.041690945625305176,0.04168324172496796,0.041611745953559875,0.041688404977321625,0.04166615009307861,0.04153132438659668,0.04149997979402542,0.041620321571826935,0.041591569781303406,0.041354306042194366,0.041376419365406036,0.04133371636271477,0.04131298512220383,0.04143787920475006,0.04141934961080551,0.04171816259622574,0.04135891795158386,0.041163235902786255,0.04124309867620468,0.041341833770275116,0.04128200560808182,0.0412638857960701,0.04125059396028519,0.041051022708415985,0.04128227382898331,0.04117245599627495,0.04108298942446709,0.04096800833940506,0.04094179719686508,0.04152301326394081,0.04144720733165741,0.04099182412028313,0.04098060354590416,0.04100195690989494,0.04096793755888939,0.041054271161556244,0.04094535484910011,0.041114237159490585,0.04086224362254143,0.040906719863414764,0.04092112556099892,0.04089508205652237,0.04086027294397354,0.04078517481684685,0.04079325869679451,0.04100349545478821,0.04091932997107506,0.04084330052137375,0.040899720042943954,0.040817126631736755,0.04079296067357063,0.04073706641793251,0.04083744436502457,0.040821708738803864,0.04069245606660843,0.040592361241579056,0.04054807871580124,0.040601059794425964,0.04078653082251549,0.040587376803159714,0.04055783152580261,0.04066159203648567,0.040496449917554855,0.04057278111577034,0.04089495912194252,0.04040050134062767,0.04065253585577011,0.04041271284222603,0.04052932932972908,0.04054409638047218,0.04038314148783684,0.04085882008075714,0.04029231518507004,0.04049064964056015,0.04041760414838791,0.04044636711478233,0.040209390223026276,0.04018363356590271,0.04044593870639801,0.04033910483121872,0.0403532013297081,0.04041972756385803,0.04014074429869652,0.040355779230594635,0.04006557539105415,0.04042375087738037,0.040040522813797],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"y":[0.1129285991191864,0.1065048947930336,0.1016368418931961,0.09748289734125137,0.09385891258716583,0.09039578586816788,0.08732783049345016,0.08445420861244202,0.08186502754688263,0.07953541725873947,0.07741087675094604,0.0755804106593132,0.07386254519224167,0.07250018417835236,0.07131527364253998,0.07021894305944443,0.06933855265378952,0.06856027245521545,0.06780458241701126,0.06709432601928711,0.0664953887462616,0.06593888252973557,0.06548246741294861,0.06503251194953918,0.06457710266113281,0.06412982940673828,0.06369537860155106,0.0632488951086998,0.06284309178590775,0.062451887875795364,0.06207174435257912,0.06166834756731987,0.06128647178411484,0.06090528890490532,0.0605403296649456,0.06018402799963951,0.05982917919754982,0.05949743092060089,0.0591447688639164,0.05881460756063461,0.05849650874733925,0.05816524103283882,0.057847216725349426,0.05753551796078682,0.05722641572356224,0.05692265182733536,0.05662231147289276,0.05635634809732437,0.05608321353793144,0.055827341973781586,0.05555463954806328,0.055272337049245834,0.05500901862978935,0.05476254224777222,0.054499052464962006,0.05423326790332794,0.053995538502931595,0.05374040827155113,0.05350140109658241,0.053281188011169434,0.05305654928088188,0.05281896889209747,0.05260193720459938,0.052399564534425735,0.05220590531826019,0.05202818289399147,0.05182214826345444,0.051615580916404724,0.05143841728568077,0.051299139857292175,0.05110795795917511,0.05092393234372139,0.050757113844156265,0.05058752000331879,0.05043990910053253,0.05028364434838295,0.050141312181949615,0.04996760934591293,0.04984259605407715,0.04969530925154686,0.04956341162323952,0.04941955581307411,0.04927748814225197,0.04915088415145874,0.04901914298534393,0.048906922340393066,0.048774197697639465,0.04866228252649307,0.04855537787079811,0.04844759777188301,0.04833805188536644,0.048227980732917786,0.04812835156917572,0.0480259507894516,0.04794348403811455,0.04786820709705353,0.047779250890016556,0.047678589820861816,0.04760267585515976,0.04752228409051895,0.04744541645050049,0.04735462740063667,0.04726838693022728,0.04719916358590126,0.0471310131251812,0.047077104449272156,0.046997204422950745,0.04694846644997597,0.04687133803963661,0.046809423714876175,0.04675896093249321,0.04671962559223175,0.046714283525943756,0.046655889600515366,0.04661183059215546,0.046546243131160736,0.046491388231515884,0.04644862562417984,0.04641002416610718,0.04636600986123085,0.04631161689758301,0.046272922307252884,0.04623067006468773,0.046169642359018326,0.04613596200942993,0.04610424116253853,0.046082839369773865,0.04605579376220703,0.046067975461483,0.04604001343250275,0.04601270332932472,0.045980192720890045,0.04594658687710762,0.04591728746891022,0.045911237597465515,0.04588225111365318,0.045850981026887894,0.04581497609615326,0.04578118026256561,0.0457310788333416,0.04569661244750023,0.045683372765779495,0.04571206867694855,0.045714739710092545,0.045669637620449066,0.04566054418683052,0.04561610147356987,0.04558631405234337,0.04556245729327202,0.04550544172525406,0.04548424482345581,0.04544498026371002,0.045435257256031036,0.045398641377687454,0.04538017138838768,0.045345935970544815,0.04531997814774513,0.04528653994202614,0.045268043875694275,0.045263465493917465,0.04526109620928764,0.045231714844703674,0.04521047696471214,0.04518967494368553,0.045180272310972214,0.04514753818511963,0.045136626809835434,0.04511931166052818,0.04510556906461716,0.045058250427246094,0.04503004252910614,0.04499821737408638,0.044965118169784546,0.044941309839487076,0.044908735901117325,0.04487554728984833,0.04483030363917351,0.044854309409856796,0.044808801263570786,0.04479508101940155,0.04475224390625954,0.04472299665212631,0.04471264407038689,0.044670119881629944,0.04469482973217964,0.044662654399871826,0.044627126306295395,0.04460808262228966,0.044592078775167465,0.04454203322529793,0.044515710324048996,0.044489409774541855,0.04444403946399689,0.04441656544804573,0.04438815638422966,0.04437291622161865,0.04433957114815712,0.0442960299551487,0.04429905116558075,0.04427575320005417],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"training epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training and Validation Loss - GRU"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('ad7aec15-4ec9-4e82-bef9-28b643c86645');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="forecasting---next-5-years-60-months-4" class="level4">
<h4 class="anchored" data-anchor-id="forecasting---next-5-years-60-months-4">Forecasting - next 5 years (60 months)</h4>
<div class="cell" data-execution_count="33">
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 18ms/step</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="deeplearning_files/figure-html/cell-34-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="model-3---lstm-1" class="level3">
<h3 class="anchored" data-anchor-id="model-3---lstm-1">Model 3 - LSTM</h3>
<section id="model-architecture-5" class="level4">
<h4 class="anchored" data-anchor-id="model-architecture-5">Model Architecture</h4>
<div class="cell" data-execution_count="34">
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_5"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 lstm_1 (LSTM)               (None, 3)                 60        
                                                                 
 dense_5 (Dense)             (None, 1)                 4         
                                                                 
=================================================================
Total params: 64
Trainable params: 64
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="plot-training-and-validation-loss-3" class="level4">
<h4 class="anchored" data-anchor-id="plot-training-and-validation-loss-3">Plot training and validation loss</h4>
<div class="cell" data-execution_count="36">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 16ms/step
(51, 9, 1) (51,) (51,) (5, 9, 1) (5,) (5,)
(51,) (51,)
0.044831607
0.0038871728
Train MSE = 0.04483 RMSE = 0.21173
Test MSE = 0.00389 RMSE = 0.06235</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="4819898a-c74f-4800-974f-9b266d6ebdfc" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("4819898a-c74f-4800-974f-9b266d6ebdfc")) {                    Plotly.newPlot(                        "4819898a-c74f-4800-974f-9b266d6ebdfc",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"xaxis":"x","y":[0.1623610407114029,0.15216287970542908,0.14530307054519653,0.1398463100194931,0.13499322533607483,0.13056518137454987,0.12645497918128967,0.12251070886850357,0.11879394203424454,0.11524532735347748,0.11175783723592758,0.10844621807336807,0.10522594302892685,0.10213687270879745,0.09913933277130127,0.09619738161563873,0.0933566689491272,0.09067139029502869,0.08800896257162094,0.08561652153730392,0.0833372101187706,0.08125472068786621,0.0792049765586853,0.07732079923152924,0.07534874975681305,0.0735006034374237,0.07174824178218842,0.07009690254926682,0.0685855969786644,0.06711172312498093,0.06579563021659851,0.06450151652097702,0.06352628022432327,0.06262822449207306,0.06163026764988899,0.060802411288022995,0.05998343229293823,0.05939112976193428,0.05873606353998184,0.05816056206822395,0.05765838176012039,0.057292450219392776,0.056893669068813324,0.05651792883872986,0.05613631755113602,0.05577651783823967,0.05577801913022995,0.05524712800979614,0.05495113879442215,0.0548371896147728,0.05442916229367256,0.05424299091100693,0.054072994738817215,0.053663454949855804,0.053497977554798126,0.053155940026044846,0.05289924144744873,0.05271406099200249,0.052589643746614456,0.05241253226995468,0.052101463079452515,0.05184394121170044,0.05170430988073349,0.05151193588972092,0.0512440986931324,0.05120724439620972,0.05081356316804886,0.05068950727581978,0.050503648817539215,0.050481509417295456,0.050259560346603394,0.05004286766052246,0.0497271865606308,0.04978223890066147,0.04969559237360954,0.04929139465093613,0.04926314949989319,0.049101389944553375,0.04879492521286011,0.04875584691762924,0.048607394099235535,0.04844757914543152,0.04848277196288109,0.04825010895729065,0.04798707365989685,0.04784642904996872,0.04773842915892601,0.04766017571091652,0.04769638925790787,0.0475410521030426,0.047477953135967255,0.04719894751906395,0.047084249556064606,0.04703761264681816,0.04685993120074272,0.04689096659421921,0.04668426141142845,0.046582192182540894,0.046689122915267944,0.04641664773225784,0.04634037986397743,0.046377576887607574,0.04627455398440361,0.046105556190013885,0.04605419933795929,0.04614947736263275,0.04581142216920853,0.04571972042322159,0.04593346267938614,0.045781850814819336,0.04568684473633766,0.04552878066897392,0.04559547081589699,0.04535888507962227,0.045391324907541275,0.045329220592975616,0.04530881717801094,0.04519527778029442,0.04533730819821358,0.04518119990825653,0.04538260027766228,0.045296672731637955,0.04491168260574341,0.0449935607612133,0.04494364187121391,0.0449608638882637,0.04488532990217209,0.04498017579317093,0.04499365761876106,0.04479869082570076,0.04466380923986435,0.044729284942150116,0.04463452100753784,0.04483857750892639,0.04472880810499191,0.044535405933856964,0.044516973197460175,0.0445060171186924,0.04474327713251114,0.044726576656103134,0.04439525678753853,0.044375620782375336,0.04444495961070061,0.044388048350811005,0.044627994298934937,0.04439316689968109,0.044650811702013016,0.044284895062446594,0.04441361874341965,0.04433499276638031,0.04424099996685982,0.044387903064489365,0.044173430651426315,0.04441200941801071,0.04438971355557442,0.04430750012397766,0.04421009495854378,0.04422803595662117,0.044200800359249115,0.044132355600595474,0.04439450055360794,0.04425082728266716,0.04422633722424507,0.0442185178399086,0.04420020803809166,0.04420100525021553,0.04406949132680893,0.04412209615111351,0.04415058344602585,0.044219862669706345,0.044084582477808,0.04421822354197502,0.04396131634712219,0.044274769723415375,0.04403999075293541,0.04405909776687622,0.04393980652093887,0.04409080371260643,0.044102735817432404,0.04414160177111626,0.04393677040934563,0.043918728828430176,0.04393748193979263,0.044008463621139526,0.04405442997813225,0.04384410381317139,0.04401559755206108,0.04388483613729477,0.04393642023205757,0.04416969418525696,0.04381459951400757,0.04392991587519646,0.04397735372185707,0.043829578906297684,0.043778736144304276,0.04378494620323181,0.04379582405090332,0.044052910059690475,0.04387510567903519,0.043877821415662766],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"y":[0.1593017280101776,0.15193913877010345,0.14609089493751526,0.14122141897678375,0.13674446940422058,0.13265395164489746,0.12873126566410065,0.1249847486615181,0.12149615585803986,0.11806581169366837,0.1147424727678299,0.11155037581920624,0.10852880775928497,0.10551359504461288,0.10264179110527039,0.09980254620313644,0.09708962589502335,0.09444103389978409,0.09197759628295898,0.0895998477935791,0.08756576478481293,0.08556810021400452,0.08364003151655197,0.08177840709686279,0.07990513741970062,0.07808338850736618,0.0764775350689888,0.0748685672879219,0.07343930751085281,0.07205849140882492,0.07076482474803925,0.0695694088935852,0.06863308697938919,0.0678068995475769,0.06694252789020538,0.06613559275865555,0.06534893810749054,0.06475014239549637,0.06415138393640518,0.06362682580947876,0.06314840167760849,0.0627482607960701,0.06237966939806938,0.06204637512564659,0.061726607382297516,0.06141061708331108,0.06111905351281166,0.060835037380456924,0.06055587902665138,0.060306668281555176,0.060048092156648636,0.05979813635349274,0.05955682694911957,0.05931505188345909,0.05908471345901489,0.05885281786322594,0.05862366035580635,0.058400560170412064,0.058176878839731216,0.057965729385614395,0.05775810405611992,0.05755310878157616,0.05734587833285332,0.05714738368988037,0.056952789425849915,0.05676090344786644,0.05657179653644562,0.05638638883829117,0.05620311200618744,0.05602683871984482,0.05585862323641777,0.0556907020509243,0.05552326515316963,0.05536166578531265,0.05520520359277725,0.05505009740591049,0.05489783361554146,0.05475101247429848,0.0546051487326622,0.05446156486868858,0.05432439222931862,0.05418691784143448,0.05405290052294731,0.0539240799844265,0.053793251514434814,0.05366668850183487,0.05354374274611473,0.05342055484652519,0.05330074951052666,0.05318818986415863,0.053086671978235245,0.05298241600394249,0.052879273891448975,0.05277163162827492,0.052669525146484375,0.052571509033441544,0.05247531831264496,0.05238093063235283,0.05229330435395241,0.05220724642276764,0.05212677642703056,0.052046772092580795,0.05196686089038849,0.05189524590969086,0.05181872844696045,0.05174819007515907,0.05167873203754425,0.05160486325621605,0.05153701454401016,0.051472846418619156,0.05141110718250275,0.05134901776909828,0.05129123851656914,0.05123528093099594,0.051179300993680954,0.05112439766526222,0.051070865243673325,0.051018498837947845,0.05097221955657005,0.050927624106407166,0.050893403589725494,0.050858404487371445,0.05081740766763687,0.05078400298953056,0.050748612731695175,0.05071035772562027,0.05067024007439613,0.050637733191251755,0.05061265081167221,0.05058237165212631,0.050546612590551376,0.05051371082663536,0.05048133060336113,0.05045457184314728,0.050428520888090134,0.050401851534843445,0.05037231370806694,0.05034910514950752,0.050329577177762985,0.050315018743276596,0.05028943717479706,0.05026300996541977,0.050242673605680466,0.05022662505507469,0.05020669847726822,0.050185706466436386,0.05017789825797081,0.05015876144170761,0.05014638602733612,0.05012922361493111,0.05010859668254852,0.05009707063436508,0.05007350444793701,0.050057683140039444,0.05004793405532837,0.05003488063812256,0.050014927983284,0.05000133439898491,0.049983810633420944,0.04997532442212105,0.04996873438358307,0.04995627701282501,0.0499483197927475,0.049936357885599136,0.0499282032251358,0.04991573467850685,0.04989983141422272,0.04988448694348335,0.049870941787958145,0.04986325651407242,0.04984918609261513,0.04983978345990181,0.049827851355075836,0.0498218797147274,0.049808863550424576,0.04980245605111122,0.04978922754526138,0.049776531755924225,0.04976861551403999,0.049761977046728134,0.04975581541657448,0.04974527284502983,0.04973049461841583,0.04972327873110771,0.04971122369170189,0.049696456640958786,0.04968477785587311,0.049669209867715836,0.049656931310892105,0.04965372011065483,0.049646079540252686,0.04964251443743706,0.04963107407093048,0.04961913451552391,0.0496031679213047,0.049594830721616745,0.0495801717042923,0.04957416281104088,0.04956663027405739,0.0495586059987545],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"training epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training and Validation Loss - LSTM"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('4819898a-c74f-4800-974f-9b266d6ebdfc');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="forecasting---next-5-years-60-months-5" class="level4">
<h4 class="anchored" data-anchor-id="forecasting---next-5-years-60-months-5">Forecasting - next 5 years (60 months)</h4>
<div class="cell" data-execution_count="37">
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 17ms/step</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="deeplearning_files/figure-html/cell-38-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="discussion-1" class="level3">
<h3 class="anchored" data-anchor-id="discussion-1">Discussion</h3>
<p>For predicting CO2 emissions from Hydro Power, the training RMSE are: <br> 1) RNN - 0.17576<br> 2) GRU - 0.19256<br> 3) LSTM - 0.18912<br> <br></p>
<p>And the test RMSE are:<br> 1) RNN - 0.07061<br> 2) GRU - 0.02567<br> 3) LSTM - 0.07663<br></p>
<p>Thus, the RNN minimized RMSE for training predictions, but the GRU ANN produced the lowest test RMSE of the group. Test RMSE is significantly lower than training RMSE, so further analysis could investigate possible data leakage. Regularization again improved the model performance, by 0.04 points in the RMSE.</p>
<p>Forecasting here worked better than expected. For all three models I forecasted the next 5 years (60) months, and the forecasted plots appear to mimic the seasonality and spikes of the previous 30 years. Across all three models, the first 4 years are well forecasted and display the expected spikes in emissions during the summer. However, by year 5 forecast weakens and the nuance and variation in the trend is smaller.</p>
<p>The ARIMA(1,1,2)(0,1,1) forecast shared the same seasonality, but exhibited an upwards trend across all 5 years. The ANN models exhibit no trend (only seasonality). The RNSE from the ARIMA model was 0.07292737, significantly smaller than the ANN RMSE. With more model tuning the ANN could likely outperform the ARIMA model.</p>
</section>
</section>
<section id="natural-gas" class="level2">
<h2 class="anchored" data-anchor-id="natural-gas">Natural Gas</h2>
<section id="split-data-into-training-and-testing-data-2" class="level3">
<h3 class="anchored" data-anchor-id="split-data-into-training-and-testing-data-2">Split data into training and testing data</h3>
<p>And visualize split!</p>
<div class="cell" data-execution_count="38">
<div class="cell-output cell-output-stdout">
<pre><code>Training data size:  (519,)
Test data size:  (130,)</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="55e94211-6ab4-4c38-847e-b283f3826bae" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("55e94211-6ab4-4c38-847e-b283f3826bae")) {                    Plotly.newPlot(                        "55e94211-6ab4-4c38-847e-b283f3826bae",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518],"xaxis":"x","y":[0.26110875606536865,0.23300564289093018,0.2174530029296875,0.19012415409088135,0.17273688316345215,0.1386784315109253,0.1428607702255249,0.14706039428710938,0.13678324222564697,0.16844725608825684,0.20006167888641357,0.23917269706726074,0.8974436521530151,0.24761199951171875,0.2237480878829956,0.21638107299804688,0.1682368516921997,0.15302729606628418,0.12130570411682129,0.1354612112045288,0.13442301750183105,0.13907194137573242,0.16899287700653076,0.1888883113861084,0.2300206422805786,0.8874245882034302,0.2483431100845337,0.20696818828582764,0.20145142078399658,0.14828944206237793,0.09943485260009766,0.08245742321014404,0.09474408626556396,0.10622560977935791,0.10615909099578857,0.1399857997894287,0.15745925903320312,0.22168338298797607,0.8634310960769653,0.25390398502349854,0.2066500186920166,0.17250490188598633,0.1345539093017578,0.11964130401611328,0.0990825891494751,0.10645198822021484,0.09473192691802979,0.09132802486419678,0.15325582027435303,0.19566023349761963,0.24600815773010254,0.8689192533493042,0.2681998014450073,0.1892094612121582,0.17159688472747803,0.12133538722991943,0.10836577415466309,0.09870994091033936,0.09704875946044922,0.10506308078765869,0.11753582954406738,0.13524258136749268,0.16612458229064941,0.22974491119384766,0.8630361557006836,0.26423048973083496,0.23432612419128418,0.20320141315460205,0.13997185230255127,0.10870659351348877,0.08037769794464111,0.0986095666885376,0.08797454833984375,0.07644987106323242,0.11973810195922852,0.16020596027374268,0.2238178253173828,0.8641737699508667,0.2702372074127197,0.24371659755706787,0.1984647512435913,0.15091538429260254,0.1190258264541626,0.09403562545776367,0.09856545925140381,0.10101056098937988,0.09795093536376953,0.14277148246765137,0.17912650108337402,0.22486233711242676,0.8736141920089722,0.24640703201293945,0.23521602153778076,0.22235167026519775,0.1394127607345581,0.10354924201965332,0.08145773410797119,0.09068512916564941,0.08754110336303711,0.09078419208526611,0.13517546653747559,0.1769932508468628,0.23192286491394043,0.8676444292068481,0.25176429748535156,0.19988739490509033,0.1997666358947754,0.13008511066436768,0.11744940280914307,0.09316182136535645,0.09412121772766113,0.09363985061645508,0.08258473873138428,0.13448667526245117,0.15317308902740479,0.22435224056243896,0.8605738878250122,0.26709890365600586,0.21373248100280762,0.19121289253234863,0.13078463077545166,0.054064393043518066,0.04823434352874756,0.056112051010131836,0.057677507400512695,0.054252028465270996,0.09330499172210693,0.14329314231872559,0.17520880699157715,0.8402361869812012,0.2455369234085083,0.19341206550598145,0.17788124084472656,0.13366854190826416,0.0774153470993042,0.03602325916290283,0.03502190113067627,0.044736385345458984,0.028131842613220215,0.044988393783569336,0.09007823467254639,0.16043519973754883,0.8219493627548218,0.261627197265625,0.21033108234405518,0.19288551807403564,0.15272891521453857,0.10339927673339844,0.0644296407699585,0.05898082256317139,0.05901312828063965,0.04120945930480957,0.06534194946289062,0.1124035120010376,0.17520582675933838,0.8406360149383545,0.23108041286468506,0.23801982402801514,0.1743708848953247,0.1238318681716919,0.05694448947906494,0.0390019416809082,0.04965317249298096,0.049567341804504395,0.029526352882385254,0.05658674240112305,0.09633779525756836,0.2026979923248291,0.8298665285110474,0.23735284805297852,0.19942903518676758,0.17490220069885254,0.1034308671951294,0.061556100845336914,0.02783358097076416,0.026544570922851562,0.016166210174560547,0.0,0.02219092845916748,0.08047175407409668,0.16544973850250244,0.8112574815750122,0.23417901992797852,0.20533788204193115,0.1786363124847412,0.12237787246704102,0.06661081314086914,0.045046448707580566,0.04345357418060303,0.05171835422515869,0.030414819717407227,0.07503259181976318,0.11783218383789062,0.18687140941619873,0.8287758827209473,0.2419959306716919,0.22175896167755127,0.1964435577392578,0.12684857845306396,0.09317409992218018,0.06226348876953125,0.06383633613586426,0.07466185092926025,0.04399847984313965,0.0766448974609375,0.12416946887969971,0.18901968002319336,0.8412625789642334,0.22323858737945557,0.2218707799911499,0.213303804397583,0.1550809144973755,0.11041676998138428,0.07795071601867676,0.08393967151641846,0.08251261711120605,0.07343733310699463,0.10770595073699951,0.15124571323394775,0.2415252923965454,0.8591548204421997,0.2391970157623291,0.19649481773376465,0.19080400466918945,0.1577136516571045,0.1180046796798706,0.09730279445648193,0.09543061256408691,0.101828932762146,0.09340715408325195,0.11889147758483887,0.14740192890167236,0.21326887607574463,0.8589605093002319,0.2606867551803589,0.20815813541412354,0.19829225540161133,0.14932870864868164,0.1104590892791748,0.08080935478210449,0.10226094722747803,0.10005021095275879,0.0880119800567627,0.12714993953704834,0.1746135950088501,0.2223438024520874,0.8648611307144165,0.25410139560699463,0.22691690921783447,0.2130221128463745,0.17668545246124268,0.12886130809783936,0.09898638725280762,0.11249518394470215,0.10069608688354492,0.09584414958953857,0.11774587631225586,0.1726781129837036,0.23876845836639404,0.8743447065353394,0.25783538818359375,0.2430797815322876,0.24015021324157715,0.17108416557312012,0.09836471080780029,0.10118162631988525,0.11788463592529297,0.12260663509368896,0.09872591495513916,0.13953101634979248,0.18630290031433105,0.2377638816833496,0.8814641237258911,0.28643548488616943,0.25993454456329346,0.22606706619262695,0.16427361965179443,0.12025177478790283,0.12277257442474365,0.12447738647460938,0.13059473037719727,0.11456620693206787,0.13542592525482178,0.1768958568572998,0.23228180408477783,0.887884259223938,0.2714637517929077,0.24689102172851562,0.23521125316619873,0.18842339515686035,0.15389084815979004,0.12421345710754395,0.14941251277923584,0.16179120540618896,0.12484347820281982,0.1377394199371338,0.2028205394744873,0.2605710029602051,0.8999956846237183,0.29089152812957764,0.26235926151275635,0.24700069427490234,0.19400954246520996,0.15898525714874268,0.13862264156341553,0.13941621780395508,0.14521706104278564,0.12717890739440918,0.147810697555542,0.20458412170410156,0.25319647789001465,0.9050635099411011,0.28400325775146484,0.25230252742767334,0.23680782318115234,0.19142425060272217,0.1593937873840332,0.13929462432861328,0.16338670253753662,0.1572340726852417,0.13963520526885986,0.1503673791885376,0.20488524436950684,0.2631570100784302,0.9067169427871704,0.2738621234893799,0.2360440492630005,0.2404623031616211,0.1790781021118164,0.15055131912231445,0.14996576309204102,0.17309224605560303,0.17519652843475342,0.15076172351837158,0.14282643795013428,0.17947697639465332,0.2404402494430542,0.9014021158218384,0.28582727909088135,0.23562288284301758,0.2443230152130127,0.19409561157226562,0.14837372303009033,0.13864362239837646,0.16639339923858643,0.1724987030029297,0.13778138160705566,0.1558070182800293,0.1737152338027954,0.24589574337005615,0.9027410745620728,0.28317177295684814,0.26059842109680176,0.22737669944763184,0.18929994106292725,0.1744692325592041,0.1537487506866455,0.1633772850036621,0.1866093873977661,0.14400207996368408,0.15224754810333252,0.20455646514892578,0.29167211055755615,0.9141846895217896,0.30009591579437256,0.2578192949295044,0.2496509552001953,0.1870948076248169,0.13778138160705566,0.12298250198364258,0.1516655683517456,0.1643214225769043,0.13225698471069336,0.16053533554077148,0.16941869258880615,0.2330406904220581,0.9015079736709595,0.27843451499938965,0.2487955093383789,0.25059545040130615,0.1979585886001587,0.15347754955291748,0.14985525608062744,0.17671287059783936,0.17292547225952148,0.1408240795135498,0.15926098823547363,0.20284545421600342,0.26554346084594727,0.9108484983444214,0.30295491218566895,0.2809504270553589,0.2439645528793335,0.17744362354278564,0.13662540912628174,0.10774481296539307,0.15232062339782715,0.16131210327148438,0.11968600749969482,0.14363932609558105,0.17865753173828125,0.2521551847457886,0.9023712873458862,0.29978346824645996,0.28166186809539795,0.23037183284759521,0.1771303415298462,0.1471855640411377,0.13116061687469482,0.15005958080291748,0.1482086181640625,0.13005638122558594,0.14401912689208984,0.1830536127090454,0.25987088680267334,0.9036895036697388,0.2879985570907593,0.2498561143875122,0.24486827850341797,0.1742478609085083,0.1385563611984253,0.1408170461654663,0.1682431697845459,0.16962182521820068,0.11917150020599365,0.11988711357116699,0.16385924816131592,0.26036667823791504,0.8992801904678345,0.24068880081176758,0.2379385232925415,0.23539984226226807,0.16817092895507812,0.14067184925079346,0.1450263261795044,0.18130385875701904,0.18004107475280762,0.12799417972564697,0.1616593599319458,0.18206787109375,0.23491311073303223,0.8961900472640991,0.2786327600479126,0.28912651538848877,0.23544931411743164,0.18913066387176514,0.14676928520202637,0.1457444429397583,0.16460788249969482,0.20269536972045898,0.15208470821380615,0.15859556198120117,0.19274723529815674,0.26992321014404297,0.9139808416366577,0.30715179443359375,0.28197169303894043,0.25490403175354004,0.19125044345855713,0.14951324462890625,0.15468251705169678,0.1728975772857666,0.1684190034866333,0.1277083158493042,0.15990853309631348,0.19823575019836426,0.2700439691543579,0.916113018989563,0.30649757385253906,0.26152992248535156,0.24087142944335938,0.17775368690490723,0.1359119415283203,0.1404709815979004,0.16399002075195312,0.17715775966644287,0.14901971817016602,0.164941668510437,0.18314599990844727,0.2802478075027466,0.9112786054611206,0.3139129877090454,0.2783534526824951,0.23615539073944092,0.16836881637573242,0.15528476238250732,0.16112208366394043,0.1903247833251953,0.1985776424407959,0.15895605087280273,0.1636359691619873,0.21249020099639893,0.30392181873321533,0.9245861768722534,0.321567177772522,0.274796724319458,0.2473599910736084,0.1898273229598999,0.16379225254058838,0.16224384307861328,0.2001347541809082,0.20027220249176025,0.16186511516571045,0.17673110961914062,0.22060108184814453,0.28484904766082764,0.9289323091506958,0.3085308074951172,0.2807518243789673,0.23428118228912354,0.2097480297088623,0.19777750968933105,0.19700908660888672,0.22640013694763184,0.21774089336395264,0.1873534917831421,0.20182573795318604,0.23966670036315918,0.2810159921646118],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648],"y":[0.9414950609207153,0.32173216342926025,0.28904008865356445,0.2836726903915405,0.21253061294555664,0.17915380001068115,0.17773854732513428,0.2064523696899414,0.20653200149536133,0.18160676956176758,0.1972672939300537,0.25936949253082275,0.32578396797180176,0.9490333795547485,0.35352814197540283,0.308935284614563,0.2889045476913452,0.2126784324645996,0.18954765796661377,0.17909932136535645,0.2005302906036377,0.20836007595062256,0.18942523002624512,0.2053847312927246,0.2654808759689331,0.30214977264404297,0.9548643827438354,0.34644007682800293,0.32860660552978516,0.2937227487564087,0.22053039073944092,0.19817066192626953,0.20473062992095947,0.22898471355438232,0.22686076164245605,0.20491838455200195,0.21751129627227783,0.2530984878540039,0.29334867000579834,0.9629336595535278,0.34439587593078613,0.30055809020996094,0.2664501667022705,0.23125410079956055,0.21441149711608887,0.21953284740447998,0.244928240776062,0.24773550033569336,0.2117687463760376,0.20840108394622803,0.24143052101135254,0.3226447105407715,0.9650362730026245,0.327018141746521,0.2643314599990845,0.285733699798584,0.2091120481491089,0.20297908782958984,0.20577585697174072,0.23862123489379883,0.23207604885101318,0.20721757411956787,0.22328245639801025,0.26606285572052,0.3431142568588257,0.9614056348800659,0.3650442361831665,0.30513012409210205,0.3139166831970215,0.26388728618621826,0.2250295877456665,0.22632598876953125,0.26392555236816406,0.25934910774230957,0.23897433280944824,0.25564897060394287,0.3053668737411499,0.33391332626342773,0.9900797605514526,0.3726156949996948,0.33671414852142334,0.3276035785675049,0.24704575538635254,0.23653864860534668,0.2347266674041748,0.2697913646697998,0.2744119167327881,0.2462303638458252,0.25891315937042236,0.3130815029144287,0.3504520654678345,1.0000001192092896,0.3635917901992798,0.34014439582824707,0.3065187931060791,0.2528560161590576,0.22812330722808838,0.23585331439971924,0.2779350280761719,0.27017807960510254,0.23865079879760742,0.25979340076446533,0.2751270532608032,0.35131824016571045,0.9940599203109741,0.36482858657836914,0.3438863754272461,0.2975490093231201,0.25419437885284424,0.23369789123535156,0.2504638433456421,0.272000789642334,0.27433621883392334,0.23656833171844482,0.25247764587402344,0.3018532991409302,0.33434104919433594,0.9949885606765747,0.38561975955963135,0.33999478816986084,0.31212449073791504,0.2658109664916992,0.2501506805419922,0.2600346803665161,0.2909811735153198,0.2882871627807617,0.2563042640686035,0.265688419342041,0.3116997480392456,0.3688582181930542],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"t: time (months)"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y(t): Response variable"}},"legend":{"tracegroupgap":0},"title":{"text":"CO2 Emissions per month from Natural Gas since 1973"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('55e94211-6ab4-4c38-847e-b283f3826bae');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="reformat-data-into-required-shape-2" class="level3">
<h3 class="anchored" data-anchor-id="reformat-data-into-required-shape-2">Reformat data into required shape</h3>
<p>Required shape = (samples, time, features)</p>
<div class="cell" data-execution_count="40">
<div class="cell-output cell-output-display">

<div>                            <div id="24dede51-83c8-45f0-892a-fc7d4debae7f" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("24dede51-83c8-45f0-892a-fc7d4debae7f")) {                    Plotly.newPlot(                        "24dede51-83c8-45f0-892a-fc7d4debae7f",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8],"xaxis":"x","y":[0.23300564289093018,0.2174530029296875,0.19012415409088135,0.17273688316345215,0.1386784315109253,0.1428607702255249,0.14706039428710938,0.13678324222564697,0.16844725608825684],"yaxis":"y","type":"scatter"},{"x":[9],"y":[0.20006167888641357],"type":"scatter"},{"mode":"lines","x":[10,11,12,13,14,15,16,17,18],"y":[0.23917269706726074,0.8974436521530151,0.24761199951171875,0.2237480878829956,0.21638107299804688,0.1682368516921997,0.15302729606628418,0.12130570411682129,0.1354612112045288],"type":"scatter"},{"x":[19],"y":[0.13442301750183105],"type":"scatter"},{"mode":"lines","x":[20,21,22,23,24,25,26,27,28],"y":[0.13907194137573242,0.16899287700653076,0.1888883113861084,0.2300206422805786,0.8874245882034302,0.2483431100845337,0.20696818828582764,0.20145142078399658,0.14828944206237793],"type":"scatter"},{"x":[29],"y":[0.09943485260009766],"type":"scatter"},{"mode":"lines","x":[30,31,32,33,34,35,36,37,38],"y":[0.08245742321014404,0.09474408626556396,0.10622560977935791,0.10615909099578857,0.1399857997894287,0.15745925903320312,0.22168338298797607,0.8634310960769653,0.25390398502349854],"type":"scatter"},{"x":[39],"y":[0.2066500186920166],"type":"scatter"},{"mode":"lines","x":[40,41,42,43,44,45,46,47,48],"y":[0.17250490188598633,0.1345539093017578,0.11964130401611328,0.0990825891494751,0.10645198822021484,0.09473192691802979,0.09132802486419678,0.15325582027435303,0.19566023349761963],"type":"scatter"},{"x":[49],"y":[0.24600815773010254],"type":"scatter"},{"mode":"lines","x":[50,51,52,53,54,55,56,57,58],"y":[0.8689192533493042,0.2681998014450073,0.1892094612121582,0.17159688472747803,0.12133538722991943,0.10836577415466309,0.09870994091033936,0.09704875946044922,0.10506308078765869],"type":"scatter"},{"x":[59],"y":[0.11753582954406738],"type":"scatter"},{"mode":"lines","x":[60,61,62,63,64,65,66,67,68],"y":[0.13524258136749268,0.16612458229064941,0.22974491119384766,0.8630361557006836,0.26423048973083496,0.23432612419128418,0.20320141315460205,0.13997185230255127,0.10870659351348877],"type":"scatter"},{"x":[69],"y":[0.08037769794464111],"type":"scatter"},{"mode":"lines","x":[70,71,72,73,74,75,76,77,78],"y":[0.0986095666885376,0.08797454833984375,0.07644987106323242,0.11973810195922852,0.16020596027374268,0.2238178253173828,0.8641737699508667,0.2702372074127197,0.24371659755706787],"type":"scatter"},{"x":[79],"y":[0.1984647512435913],"type":"scatter"},{"mode":"lines","x":[80,81,82,83,84,85,86,87,88],"y":[0.15091538429260254,0.1190258264541626,0.09403562545776367,0.09856545925140381,0.10101056098937988,0.09795093536376953,0.14277148246765137,0.17912650108337402,0.22486233711242676],"type":"scatter"},{"x":[89],"y":[0.8736141920089722],"type":"scatter"},{"mode":"lines","x":[90,91,92,93,94,95,96,97,98],"y":[0.24640703201293945,0.23521602153778076,0.22235167026519775,0.1394127607345581,0.10354924201965332,0.08145773410797119,0.09068512916564941,0.08754110336303711,0.09078419208526611],"type":"scatter"},{"x":[99],"y":[0.13517546653747559],"type":"scatter"},{"mode":"lines","x":[100,101,102,103,104,105,106,107,108],"y":[0.1769932508468628,0.23192286491394043,0.8676444292068481,0.25176429748535156,0.19988739490509033,0.1997666358947754,0.13008511066436768,0.11744940280914307,0.09316182136535645],"type":"scatter"},{"x":[109],"y":[0.09412121772766113],"type":"scatter"},{"mode":"lines","x":[110,111,112,113,114,115,116,117,118],"y":[0.09363985061645508,0.08258473873138428,0.13448667526245117,0.15317308902740479,0.22435224056243896,0.8605738878250122,0.26709890365600586,0.21373248100280762,0.19121289253234863],"type":"scatter"},{"x":[119],"y":[0.13078463077545166],"type":"scatter"},{"mode":"lines","x":[120,121,122,123,124,125,126,127,128],"y":[0.054064393043518066,0.04823434352874756,0.056112051010131836,0.057677507400512695,0.054252028465270996,0.09330499172210693,0.14329314231872559,0.17520880699157715,0.8402361869812012],"type":"scatter"},{"x":[129],"y":[0.2455369234085083],"type":"scatter"},{"mode":"lines","x":[130,131,132,133,134,135,136,137,138],"y":[0.19341206550598145,0.17788124084472656,0.13366854190826416,0.0774153470993042,0.03602325916290283,0.03502190113067627,0.044736385345458984,0.028131842613220215,0.044988393783569336],"type":"scatter"},{"x":[139],"y":[0.09007823467254639],"type":"scatter"},{"mode":"lines","x":[140,141,142,143,144,145,146,147,148],"y":[0.16043519973754883,0.8219493627548218,0.261627197265625,0.21033108234405518,0.19288551807403564,0.15272891521453857,0.10339927673339844,0.0644296407699585,0.05898082256317139],"type":"scatter"},{"x":[149],"y":[0.05901312828063965],"type":"scatter"},{"mode":"lines","x":[150,151,152,153,154,155,156,157,158],"y":[0.04120945930480957,0.06534194946289062,0.1124035120010376,0.17520582675933838,0.8406360149383545,0.23108041286468506,0.23801982402801514,0.1743708848953247,0.1238318681716919],"type":"scatter"},{"x":[159],"y":[0.05694448947906494],"type":"scatter"},{"mode":"lines","x":[160,161,162,163,164,165,166,167,168],"y":[0.0390019416809082,0.04965317249298096,0.049567341804504395,0.029526352882385254,0.05658674240112305,0.09633779525756836,0.2026979923248291,0.8298665285110474,0.23735284805297852],"type":"scatter"},{"x":[169],"y":[0.19942903518676758],"type":"scatter"},{"mode":"lines","x":[170,171,172,173,174,175,176,177,178],"y":[0.17490220069885254,0.1034308671951294,0.061556100845336914,0.02783358097076416,0.026544570922851562,0.016166210174560547,0.0,0.02219092845916748,0.08047175407409668],"type":"scatter"},{"x":[179],"y":[0.16544973850250244],"type":"scatter"},{"mode":"lines","x":[180,181,182,183,184,185,186,187,188],"y":[0.8112574815750122,0.23417901992797852,0.20533788204193115,0.1786363124847412,0.12237787246704102,0.06661081314086914,0.045046448707580566,0.04345357418060303,0.05171835422515869],"type":"scatter"},{"x":[189],"y":[0.030414819717407227],"type":"scatter"},{"mode":"lines","x":[190,191,192,193,194,195,196,197,198],"y":[0.07503259181976318,0.11783218383789062,0.18687140941619873,0.8287758827209473,0.2419959306716919,0.22175896167755127,0.1964435577392578,0.12684857845306396,0.09317409992218018],"type":"scatter"},{"x":[199],"y":[0.06226348876953125],"type":"scatter"},{"mode":"lines","x":[200,201,202,203,204,205,206,207,208],"y":[0.06383633613586426,0.07466185092926025,0.04399847984313965,0.0766448974609375,0.12416946887969971,0.18901968002319336,0.8412625789642334,0.22323858737945557,0.2218707799911499],"type":"scatter"},{"x":[209],"y":[0.213303804397583],"type":"scatter"},{"mode":"lines","x":[210,211,212,213,214,215,216,217,218],"y":[0.1550809144973755,0.11041676998138428,0.07795071601867676,0.08393967151641846,0.08251261711120605,0.07343733310699463,0.10770595073699951,0.15124571323394775,0.2415252923965454],"type":"scatter"},{"x":[219],"y":[0.8591548204421997],"type":"scatter"},{"mode":"lines","x":[220,221,222,223,224,225,226,227,228],"y":[0.2391970157623291,0.19649481773376465,0.19080400466918945,0.1577136516571045,0.1180046796798706,0.09730279445648193,0.09543061256408691,0.101828932762146,0.09340715408325195],"type":"scatter"},{"x":[229],"y":[0.11889147758483887],"type":"scatter"},{"mode":"lines","x":[230,231,232,233,234,235,236,237,238],"y":[0.14740192890167236,0.21326887607574463,0.8589605093002319,0.2606867551803589,0.20815813541412354,0.19829225540161133,0.14932870864868164,0.1104590892791748,0.08080935478210449],"type":"scatter"},{"x":[239],"y":[0.10226094722747803],"type":"scatter"},{"mode":"lines","x":[240,241,242,243,244,245,246,247,248],"y":[0.10005021095275879,0.0880119800567627,0.12714993953704834,0.1746135950088501,0.2223438024520874,0.8648611307144165,0.25410139560699463,0.22691690921783447,0.2130221128463745],"type":"scatter"},{"x":[249],"y":[0.17668545246124268],"type":"scatter"},{"mode":"lines","x":[250,251,252,253,254,255,256,257,258],"y":[0.12886130809783936,0.09898638725280762,0.11249518394470215,0.10069608688354492,0.09584414958953857,0.11774587631225586,0.1726781129837036,0.23876845836639404,0.8743447065353394],"type":"scatter"},{"x":[259],"y":[0.25783538818359375],"type":"scatter"},{"mode":"lines","x":[260,261,262,263,264,265,266,267,268],"y":[0.2430797815322876,0.24015021324157715,0.17108416557312012,0.09836471080780029,0.10118162631988525,0.11788463592529297,0.12260663509368896,0.09872591495513916,0.13953101634979248],"type":"scatter"},{"x":[269],"y":[0.18630290031433105],"type":"scatter"},{"mode":"lines","x":[270,271,272,273,274,275,276,277,278],"y":[0.2377638816833496,0.8814641237258911,0.28643548488616943,0.25993454456329346,0.22606706619262695,0.16427361965179443,0.12025177478790283,0.12277257442474365,0.12447738647460938],"type":"scatter"},{"x":[279],"y":[0.13059473037719727],"type":"scatter"},{"mode":"lines","x":[280,281,282,283,284,285,286,287,288],"y":[0.11456620693206787,0.13542592525482178,0.1768958568572998,0.23228180408477783,0.887884259223938,0.2714637517929077,0.24689102172851562,0.23521125316619873,0.18842339515686035],"type":"scatter"},{"x":[289],"y":[0.15389084815979004],"type":"scatter"},{"mode":"lines","x":[290,291,292,293,294,295,296,297,298],"y":[0.12421345710754395,0.14941251277923584,0.16179120540618896,0.12484347820281982,0.1377394199371338,0.2028205394744873,0.2605710029602051,0.8999956846237183,0.29089152812957764],"type":"scatter"},{"x":[299],"y":[0.26235926151275635],"type":"scatter"},{"mode":"lines","x":[300,301,302,303,304,305,306,307,308],"y":[0.24700069427490234,0.19400954246520996,0.15898525714874268,0.13862264156341553,0.13941621780395508,0.14521706104278564,0.12717890739440918,0.147810697555542,0.20458412170410156],"type":"scatter"},{"x":[309],"y":[0.25319647789001465],"type":"scatter"},{"mode":"lines","x":[310,311,312,313,314,315,316,317,318],"y":[0.9050635099411011,0.28400325775146484,0.25230252742767334,0.23680782318115234,0.19142425060272217,0.1593937873840332,0.13929462432861328,0.16338670253753662,0.1572340726852417],"type":"scatter"},{"x":[319],"y":[0.13963520526885986],"type":"scatter"},{"mode":"lines","x":[320,321,322,323,324,325,326,327,328],"y":[0.1503673791885376,0.20488524436950684,0.2631570100784302,0.9067169427871704,0.2738621234893799,0.2360440492630005,0.2404623031616211,0.1790781021118164,0.15055131912231445],"type":"scatter"},{"x":[329],"y":[0.14996576309204102],"type":"scatter"},{"mode":"lines","x":[330,331,332,333,334,335,336,337,338],"y":[0.17309224605560303,0.17519652843475342,0.15076172351837158,0.14282643795013428,0.17947697639465332,0.2404402494430542,0.9014021158218384,0.28582727909088135,0.23562288284301758],"type":"scatter"},{"x":[339],"y":[0.2443230152130127],"type":"scatter"},{"mode":"lines","x":[340,341,342,343,344,345,346,347,348],"y":[0.19409561157226562,0.14837372303009033,0.13864362239837646,0.16639339923858643,0.1724987030029297,0.13778138160705566,0.1558070182800293,0.1737152338027954,0.24589574337005615],"type":"scatter"},{"x":[349],"y":[0.9027410745620728],"type":"scatter"},{"mode":"lines","x":[350,351,352,353,354,355,356,357,358],"y":[0.28317177295684814,0.26059842109680176,0.22737669944763184,0.18929994106292725,0.1744692325592041,0.1537487506866455,0.1633772850036621,0.1866093873977661,0.14400207996368408],"type":"scatter"},{"x":[359],"y":[0.15224754810333252],"type":"scatter"},{"mode":"lines","x":[360,361,362,363,364,365,366,367,368],"y":[0.20455646514892578,0.29167211055755615,0.9141846895217896,0.30009591579437256,0.2578192949295044,0.2496509552001953,0.1870948076248169,0.13778138160705566,0.12298250198364258],"type":"scatter"},{"x":[369],"y":[0.1516655683517456],"type":"scatter"},{"mode":"lines","x":[370,371,372,373,374,375,376,377,378],"y":[0.1643214225769043,0.13225698471069336,0.16053533554077148,0.16941869258880615,0.2330406904220581,0.9015079736709595,0.27843451499938965,0.2487955093383789,0.25059545040130615],"type":"scatter"},{"x":[379],"y":[0.1979585886001587],"type":"scatter"},{"mode":"lines","x":[380,381,382,383,384,385,386,387,388],"y":[0.15347754955291748,0.14985525608062744,0.17671287059783936,0.17292547225952148,0.1408240795135498,0.15926098823547363,0.20284545421600342,0.26554346084594727,0.9108484983444214],"type":"scatter"},{"x":[389],"y":[0.30295491218566895],"type":"scatter"},{"mode":"lines","x":[390,391,392,393,394,395,396,397,398],"y":[0.2809504270553589,0.2439645528793335,0.17744362354278564,0.13662540912628174,0.10774481296539307,0.15232062339782715,0.16131210327148438,0.11968600749969482,0.14363932609558105],"type":"scatter"},{"x":[399],"y":[0.17865753173828125],"type":"scatter"},{"mode":"lines","x":[400,401,402,403,404,405,406,407,408],"y":[0.2521551847457886,0.9023712873458862,0.29978346824645996,0.28166186809539795,0.23037183284759521,0.1771303415298462,0.1471855640411377,0.13116061687469482,0.15005958080291748],"type":"scatter"},{"x":[409],"y":[0.1482086181640625],"type":"scatter"},{"mode":"lines","x":[410,411,412,413,414,415,416,417,418],"y":[0.13005638122558594,0.14401912689208984,0.1830536127090454,0.25987088680267334,0.9036895036697388,0.2879985570907593,0.2498561143875122,0.24486827850341797,0.1742478609085083],"type":"scatter"},{"x":[419],"y":[0.1385563611984253],"type":"scatter"},{"mode":"lines","x":[420,421,422,423,424,425,426,427,428],"y":[0.1408170461654663,0.1682431697845459,0.16962182521820068,0.11917150020599365,0.11988711357116699,0.16385924816131592,0.26036667823791504,0.8992801904678345,0.24068880081176758],"type":"scatter"},{"x":[429],"y":[0.2379385232925415],"type":"scatter"},{"mode":"lines","x":[430,431,432,433,434,435,436,437,438],"y":[0.23539984226226807,0.16817092895507812,0.14067184925079346,0.1450263261795044,0.18130385875701904,0.18004107475280762,0.12799417972564697,0.1616593599319458,0.18206787109375],"type":"scatter"},{"x":[439],"y":[0.23491311073303223],"type":"scatter"},{"mode":"lines","x":[440,441,442,443,444,445,446,447,448],"y":[0.8961900472640991,0.2786327600479126,0.28912651538848877,0.23544931411743164,0.18913066387176514,0.14676928520202637,0.1457444429397583,0.16460788249969482,0.20269536972045898],"type":"scatter"},{"x":[449],"y":[0.15208470821380615],"type":"scatter"},{"mode":"lines","x":[450,451,452,453,454,455,456,457,458],"y":[0.15859556198120117,0.19274723529815674,0.26992321014404297,0.9139808416366577,0.30715179443359375,0.28197169303894043,0.25490403175354004,0.19125044345855713,0.14951324462890625],"type":"scatter"},{"x":[459],"y":[0.15468251705169678],"type":"scatter"},{"mode":"lines","x":[460,461,462,463,464,465,466,467,468],"y":[0.1728975772857666,0.1684190034866333,0.1277083158493042,0.15990853309631348,0.19823575019836426,0.2700439691543579,0.916113018989563,0.30649757385253906,0.26152992248535156],"type":"scatter"},{"x":[469],"y":[0.24087142944335938],"type":"scatter"},{"mode":"lines","x":[470,471,472,473,474,475,476,477,478],"y":[0.17775368690490723,0.1359119415283203,0.1404709815979004,0.16399002075195312,0.17715775966644287,0.14901971817016602,0.164941668510437,0.18314599990844727,0.2802478075027466],"type":"scatter"},{"x":[479],"y":[0.9112786054611206],"type":"scatter"},{"mode":"lines","x":[480,481,482,483,484,485,486,487,488],"y":[0.3139129877090454,0.2783534526824951,0.23615539073944092,0.16836881637573242,0.15528476238250732,0.16112208366394043,0.1903247833251953,0.1985776424407959,0.15895605087280273],"type":"scatter"},{"x":[489],"y":[0.1636359691619873],"type":"scatter"},{"mode":"lines","x":[490,491,492,493,494,495,496,497,498],"y":[0.21249020099639893,0.30392181873321533,0.9245861768722534,0.321567177772522,0.274796724319458,0.2473599910736084,0.1898273229598999,0.16379225254058838,0.16224384307861328],"type":"scatter"},{"x":[499],"y":[0.2001347541809082],"type":"scatter"},{"mode":"lines","x":[500,501,502,503,504,505,506,507,508],"y":[0.20027220249176025,0.16186511516571045,0.17673110961914062,0.22060108184814453,0.28484904766082764,0.9289323091506958,0.3085308074951172,0.2807518243789673,0.23428118228912354],"type":"scatter"},{"x":[509],"y":[0.2097480297088623],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"t: time (months)"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y(t): Response variable"}},"legend":{"tracegroupgap":0},"title":{"text":"CO2 Emissions per month from Natural Gas since 1973"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('24dede51-83c8-45f0-892a-fc7d4debae7f');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="model-1-rnn-2" class="level3">
<h3 class="anchored" data-anchor-id="model-1-rnn-2">Model 1 = RNN</h3>
<section id="model-architecture-6" class="level4">
<h4 class="anchored" data-anchor-id="model-architecture-6">Model architecture</h4>
<div class="cell" data-execution_count="42">
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_6"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 simple_rnn_2 (SimpleRNN)    (None, 3)                 15        
                                                                 
 dense_6 (Dense)             (None, 1)                 4         
                                                                 
=================================================================
Total params: 19
Trainable params: 19
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="plot-training-and-validation-loss-mse-2" class="level4">
<h4 class="anchored" data-anchor-id="plot-training-and-validation-loss-mse-2">Plot training and validation loss (MSE)</h4>
<div class="cell" data-execution_count="44">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 19ms/step
(51, 9, 1) (51,) (51,) (12, 9, 1) (12,) (12,)
(51,) (51,)
0.03890586
0.0030931986
Train MSE = 0.03891 RMSE = 0.19725
Test MSE = 0.00309 RMSE = 0.05562</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="e4cb7faa-c4c6-4efd-ab6d-d000a892e5e1" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("e4cb7faa-c4c6-4efd-ab6d-d000a892e5e1")) {                    Plotly.newPlot(                        "e4cb7faa-c4c6-4efd-ab6d-d000a892e5e1",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"xaxis":"x","y":[0.732643723487854,0.591341495513916,0.51118403673172,0.45478948950767517,0.41065388917922974,0.3739898204803467,0.3438943326473236,0.3182589113712311,0.2960478365421295,0.2771463692188263,0.26103612780570984,0.24700450897216797,0.23437035083770752,0.22358906269073486,0.21337918937206268,0.20513816177845,0.19731326401233673,0.1911344826221466,0.18549881875514984,0.17995747923851013,0.17549803853034973,0.1712144911289215,0.16759911179542542,0.163723886013031,0.1598055213689804,0.15711957216262817,0.1531459391117096,0.1502695530653,0.14725103974342346,0.14387191832065582,0.14118918776512146,0.13809755444526672,0.13488562405109406,0.13190527260303497,0.12875939905643463,0.12625530362129211,0.12364206463098526,0.12074264138936996,0.11801445484161377,0.11559420824050903,0.11330779641866684,0.11078958213329315,0.10880862176418304,0.10663735866546631,0.10484657436609268,0.10320983827114105,0.10184349864721298,0.10029260814189911,0.09890808165073395,0.0974719375371933,0.09607930481433868,0.094673752784729,0.09359417855739594,0.09219803661108017,0.0910855382680893,0.0901455357670784,0.08913342654705048,0.0880533903837204,0.08718148618936539,0.0860031396150589,0.08485201001167297,0.08390672504901886,0.08299493789672852,0.08179449290037155,0.08090180158615112,0.0799790769815445,0.07901860773563385,0.07803989946842194,0.07732944190502167,0.07628218084573746,0.07544893026351929,0.07466664165258408,0.07372158765792847,0.07302743196487427,0.0722324475646019,0.0717543214559555,0.07074959576129913,0.07025457918643951,0.06938104331493378,0.06887804716825485,0.06807083636522293,0.06754978001117706,0.06680218130350113,0.06622695177793503,0.06556783616542816,0.06524091213941574,0.06458152830600739,0.0639234185218811,0.06346941739320755,0.0627814456820488,0.06233007460832596,0.06186755374073982,0.061516173183918,0.06103835254907608,0.060450661927461624,0.05987781286239624,0.05955293029546738,0.05904630944132805,0.05866408348083496,0.05850694701075554,0.0578194260597229,0.057722561061382294,0.05706695839762688,0.056817151606082916,0.05634789913892746,0.05616149306297302,0.05563253164291382,0.055470943450927734,0.05507546663284302,0.05515006184577942,0.054631274193525314,0.054589103907346725,0.05416819453239441,0.054151155054569244,0.05379254370927811,0.05357445031404495,0.05358049273490906,0.05312414839863777,0.052975405007600784,0.0527527816593647,0.052468765527009964,0.05223368853330612,0.052073217928409576,0.0523332878947258,0.05175849050283432,0.05145017057657242,0.051430732011795044,0.05114179104566574,0.051061488687992096,0.050737809389829636,0.05046974867582321,0.050541676580905914,0.050153087824583054,0.05015333741903305,0.04984284192323685,0.049575451761484146,0.04941735416650772,0.04923701286315918,0.04907084256410599,0.04906032979488373,0.04874352365732193,0.04853342846035957,0.04839262366294861,0.048247579485177994,0.048273827880620956,0.04800919070839882,0.04789154231548309,0.04753928259015083,0.04754935950040817,0.04734616354107857,0.04707619547843933,0.047095756977796555,0.04678034782409668,0.046730853617191315,0.04649921879172325,0.04636269062757492,0.04641152173280716,0.04608030244708061,0.04602692276239395,0.045784417539834976,0.045811932533979416,0.04545605555176735,0.0455273799598217,0.04519104212522507,0.04517137259244919,0.04512166231870651,0.04501887783408165,0.04488912224769592,0.044662557542324066,0.04441668838262558,0.044768281280994415,0.04430479556322098,0.044226378202438354,0.04415624588727951,0.04388461634516716,0.04388013854622841,0.04369862750172615,0.04352245107293129,0.04357888922095299,0.04331039637327194,0.04331964626908302,0.04307296872138977,0.043027155101299286,0.04290013760328293,0.043047066777944565,0.042790137231349945,0.042665995657444,0.042477384209632874,0.042460180819034576,0.042458392679691315,0.04231780394911766,0.04238756746053696,0.0419715978205204,0.04211249202489853,0.04185350984334946,0.04169915243983269,0.041639674454927444,0.04154973477125168,0.04149310663342476,0.041428953409194946],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"y":[0.6337888240814209,0.516840934753418,0.4367450475692749,0.37668007612228394,0.32628217339515686,0.2823616862297058,0.24634885787963867,0.21564069390296936,0.18866945803165436,0.16583362221717834,0.14733028411865234,0.13133324682712555,0.11796741187572479,0.10818051546812057,0.1000102236866951,0.09267295151948929,0.08621121197938919,0.0811995193362236,0.07793890684843063,0.07552515715360641,0.07388793677091599,0.07266618311405182,0.07156457751989365,0.07070866972208023,0.07026029378175735,0.0699470117688179,0.06984405964612961,0.06993403285741806,0.07026705145835876,0.0707017183303833,0.0706201121211052,0.0702681913971901,0.06993938982486725,0.06955429911613464,0.06928038597106934,0.06894765049219131,0.06870873272418976,0.0685095265507698,0.0683978945016861,0.0682753250002861,0.06813127547502518,0.06802699714899063,0.06796874105930328,0.06794191151857376,0.06797422468662262,0.0679653063416481,0.06790298223495483,0.06780657917261124,0.06770898401737213,0.0676322802901268,0.06750710308551788,0.06748411059379578,0.06748512387275696,0.0673985481262207,0.06736897677183151,0.0670931339263916,0.06693745404481888,0.06678517907857895,0.06665201485157013,0.06659817695617676,0.06644607335329056,0.0663200095295906,0.06624235957860947,0.06602822989225388,0.06590935587882996,0.0656605064868927,0.06555647403001785,0.06536909937858582,0.06525857001543045,0.06517931818962097,0.06500058621168137,0.06480623036623001,0.06467839330434799,0.06454607844352722,0.06441152095794678,0.06426221877336502,0.06411470472812653,0.06396828591823578,0.06377622485160828,0.06361217051744461,0.06340056657791138,0.06321785598993301,0.06302008032798767,0.06280823051929474,0.0626271665096283,0.06246998533606529,0.06233672797679901,0.0621684230864048,0.061909887939691544,0.06177343428134918,0.0616086944937706,0.06143533065915108,0.06126207113265991,0.061141982674598694,0.06094014272093773,0.06077386438846588,0.06061726436018944,0.060505494475364685,0.06028120592236519,0.06023319065570831,0.06010650098323822,0.059983011335134506,0.05981576442718506,0.05959799513220787,0.05936472490429878,0.05921686068177223,0.059014201164245605,0.05893528833985329,0.05873830243945122,0.05859985575079918,0.05838799476623535,0.058228615671396255,0.0580141544342041,0.05782737955451012,0.05771021917462349,0.05756106227636337,0.05742408335208893,0.05732104927301407,0.057110730558633804,0.05696958303451538,0.0566975362598896,0.05652836337685585,0.05640053376555443,0.05638763681054115,0.05617128685116768,0.05599522590637207,0.05582571029663086,0.055579397827386856,0.05539913475513458,0.05521464720368385,0.055019963532686234,0.05486492067575455,0.05466042831540108,0.05452274903655052,0.05438271909952164,0.05420730262994766,0.05404497683048248,0.053818561136722565,0.053714826703071594,0.05354791507124901,0.05344265699386597,0.05326845869421959,0.05303439870476723,0.05293872579932213,0.05281670019030571,0.05270760878920555,0.0525968037545681,0.05245086923241615,0.05222661420702934,0.05208824574947357,0.05196795240044594,0.05185992643237114,0.051658764481544495,0.05149657651782036,0.05137711390852928,0.05119004473090172,0.05112428590655327,0.05096397176384926,0.0508837066590786,0.050713539123535156,0.05063103511929512,0.0504620186984539,0.050421155989170074,0.050237417221069336,0.050084684044122696,0.049994371831417084,0.04987682029604912,0.04974442720413208,0.0496525801718235,0.04957810416817665,0.04960671439766884,0.049513887614011765,0.04940485954284668,0.049326494336128235,0.049168456345796585,0.049058686941862106,0.04892854392528534,0.048779893666505814,0.048699066042900085,0.048560772091150284,0.04847005382180214,0.0484052412211895,0.048309076577425,0.048140302300453186,0.04806947708129883,0.04805697128176689,0.04794090986251831,0.04787181317806244,0.04779009521007538,0.04770563542842865,0.047601066529750824,0.04757060110569,0.04749172553420067,0.04741504043340683,0.04729815945029259,0.047166857868433,0.04710637032985687,0.046993207186460495,0.046961620450019836,0.04678663983941078],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"training epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training and Validation Loss - RNN"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('e4cb7faa-c4c6-4efd-ab6d-d000a892e5e1');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="forecasting---next-5-years-60-months-6" class="level4">
<h4 class="anchored" data-anchor-id="forecasting---next-5-years-60-months-6">Forecasting - next 5 years (60 months)</h4>
<div class="cell" data-execution_count="45">
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 18ms/step</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="deeplearning_files/figure-html/cell-46-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="model-2---gru-2" class="level3">
<h3 class="anchored" data-anchor-id="model-2---gru-2">Model 2 - GRU</h3>
<section id="model-architecture-7" class="level4">
<h4 class="anchored" data-anchor-id="model-architecture-7">Model Architecture</h4>
<div class="cell" data-execution_count="46">
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_7"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 gru_2 (GRU)                 (None, 3)                 54        
                                                                 
 dense_7 (Dense)             (None, 1)                 4         
                                                                 
=================================================================
Total params: 58
Trainable params: 58
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="plot-training-and-validation-loss-4" class="level4">
<h4 class="anchored" data-anchor-id="plot-training-and-validation-loss-4">Plot training and validation loss</h4>
<div class="cell" data-execution_count="48">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 21ms/step
(51, 9, 1) (51,) (51,) (5, 9, 1) (5,) (5,)
(51,) (51,)
0.037088636
0.0038574208
Train MSE = 0.03709 RMSE = 0.19258
Test MSE = 0.00386 RMSE = 0.06211</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="a9294d60-ab22-447d-9ef7-7532b7506834" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("a9294d60-ab22-447d-9ef7-7532b7506834")) {                    Plotly.newPlot(                        "a9294d60-ab22-447d-9ef7-7532b7506834",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"xaxis":"x","y":[0.10084128379821777,0.09060928225517273,0.0842910036444664,0.07943960279226303,0.07574553787708282,0.07258635014295578,0.07014279067516327,0.06791909784078598,0.06604707986116409,0.06457450240850449,0.06342924386262894,0.06278152763843536,0.0620233416557312,0.061292875558137894,0.06070490926504135,0.06041017919778824,0.06013479083776474,0.05934252589941025,0.059067390859127045,0.0585053451359272,0.05836860090494156,0.05781593173742294,0.057655513286590576,0.05726035684347153,0.056791484355926514,0.056240446865558624,0.05620519444346428,0.05561765283346176,0.05519526079297066,0.05522031709551811,0.054734788835048676,0.05435904115438461,0.05389968305826187,0.053537268191576004,0.05346046760678291,0.05314560607075691,0.05276687070727348,0.052497196942567825,0.05234288424253464,0.05193302780389786,0.05169199779629707,0.051293134689331055,0.0514802560210228,0.05080841854214668,0.05036603659391403,0.05022551864385605,0.050157904624938965,0.0496213324368,0.04934938997030258,0.04909738898277283,0.04894595220685005,0.04874324053525925,0.048639170825481415,0.048189304769039154,0.047911666333675385,0.04795004799962044,0.047503333538770676,0.047537606209516525,0.047034066170454025,0.04685230925679207,0.04698421061038971,0.046410541981458664,0.04651512950658798,0.04605110362172127,0.04623813182115555,0.04561848193407059,0.045601774007081985,0.045458897948265076,0.045315198600292206,0.04512730985879898,0.04476940259337425,0.044865190982818604,0.04458992928266525,0.04448416084051132,0.04402847960591316,0.04397483170032501,0.043728601187467575,0.0436064638197422,0.0434957817196846,0.04331137612462044,0.04320666193962097,0.0430065356194973,0.04324638843536377,0.043048568069934845,0.04281890392303467,0.04258272796869278,0.04248015955090523,0.042338863015174866,0.04201901704072952,0.041892796754837036,0.04185131937265396,0.04198222979903221,0.04169018566608429,0.041638828814029694,0.04149423539638519,0.04125019162893295,0.04133016616106033,0.041241712868213654,0.040980640798807144,0.0409594401717186,0.04063209891319275,0.04054981470108032,0.040462594479322433,0.04035625979304314,0.04060443490743637,0.040270548313856125,0.04004888981580734,0.04026514291763306,0.040003057569265366,0.0399620458483696,0.03987070545554161,0.03957647830247879,0.03954857587814331,0.039651744067668915,0.039546944200992584,0.03918911889195442,0.03956056013703346,0.0390496626496315,0.03940756618976593,0.039204228669404984,0.0388428159058094,0.03878328949213028,0.03869471698999405,0.0388169065117836,0.0387629009783268,0.038684796541929245,0.03839241713285446,0.03865622729063034,0.038551293313503265,0.038212649524211884,0.038498230278491974,0.03846674785017967,0.03799194097518921,0.03796311467885971,0.03817450627684593,0.03778168186545372,0.03776582330465317,0.037761390209198,0.03801102936267853,0.03768211603164673,0.037699393928050995,0.037698764353990555,0.03767278045415878,0.03740856796503067,0.03776192665100098,0.03738812729716301,0.037320517003536224,0.037454281002283096,0.037327513098716736,0.03746151179075241,0.03746997192502022,0.037037935107946396,0.03731883317232132,0.0370149202644825,0.03728693723678589,0.03706548362970352,0.03721794858574867,0.03692542761564255,0.03688841313123703,0.03691992908716202,0.03700646013021469,0.036744024604558945,0.037091195583343506,0.03743064031004906,0.036653850227594376,0.036825112998485565,0.036842621862888336,0.036573611199855804,0.03691881150007248,0.03677423670887947,0.03668943792581558,0.036736536771059036,0.036667875945568085,0.03670737147331238,0.03655405715107918,0.036761052906513214,0.036509476602077484,0.03634783625602722,0.036328621208667755,0.03670267015695572,0.03653353452682495,0.03623735159635544,0.036506712436676025,0.036181528121232986,0.03655119240283966,0.03617324307560921,0.036506399512290955,0.03613557666540146,0.036280374974012375,0.03626442700624466,0.03628233075141907,0.03620458394289017,0.03625037893652916,0.03636157140135765,0.03602849319577217,0.03601562976837158,0.03596533462405205,0.03624705597758293,0.03624831512570381,0.03590318560600281],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"y":[0.11186011135578156,0.10339329391717911,0.09681957215070724,0.09129519760608673,0.0872218906879425,0.08352034538984299,0.08048418164253235,0.07769855856895447,0.07518546283245087,0.07323124259710312,0.0715608075261116,0.07046270370483398,0.06950484216213226,0.06859220564365387,0.06782267242670059,0.06719759106636047,0.06674131751060486,0.0662161111831665,0.06563329696655273,0.06520042568445206,0.06472557038068771,0.06426414847373962,0.06395258754491806,0.06361081451177597,0.0632515698671341,0.06286673247814178,0.06253394484519958,0.06217464432120323,0.06188367307186127,0.061592940241098404,0.06117458641529083,0.060869455337524414,0.06053571775555611,0.060137201100587845,0.059885814785957336,0.059590913355350494,0.05940129980444908,0.059130486100912094,0.058874525129795074,0.058529745787382126,0.058271657675504684,0.05809281766414642,0.05792093276977539,0.05758155882358551,0.05726742744445801,0.05704669654369354,0.05665463209152222,0.056355107575654984,0.056105270981788635,0.05589233711361885,0.05571850389242172,0.055301859974861145,0.055202022194862366,0.0549708716571331,0.054792437702417374,0.054567500948905945,0.054344963282346725,0.054135505110025406,0.05398820713162422,0.05357483774423599,0.05349217727780342,0.053254637867212296,0.05301700532436371,0.052817750722169876,0.05265311896800995,0.05241510644555092,0.05219820886850357,0.052010975778102875,0.05182420834898949,0.05156927928328514,0.051412150263786316,0.05129319056868553,0.05108851194381714,0.05088978633284569,0.050726428627967834,0.05050225555896759,0.05037897452712059,0.05017971619963646,0.05018729344010353,0.05013376846909523,0.050031062215566635,0.04972447082400322,0.04962916672229767,0.04955841228365898,0.049391672015190125,0.049309562891721725,0.049135472625494,0.049041423946619034,0.04881242290139198,0.048652663826942444,0.048461321741342545,0.04844364896416664,0.04834325611591339,0.048270031809806824,0.04817257821559906,0.04813053831458092,0.04796845093369484,0.04775138944387436,0.047708526253700256,0.04764709249138832,0.047526657581329346,0.0473141074180603,0.04711252823472023,0.046958569437265396,0.04692419618368149,0.04690881073474884,0.046784576028585434,0.04666280373930931,0.04665535315871239,0.04654070362448692,0.046395037323236465,0.04626994952559471,0.04616725072264671,0.046164609491825104,0.0460406094789505,0.04592747613787651,0.04593738168478012,0.045727070420980453,0.04564687982201576,0.0455331914126873,0.04542020708322525,0.04531532898545265,0.04516232758760452,0.04514547064900398,0.04521934688091278,0.04518643766641617,0.04503868892788887,0.045017484575510025,0.04501095041632652,0.044937897473573685,0.04490382596850395,0.0447884164750576,0.04465204104781151,0.044510189443826675,0.04441569000482559,0.0444413498044014,0.0442776158452034,0.04411089047789574,0.04420287534594536,0.04429686442017555,0.04422584921121597,0.04424653202295303,0.04420383274555206,0.04419048875570297,0.044079627841711044,0.04409753903746605,0.044001173228025436,0.04389088973402977,0.043861642479896545,0.04378601908683777,0.043741460889577866,0.043790221214294434,0.04369736090302467,0.04365852102637291,0.043571893125772476,0.043682508170604706,0.04368465393781662,0.04351933300495148,0.043562017381191254,0.04339733347296715,0.04354652389883995,0.04328559339046478,0.04327971488237381,0.043428245931863785,0.043409522622823715,0.04336006939411163,0.043318286538124084,0.043298520147800446,0.04338756576180458,0.043270453810691833,0.043217241764068604,0.043072786182165146,0.04312610998749733,0.04318618029356003,0.043268561363220215,0.043341509997844696,0.04323824867606163,0.0430549792945385,0.04285356029868126,0.04288546368479729,0.0429009273648262,0.04294117912650108,0.04285535588860512,0.042797308415174484,0.04274292290210724,0.04260639473795891,0.04271045699715614,0.042562760412693024,0.04270070046186447,0.04262581840157509,0.042651526629924774,0.04265521839261055,0.04253534972667694,0.04254011809825897,0.04251721128821373,0.04250827059149742,0.042300328612327576,0.04252542555332184,0.04242829978466034,0.04248032346367836],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"training epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training and Validation Loss - GRU"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('a9294d60-ab22-447d-9ef7-7532b7506834');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="forecasting---next-5-years-60-months-7" class="level4">
<h4 class="anchored" data-anchor-id="forecasting---next-5-years-60-months-7">Forecasting - next 5 years (60 months)</h4>
<div class="cell" data-execution_count="49">
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 22ms/step</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="deeplearning_files/figure-html/cell-50-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="model-3---lstm-2" class="level3">
<h3 class="anchored" data-anchor-id="model-3---lstm-2">Model 3 - LSTM</h3>
<section id="model-architecture-8" class="level4">
<h4 class="anchored" data-anchor-id="model-architecture-8">Model Architecture</h4>
<div class="cell" data-execution_count="50">
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_8"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 lstm_2 (LSTM)               (None, 3)                 60        
                                                                 
 dense_8 (Dense)             (None, 1)                 4         
                                                                 
=================================================================
Total params: 64
Trainable params: 64
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="plot-training-and-validation-loss-5" class="level4">
<h4 class="anchored" data-anchor-id="plot-training-and-validation-loss-5">Plot training and validation loss</h4>
<div class="cell" data-execution_count="52">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 19ms/step
(51, 9, 1) (51,) (51,) (5, 9, 1) (5,) (5,)
(51,) (51,)
0.038007062
0.01997656
Train MSE = 0.03801 RMSE = 0.19495
Test MSE = 0.01998 RMSE = 0.14134</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="b647991f-2b08-4c97-a7f7-038474af1fca" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("b647991f-2b08-4c97-a7f7-038474af1fca")) {                    Plotly.newPlot(                        "b647991f-2b08-4c97-a7f7-038474af1fca",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"xaxis":"x","y":[0.13011056184768677,0.12055791914463043,0.11427141726016998,0.10898655652999878,0.10428271442651749,0.10007284581661224,0.09619621932506561,0.09261859208345413,0.08921154588460922,0.08604694157838821,0.08314187824726105,0.08040661364793777,0.07787282019853592,0.07548490911722183,0.07331812381744385,0.07123234122991562,0.06951098889112473,0.06775461137294769,0.0662274956703186,0.06482233852148056,0.06387557834386826,0.06263513118028641,0.06162147969007492,0.060717929154634476,0.05998913571238518,0.0593174584209919,0.05862489342689514,0.05808466672897339,0.0574176199734211,0.05701964348554611,0.056443143635988235,0.05594068765640259,0.055641960352659225,0.055101681500673294,0.05482025071978569,0.05435437709093094,0.05391567200422287,0.05344469100236893,0.053206004202365875,0.05269797518849373,0.052382152527570724,0.052356768399477005,0.05167340114712715,0.051402926445007324,0.05115153640508652,0.050709087401628494,0.05030034855008125,0.05010651797056198,0.04971606656908989,0.049574114382267,0.0492883063852787,0.048826951533555984,0.04869338870048523,0.0483122393488884,0.04814348369836807,0.04785076528787613,0.04766813665628433,0.04719742387533188,0.04705813527107239,0.046847254037857056,0.046664319932460785,0.04642818495631218,0.04607071354985237,0.045855604112148285,0.04563600569963455,0.04542291536927223,0.04541581869125366,0.04500473290681839,0.044957518577575684,0.04485977441072464,0.04453352838754654,0.04452129080891609,0.04429853707551956,0.04407476261258125,0.0437987856566906,0.0437481626868248,0.043523311614990234,0.043461211025714874,0.04320357367396355,0.04309745505452156,0.043135788291692734,0.04291084036231041,0.04262930154800415,0.04262848198413849,0.042514871805906296,0.04238315299153328,0.042444728314876556,0.042156100273132324,0.04202219843864441,0.04184698313474655,0.041894301772117615,0.04181184247136116,0.04172349348664284,0.04157729819417,0.041408948600292206,0.04144987836480141,0.04124174267053604,0.04129168391227722,0.04114779829978943,0.04117587208747864,0.04110594466328621,0.040813323110342026,0.0407770536839962,0.0409293994307518,0.04078724980354309,0.04074469953775406,0.04054490476846695,0.04057498276233673,0.040396131575107574,0.0404389351606369,0.040499888360500336,0.04029737785458565,0.04016539454460144,0.04030091315507889,0.04012385755777359,0.04015224426984787,0.039988551288843155,0.03994084522128105,0.039828989654779434,0.04009431600570679,0.039829183369874954,0.03989281505346298,0.0397869311273098,0.03971504047513008,0.03981059044599533,0.039601825177669525,0.03963826596736908,0.03967229649424553,0.039483875036239624,0.03947179391980171,0.03970886766910553,0.0394572839140892,0.03933611512184143,0.039322685450315475,0.03926263004541397,0.039325565099716187,0.039380088448524475,0.039197564125061035,0.039174798876047134,0.03914596512913704,0.0390528067946434,0.039115261286497116,0.03917490318417549,0.03916480392217636,0.038958508521318436,0.03899630159139633,0.038998793810606,0.0388985201716423,0.038955774158239365,0.039011623710393906,0.03875754401087761,0.03895512968301773,0.03885399550199509,0.0386626236140728,0.0387258380651474,0.03875791281461716,0.038599129766225815,0.038614749908447266,0.03860524669289589,0.038832664489746094,0.03850823640823364,0.038490451872348785,0.03870208561420441,0.03853901848196983,0.03851846605539322,0.03840761259198189,0.03848187252879143,0.038367532193660736,0.0382734052836895,0.03853074088692665,0.03829924017190933,0.038309045135974884,0.038219962269067764,0.03830753639340401,0.03812409192323685,0.0380801260471344,0.03823515772819519,0.038108501583337784,0.03822461515665054,0.03795420005917549,0.03794419765472412,0.03791499882936478,0.03794990852475166,0.037789829075336456,0.037808071821928024,0.03777915984392166,0.037796467542648315,0.03788262978196144,0.03786764666438103,0.03760140761733055,0.03774651139974594,0.03752311319112778,0.037497058510780334,0.03741341829299927,0.0376993790268898,0.03751715272665024,0.03731227293610573,0.03725144639611244,0.03735997527837753,0.03725987300276756],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"y":[0.15115690231323242,0.14238862693309784,0.13558189570903778,0.12941330671310425,0.12389522045850754,0.11883658915758133,0.11415629088878632,0.10972766578197479,0.1055174171924591,0.10163115710020065,0.09797346591949463,0.09455543011426926,0.09129989892244339,0.08831385523080826,0.08547070622444153,0.08278660476207733,0.08048141002655029,0.07826617360115051,0.07616369426250458,0.07425349205732346,0.07275200635194778,0.07130225002765656,0.07007062435150146,0.06882525235414505,0.06767705827951431,0.06661693751811981,0.06581920385360718,0.06507696956396103,0.06430268287658691,0.0636436864733696,0.06302372366189957,0.0623510368168354,0.06188804283738136,0.06134330853819847,0.0609443336725235,0.06057297810912132,0.06012307479977608,0.05970383808016777,0.059246908873319626,0.05885878577828407,0.05851791799068451,0.058210909366607666,0.057842228561639786,0.05748084560036659,0.05711830034852028,0.05685175582766533,0.05649925768375397,0.05610151216387749,0.055806733667850494,0.05553619936108589,0.05529381334781647,0.05500250682234764,0.05474346503615379,0.05441494286060333,0.05414161831140518,0.05388927459716797,0.05366365611553192,0.05342226102948189,0.053136542439460754,0.05289538949728012,0.05269059166312218,0.05242706462740898,0.05223747342824936,0.05201214179396629,0.051852330565452576,0.05169570446014404,0.051543835550546646,0.05132468044757843,0.05115716531872749,0.05101355165243149,0.050886597484350204,0.05070793256163597,0.05055560916662216,0.05034831911325455,0.05017787218093872,0.05001821741461754,0.049833379685878754,0.04969062656164169,0.049570437520742416,0.04943377897143364,0.0492967814207077,0.04918435588479042,0.04907546937465668,0.048896487802267075,0.04883328452706337,0.048752520233392715,0.048719123005867004,0.04857384040951729,0.048419322818517685,0.04828604310750961,0.048139337450265884,0.048086557537317276,0.04802786931395531,0.04796485975384712,0.04791064187884331,0.047820985317230225,0.04772304370999336,0.04762047529220581,0.047578681260347366,0.04752551019191742,0.04744221270084381,0.047351181507110596,0.047295402735471725,0.04725281894207001,0.047202516347169876,0.047152079641819,0.047029223293066025,0.04694535583257675,0.046904388815164566,0.04687894880771637,0.046901289373636246,0.04682514816522598,0.04677283391356468,0.04673129320144653,0.04665627330541611,0.04658893123269081,0.046495672315359116,0.04650584235787392,0.04645855352282524,0.04640014097094536,0.046395882964134216,0.04634430259466171,0.04620705917477608,0.04611465707421303,0.046132639050483704,0.04605722427368164,0.04596441611647606,0.04596466198563576,0.04600699245929718,0.04593602567911148,0.04600392282009125,0.04598880931735039,0.045891597867012024,0.045851513743400574,0.045784641057252884,0.04578027501702309,0.045797452330589294,0.04573380574584007,0.04564233124256134,0.045655667781829834,0.04557306692004204,0.04547834396362305,0.04557379335165024,0.04557811841368675,0.04557829722762108,0.04558611288666725,0.045529767870903015,0.04542417824268341,0.045418765395879745,0.045421600341796875,0.045354798436164856,0.04532475769519806,0.045274458825588226,0.045299023389816284,0.04529402032494545,0.045320361852645874,0.0453299917280674,0.04517507925629616,0.04512671008706093,0.04516604170203209,0.045147523283958435,0.04507323354482651,0.045090094208717346,0.04502388462424278,0.045025747269392014,0.044978562742471695,0.044944148510694504,0.04489080235362053,0.04490337893366814,0.044987451285123825,0.04494600370526314,0.04493920877575874,0.04493081197142601,0.04492862895131111,0.04496099799871445,0.04484866186976433,0.04475093260407448,0.044795289635658264,0.04477866739034653,0.04467706382274628,0.044687215238809586,0.04465870559215546,0.044625964015722275,0.04463229328393936,0.044536296278238297,0.044441405683755875,0.044596072286367416,0.044560447335243225,0.04455731809139252,0.04454043135046959,0.04461261257529259,0.044523946940898895,0.04449166730046272,0.0443534329533577,0.04423737898468971,0.0441354475915432,0.04402538761496544,0.04394913092255592,0.044058289378881454,0.04406043142080307],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"training epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training and Validation Loss - LSTM"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('b647991f-2b08-4c97-a7f7-038474af1fca');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="forecasting---next-5-years-60-months-8" class="level4">
<h4 class="anchored" data-anchor-id="forecasting---next-5-years-60-months-8">Forecasting - next 5 years (60 months)</h4>
<div class="cell" data-execution_count="53">
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 23ms/step</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="deeplearning_files/figure-html/cell-54-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="discussion-2" class="level3">
<h3 class="anchored" data-anchor-id="discussion-2">Discussion</h3>
<p>For predicting CO2 emissions from Natural Gas, the training RMSE are: <br> 1) RNN - 0.19666<br> 2) GRU - 0.19114<br> 3) LSTM - 0.18312<br> <br></p>
<p>And the test RMSE are:<br> 1) RNN - 0.05314<br> 2) GRU - 0.07994<br> 3) LSTM - 0.21063<br></p>
<p>Thus, the GRU model minimized RMSE for training predictions, while the RNN minimized RMSE for test predictions. Similarly to Hydro modeling, there is a pretty big difference between train and test RMSE for RNN and GRU models here. This <em>could</em> indicate data leakage and should be investigated via further analysis. The LSTM, on the other hand, appears to be overfitted as the test RMSE is higher than the train RMSE. Regularization again improved the model performance slightly, by 0.02 points in the RMSE.</p>
<p>Forecasting here worked better than expected. For all three models I forecasted the next 5 years (60) months, and the forecasted plots appear to mimic the seasonality and spikes of the previous 30 years. Across all three models, the first 4 years are well forecasted and display the expected spikes in emissions during the summer. However, by year 5 forecast weakens and the nuance and variation in the trend is smaller.</p>
<p>The ARIMA(1,1,1)(0,1,2) forecast shared the same seasonality, but exhibited an upwards trend across all 5 years. The ANN models exhibit no trend (only seasonality). The RNSE from the ARIMA model was 0.04678813, only slightly smaller than the ANN RMSE. The RNN had an RMSE of 0.05314, so with more model tuning could surely outperform the ARIMA model.</p>
</section>
</section>
<section id="petroleum" class="level2">
<h2 class="anchored" data-anchor-id="petroleum">Petroleum</h2>
<section id="split-data-into-training-and-testing-data-3" class="level3">
<h3 class="anchored" data-anchor-id="split-data-into-training-and-testing-data-3">Split data into training and testing data</h3>
<p>And visualize split!</p>
<div class="cell" data-execution_count="54">
<div class="cell-output cell-output-stdout">
<pre><code>Training data size:  (519,)
Test data size:  (130,)</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="a567fec3-183c-433f-90dc-0b233b4ad674" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("a567fec3-183c-433f-90dc-0b233b4ad674")) {                    Plotly.newPlot(                        "a567fec3-183c-433f-90dc-0b233b4ad674",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518],"xaxis":"x","y":[0.20130087435245514,0.15172530710697174,0.1740044206380844,0.16338278353214264,0.1903034895658493,0.2024533599615097,0.19882117211818695,0.2095658928155899,0.1730675846338272,0.21618817746639252,0.17673657834529877,0.18464945256710052,0.8202983736991882,0.18318791687488556,0.1547688990831375,0.19502879679203033,0.1569654792547226,0.14051033556461334,0.15994741022586823,0.15715287625789642,0.1625894159078598,0.18188802897930145,0.1417074054479599,0.16074906289577484,0.17961134016513824,0.7977923154830933,0.17789040505886078,0.15388493239879608,0.15172530710697174,0.1628948599100113,0.14506886899471283,0.15407459437847137,0.20213954150676727,0.1833006590604782,0.17406286299228668,0.20541523396968842,0.1740044206380844,0.1845373660326004,0.8058810830116272,0.19706551730632782,0.15677793323993683,0.1833006590604782,0.16713295876979828,0.17586778104305267,0.1602560430765152,0.1376277059316635,0.21904440224170685,0.17817802727222443,0.159638449549675,0.13065634667873383,0.16647161543369293,0.8031589388847351,0.1948673576116562,0.15147005021572113,0.1991390436887741,0.16056428849697113,0.18046750128269196,0.16099520027637482,0.26313459873199463,0.20082791149616241,0.21524550020694733,0.20354856550693512,0.20109079778194427,0.1764473170042038,0.8267553448677063,0.20024864375591278,0.15229876339435577,0.19008411467075348,0.10949908196926117,0.20224417746067047,0.17171479761600494,0.17189167439937592,0.20701174437999725,0.18245400488376617,0.19096054136753082,0.20716573297977448,0.1884879618883133,0.8152609467506409,0.1647198349237442,0.14322884380817413,0.1736534982919693,0.12611214816570282,0.1416410654783249,0.21138910949230194,0.16677244007587433,0.25141996145248413,0.15988565981388092,0.187381312251091,0.14676563441753387,0.17394594848155975,0.8055338263511658,0.17667876183986664,0.12709777057170868,0.14057700335979462,0.17748717963695526,0.17236267030239105,0.10068966448307037,0.1822277456521988,0.13471202552318573,0.180752232670784,0.15172530710697174,0.2100229114294052,0.18431295454502106,0.7959848046302795,0.21359993517398834,0.10912235081195831,0.20287112891674042,0.17696775496006012,0.1321762055158615,0.20339243113994598,0.14097653329372406,0.17487956583499908,0.21138910949230194,0.1579010933637619,0.20875133574008942,0.1820579320192337,0.8110336661338806,0.22432692348957062,0.1891496628522873,0.2226908951997757,0.178580179810524,0.18649251759052277,0.14428190886974335,0.20448361337184906,0.20469097793102264,0.144150510430336,0.12083809077739716,0.07736097276210785,0.15608911216259003,0.8072118163108826,0.07478533685207367,0.13231392204761505,0.09501494467258453,0.10239867866039276,0.13836820423603058,0.12849922478199005,0.23253889381885529,0.1937340348958969,0.17371200025081635,0.17667876183986664,0.19583474099636078,0.15646503865718842,0.7867285013198853,0.20474277436733246,0.15827436745166779,0.2072683423757553,0.16556702554225922,0.20783187448978424,0.11427284777164459,0.1569029539823532,0.19216062128543854,0.1637481302022934,0.21529521048069,0.14316289126873016,0.14487238228321075,0.8074353337287903,0.1466355174779892,0.14578811824321747,0.19150672852993011,0.15489493310451508,0.22418300807476044,0.17598383128643036,0.2185051590204239,0.24313636124134064,0.14624474942684174,0.21063102781772614,0.21519581973552704,0.19340930879116058,0.8237342238426208,0.21264760196208954,0.20757584273815155,0.22336585819721222,0.11271630227565765,0.2020348459482193,0.24890641868114471,0.13518895208835602,0.2009330540895462,0.23791547119617462,0.15318824350833893,0.16653181612491608,0.19956232607364655,0.8274838328361511,0.27633607387542725,0.17452986538410187,0.20161570608615875,0.2000904232263565,0.18346963822841644,0.21359993517398834,0.2413032501935959,0.25852155685424805,0.18188802897930145,0.2405392974615097,0.23341979086399078,0.236410453915596,0.8548150658607483,0.24715839326381683,0.22259433567523956,0.2562045454978943,0.22860755026340485,0.25505930185317993,0.15583817660808563,0.19674505293369293,0.2689971327781677,0.22547547519207,0.2129487246274948,0.24438069760799408,0.26665204763412476,0.8663154244422913,0.29232513904571533,0.19079641997814178,0.19743894040584564,0.19112451374530792,0.2663675546646118,0.21717672049999237,0.2322600930929184,0.2773118019104004,0.2183578759431839,0.2126978188753128,0.23355858027935028,0.19556637108325958,0.8620746731758118,0.2677463889122009,0.22860755026340485,0.2575131058692932,0.21209461987018585,0.22504539787769318,0.2341592162847519,0.25219500064849854,0.2700013518333435,0.2654305100440979,0.2567541003227234,0.27773988246917725,0.292802095413208,0.8871285319328308,0.21717672049999237,0.1784653514623642,0.24495632946491241,0.2774675488471985,0.22737832367420197,0.22375069558620453,0.2545912265777588,0.24495632946491241,0.259901762008667,0.2900009751319885,0.2521519660949707,0.26827168464660645,0.8792752623558044,0.29232513904571533,0.2388685792684555,0.2964053750038147,0.282631516456604,0.3069189190864563,0.32592374086380005,0.3105001449584961,0.30524885654449463,0.22002191841602325,0.305213987827301,0.26972055435180664,0.25852155685424805,0.9188817143440247,0.2570917010307312,0.25446343421936035,0.2946646809577942,0.2518077492713928,0.2777788043022156,0.3049694895744324,0.2855144143104553,0.29488295316696167,0.2806015610694885,0.24482358992099762,0.27808964252471924,0.26567530632019043,0.9076300263404846,0.29103654623031616,0.24833960831165314,0.241841122508049,0.2781673073768616,0.3069535493850708,0.30740392208099365,0.2696402668952942,0.26202017068862915,0.24842692911624908,0.28619247674942017,0.2528819441795349,0.24908055365085602,0.9039357304573059,0.27766215801239014,0.25981831550598145,0.26758456230163574,0.23517243564128876,0.29773902893066406,0.27664870023727417,0.29978007078170776,0.25365251302719116,0.27598387002944946,0.2602352499961853,0.280139684677124,0.2982059717178345,0.9069998860359192,0.2539088726043701,0.25305336713790894,0.3196021318435669,0.2751995325088501,0.252022922039032,0.2828983664512634,0.2923985719680786,0.27203768491744995,0.27496373653411865,0.3383294343948364,0.27156001329421997,0.31537705659866333,0.9176526665687561,0.24402575194835663,0.25429296493530273,0.2652263641357422,0.27136069536209106,0.27711695432662964,0.32141029834747314,0.2944098711013794,0.2629697918891907,0.25927531719207764,0.30612003803253174,0.29806244373321533,0.3264702558517456,0.9158216118812561,0.2661234140396118,0.2926921248435974,0.28536349534988403,0.3204585313796997,0.318146288394928,0.33731579780578613,0.32797521352767944,0.3709683418273926,0.3303268551826477,0.32320576906204224,0.29691082239151,0.36953508853912354,0.9544722437858582,0.32701563835144043,0.3373773694038391,0.3587895631790161,0.32379066944122314,0.3384826183319092,0.36073392629623413,0.33731579780578613,0.35112255811691284,0.33872759342193604,0.3446568250656128,0.3033568859100342,0.3282623887062073,0.9706849455833435,0.3304217457771301,0.2614818215370178,0.30447977781295776,0.2596096396446228,0.34396815299987793,0.3069189190864563,0.3017694354057312,0.3349038362503052,0.29502832889556885,0.2707219123840332,0.2595260739326477,0.28373539447784424,0.9304376244544983,0.2671389579772949,0.20915894210338593,0.33234333992004395,0.30240559577941895,0.3204585313796997,0.33857452869415283,0.3493380546569824,0.3092661499977112,0.32150858640670776,0.31382930278778076,0.33471739292144775,0.3577123284339905,0.9485271573066711,0.3524309992790222,0.3159467577934265,0.34086108207702637,0.3546257019042969,0.3313056230545044,0.337346613407135,0.3718298077583313,0.33462411165237427,0.340678870677948,0.31426769495010376,0.32931262254714966,0.30500441789627075,0.9690858721733093,0.29151594638824463,0.27781766653060913,0.3244389295578003,0.34183043241500854,0.305283784866333,0.3467710614204407,0.358619749546051,0.3201294541358948,0.3357413411140442,0.35428041219711304,0.34360814094543457,0.36634230613708496,0.9646288752555847,0.36327576637268066,0.2778565287590027,0.3470674157142639,0.3300420045852661,0.422146201133728,0.3709414005279541,0.3509475588798523,0.38632506132125854,0.3805217146873474,0.3585348129272461,0.3954026699066162,0.3950348496437073,1.0000001192092896,0.35568737983703613,0.3320293426513672,0.35986220836639404,0.3759881854057312,0.3983982801437378,0.3634147047996521,0.3921728730201721,0.3641359210014343,0.3452243208885193,0.320096492767334,0.36005932092666626,0.3716685175895691,0.9952238202095032,0.34375816583633423,0.27156001329421997,0.35739970207214355,0.30916309356689453,0.3417094945907593,0.36252427101135254,0.34444743394851685,0.364993155002594,0.3947893977165222,0.3546544909477234,0.368529736995697,0.4060072898864746,0.9865911602973938,0.31335633993148804,0.28377342224121094,0.37545889616012573,0.3045147657394409,0.371345579624176,0.3296300172805786,0.30377858877182007,0.3660125732421875,0.36079007387161255,0.3127809166908264,0.31904059648513794,0.38122206926345825,0.969957172870636,0.347215473651886,0.2895187735557556,0.33209216594696045,0.32854926586151123,0.32301050424575806,0.3126792311668396,0.3647722005844116,0.331463098526001,0.25085872411727905,0.3290584087371826,0.3049345016479492,0.347511351108551,0.9561248421669006,0.3071961998939514,0.28094738721847534,0.3044097423553467,0.33820676803588867,0.34807252883911133,0.35634511709213257,0.27179890871047974,0.29593509435653687,0.32366079092025757,0.2407192438840866,0.2522379755973816,0.2812544107437134,0.9352672696113586,0.20520852506160736,0.2347584217786789,0.3214758038520813,0.2876927852630615,0.2640800476074219,0.3049694895744324,0.296622097492218,0.32624536752700806,0.3175482749938965,0.2606514096260071,0.290297269821167,0.28679364919662476,0.9180871844291687,0.28156107664108276,0.20292331278324127,0.2719581127166748,0.2681505084037781,0.3152428865432739,0.2849102020263672,0.28611719608306885,0.342826247215271,0.264285147190094,0.30279362201690674,0.2821350693702698,0.16647161543369293,0.9089799523353577,0.3087158203125,0.22084985673427582,0.24680735170841217,0.2596096396446228,0.2962607741355896,0.2879170775413513,0.2683926820755005,0.3129503130912781,0.2806784510612488,0.2407192438840866,0.28312695026397705,0.28339332342147827],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648],"y":[0.9082584977149963,0.30940359830856323,0.19216062128543854,0.22704632580280304,0.19653113186359406,0.3053186535835266,0.30095428228378296,0.290297269821167,0.30830228328704834,0.3004923462867737,0.24698291718959808,0.2940453290939331,0.24121348559856415,0.9039124846458435,0.3375926613807678,0.21554358303546906,0.10942377150058746,0.25210899114608765,0.2928387522697449,0.27302998304367065,0.3223586082458496,0.2772728204727173,0.3134915828704834,0.28843969106674194,0.3053186535835266,0.20997215807437897,0.9057053923606873,0.31574583053588867,0.1330014020204544,0.2979546785354614,0.28996390104293823,0.30240559577941895,0.30940359830856323,0.3130180239677429,0.32062286138534546,0.2170286625623703,0.2634638547897339,0.2367304414510727,0.22523663938045502,0.9067336916923523,0.30095428228378296,0.2709217071533203,0.29018622636795044,0.22728349268436432,0.21972905099391937,0.183018758893013,0.25956785678863525,0.3367612361907959,0.21972905099391937,0.25012290477752686,0.3546832203865051,0.3020170331001282,0.9054310917854309,0.3271757960319519,0.14780418574810028,0.11293925344944,0.2265237718820572,0.27808964252471924,0.21459849178791046,0.3457905650138855,0.23691312968730927,0.2703218460083008,0.1040194183588028,0.3034623861312866,0.3047597408294678,0.8834611773490906,0.2723556160926819,0.11077587306499481,0.2343437522649765,0.2360442727804184,0.24508897960186005,0.27441275119781494,0.25981831550598145,0.3383907079696655,0.3067801594734192,0.3226521611213684,0.20624051988124847,0.2136499434709549,0.8907544016838074,0.23677612841129303,0.0,0.2370956689119339,0.17053259909152985,0.2578917145729065,0.30761152505874634,0.31741517782211304,0.27064192295074463,0.1996680349111557,0.17517061531543732,0.2690775990486145,0.2895558476448059,0.8717313408851624,0.19679848849773407,0.18369482457637787,0.19791828095912933,0.11559952795505524,0.16465918719768524,0.16037936508655548,0.2092607170343399,0.2909996509552002,0.2400437444448471,0.16050268709659576,0.23999865353107452,0.20019589364528656,0.8333074450492859,0.21349982917308807,0.045169904828071594,0.20198248326778412,0.13518895208835602,0.27641427516937256,0.2375970035791397,0.17023621499538422,0.27429449558258057,0.20910803973674774,0.1838635355234146,0.20536358654499054,0.27227622270584106,0.842016875743866,0.20767830312252045,0.10874505341053009,0.2015632539987564,0.1981310099363327,0.1460491567850113,0.1654461771249771,0.29214149713516235,0.23814274370670319,0.21063102781772614,0.13086412847042084,0.22879613935947418,0.1681516319513321],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"t: time (months)"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y(t): Response variable"}},"legend":{"tracegroupgap":0},"title":{"text":"CO2 Emissions per month from Petroleum since 1973"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('a567fec3-183c-433f-90dc-0b233b4ad674');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="reformat-data-into-required-shape-3" class="level3">
<h3 class="anchored" data-anchor-id="reformat-data-into-required-shape-3">Reformat data into required shape</h3>
<p>Required shape = (samples, time, features)</p>
<div class="cell" data-execution_count="56">
<div class="cell-output cell-output-display">

<div>                            <div id="773aa592-0443-4ca5-a1ed-b33402ae4939" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("773aa592-0443-4ca5-a1ed-b33402ae4939")) {                    Plotly.newPlot(                        "773aa592-0443-4ca5-a1ed-b33402ae4939",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8],"xaxis":"x","y":[0.15172530710697174,0.1740044206380844,0.16338278353214264,0.1903034895658493,0.2024533599615097,0.19882117211818695,0.2095658928155899,0.1730675846338272,0.21618817746639252],"yaxis":"y","type":"scatter"},{"x":[9],"y":[0.17673657834529877],"type":"scatter"},{"mode":"lines","x":[10,11,12,13,14,15,16,17,18],"y":[0.18464945256710052,0.8202983736991882,0.18318791687488556,0.1547688990831375,0.19502879679203033,0.1569654792547226,0.14051033556461334,0.15994741022586823,0.15715287625789642],"type":"scatter"},{"x":[19],"y":[0.1625894159078598],"type":"scatter"},{"mode":"lines","x":[20,21,22,23,24,25,26,27,28],"y":[0.18188802897930145,0.1417074054479599,0.16074906289577484,0.17961134016513824,0.7977923154830933,0.17789040505886078,0.15388493239879608,0.15172530710697174,0.1628948599100113],"type":"scatter"},{"x":[29],"y":[0.14506886899471283],"type":"scatter"},{"mode":"lines","x":[30,31,32,33,34,35,36,37,38],"y":[0.15407459437847137,0.20213954150676727,0.1833006590604782,0.17406286299228668,0.20541523396968842,0.1740044206380844,0.1845373660326004,0.8058810830116272,0.19706551730632782],"type":"scatter"},{"x":[39],"y":[0.15677793323993683],"type":"scatter"},{"mode":"lines","x":[40,41,42,43,44,45,46,47,48],"y":[0.1833006590604782,0.16713295876979828,0.17586778104305267,0.1602560430765152,0.1376277059316635,0.21904440224170685,0.17817802727222443,0.159638449549675,0.13065634667873383],"type":"scatter"},{"x":[49],"y":[0.16647161543369293],"type":"scatter"},{"mode":"lines","x":[50,51,52,53,54,55,56,57,58],"y":[0.8031589388847351,0.1948673576116562,0.15147005021572113,0.1991390436887741,0.16056428849697113,0.18046750128269196,0.16099520027637482,0.26313459873199463,0.20082791149616241],"type":"scatter"},{"x":[59],"y":[0.21524550020694733],"type":"scatter"},{"mode":"lines","x":[60,61,62,63,64,65,66,67,68],"y":[0.20354856550693512,0.20109079778194427,0.1764473170042038,0.8267553448677063,0.20024864375591278,0.15229876339435577,0.19008411467075348,0.10949908196926117,0.20224417746067047],"type":"scatter"},{"x":[69],"y":[0.17171479761600494],"type":"scatter"},{"mode":"lines","x":[70,71,72,73,74,75,76,77,78],"y":[0.17189167439937592,0.20701174437999725,0.18245400488376617,0.19096054136753082,0.20716573297977448,0.1884879618883133,0.8152609467506409,0.1647198349237442,0.14322884380817413],"type":"scatter"},{"x":[79],"y":[0.1736534982919693],"type":"scatter"},{"mode":"lines","x":[80,81,82,83,84,85,86,87,88],"y":[0.12611214816570282,0.1416410654783249,0.21138910949230194,0.16677244007587433,0.25141996145248413,0.15988565981388092,0.187381312251091,0.14676563441753387,0.17394594848155975],"type":"scatter"},{"x":[89],"y":[0.8055338263511658],"type":"scatter"},{"mode":"lines","x":[90,91,92,93,94,95,96,97,98],"y":[0.17667876183986664,0.12709777057170868,0.14057700335979462,0.17748717963695526,0.17236267030239105,0.10068966448307037,0.1822277456521988,0.13471202552318573,0.180752232670784],"type":"scatter"},{"x":[99],"y":[0.15172530710697174],"type":"scatter"},{"mode":"lines","x":[100,101,102,103,104,105,106,107,108],"y":[0.2100229114294052,0.18431295454502106,0.7959848046302795,0.21359993517398834,0.10912235081195831,0.20287112891674042,0.17696775496006012,0.1321762055158615,0.20339243113994598],"type":"scatter"},{"x":[109],"y":[0.14097653329372406],"type":"scatter"},{"mode":"lines","x":[110,111,112,113,114,115,116,117,118],"y":[0.17487956583499908,0.21138910949230194,0.1579010933637619,0.20875133574008942,0.1820579320192337,0.8110336661338806,0.22432692348957062,0.1891496628522873,0.2226908951997757],"type":"scatter"},{"x":[119],"y":[0.178580179810524],"type":"scatter"},{"mode":"lines","x":[120,121,122,123,124,125,126,127,128],"y":[0.18649251759052277,0.14428190886974335,0.20448361337184906,0.20469097793102264,0.144150510430336,0.12083809077739716,0.07736097276210785,0.15608911216259003,0.8072118163108826],"type":"scatter"},{"x":[129],"y":[0.07478533685207367],"type":"scatter"},{"mode":"lines","x":[130,131,132,133,134,135,136,137,138],"y":[0.13231392204761505,0.09501494467258453,0.10239867866039276,0.13836820423603058,0.12849922478199005,0.23253889381885529,0.1937340348958969,0.17371200025081635,0.17667876183986664],"type":"scatter"},{"x":[139],"y":[0.19583474099636078],"type":"scatter"},{"mode":"lines","x":[140,141,142,143,144,145,146,147,148],"y":[0.15646503865718842,0.7867285013198853,0.20474277436733246,0.15827436745166779,0.2072683423757553,0.16556702554225922,0.20783187448978424,0.11427284777164459,0.1569029539823532],"type":"scatter"},{"x":[149],"y":[0.19216062128543854],"type":"scatter"},{"mode":"lines","x":[150,151,152,153,154,155,156,157,158],"y":[0.1637481302022934,0.21529521048069,0.14316289126873016,0.14487238228321075,0.8074353337287903,0.1466355174779892,0.14578811824321747,0.19150672852993011,0.15489493310451508],"type":"scatter"},{"x":[159],"y":[0.22418300807476044],"type":"scatter"},{"mode":"lines","x":[160,161,162,163,164,165,166,167,168],"y":[0.17598383128643036,0.2185051590204239,0.24313636124134064,0.14624474942684174,0.21063102781772614,0.21519581973552704,0.19340930879116058,0.8237342238426208,0.21264760196208954],"type":"scatter"},{"x":[169],"y":[0.20757584273815155],"type":"scatter"},{"mode":"lines","x":[170,171,172,173,174,175,176,177,178],"y":[0.22336585819721222,0.11271630227565765,0.2020348459482193,0.24890641868114471,0.13518895208835602,0.2009330540895462,0.23791547119617462,0.15318824350833893,0.16653181612491608],"type":"scatter"},{"x":[179],"y":[0.19956232607364655],"type":"scatter"},{"mode":"lines","x":[180,181,182,183,184,185,186,187,188],"y":[0.8274838328361511,0.27633607387542725,0.17452986538410187,0.20161570608615875,0.2000904232263565,0.18346963822841644,0.21359993517398834,0.2413032501935959,0.25852155685424805],"type":"scatter"},{"x":[189],"y":[0.18188802897930145],"type":"scatter"},{"mode":"lines","x":[190,191,192,193,194,195,196,197,198],"y":[0.2405392974615097,0.23341979086399078,0.236410453915596,0.8548150658607483,0.24715839326381683,0.22259433567523956,0.2562045454978943,0.22860755026340485,0.25505930185317993],"type":"scatter"},{"x":[199],"y":[0.15583817660808563],"type":"scatter"},{"mode":"lines","x":[200,201,202,203,204,205,206,207,208],"y":[0.19674505293369293,0.2689971327781677,0.22547547519207,0.2129487246274948,0.24438069760799408,0.26665204763412476,0.8663154244422913,0.29232513904571533,0.19079641997814178],"type":"scatter"},{"x":[209],"y":[0.19743894040584564],"type":"scatter"},{"mode":"lines","x":[210,211,212,213,214,215,216,217,218],"y":[0.19112451374530792,0.2663675546646118,0.21717672049999237,0.2322600930929184,0.2773118019104004,0.2183578759431839,0.2126978188753128,0.23355858027935028,0.19556637108325958],"type":"scatter"},{"x":[219],"y":[0.8620746731758118],"type":"scatter"},{"mode":"lines","x":[220,221,222,223,224,225,226,227,228],"y":[0.2677463889122009,0.22860755026340485,0.2575131058692932,0.21209461987018585,0.22504539787769318,0.2341592162847519,0.25219500064849854,0.2700013518333435,0.2654305100440979],"type":"scatter"},{"x":[229],"y":[0.2567541003227234],"type":"scatter"},{"mode":"lines","x":[230,231,232,233,234,235,236,237,238],"y":[0.27773988246917725,0.292802095413208,0.8871285319328308,0.21717672049999237,0.1784653514623642,0.24495632946491241,0.2774675488471985,0.22737832367420197,0.22375069558620453],"type":"scatter"},{"x":[239],"y":[0.2545912265777588],"type":"scatter"},{"mode":"lines","x":[240,241,242,243,244,245,246,247,248],"y":[0.24495632946491241,0.259901762008667,0.2900009751319885,0.2521519660949707,0.26827168464660645,0.8792752623558044,0.29232513904571533,0.2388685792684555,0.2964053750038147],"type":"scatter"},{"x":[249],"y":[0.282631516456604],"type":"scatter"},{"mode":"lines","x":[250,251,252,253,254,255,256,257,258],"y":[0.3069189190864563,0.32592374086380005,0.3105001449584961,0.30524885654449463,0.22002191841602325,0.305213987827301,0.26972055435180664,0.25852155685424805,0.9188817143440247],"type":"scatter"},{"x":[259],"y":[0.2570917010307312],"type":"scatter"},{"mode":"lines","x":[260,261,262,263,264,265,266,267,268],"y":[0.25446343421936035,0.2946646809577942,0.2518077492713928,0.2777788043022156,0.3049694895744324,0.2855144143104553,0.29488295316696167,0.2806015610694885,0.24482358992099762],"type":"scatter"},{"x":[269],"y":[0.27808964252471924],"type":"scatter"},{"mode":"lines","x":[270,271,272,273,274,275,276,277,278],"y":[0.26567530632019043,0.9076300263404846,0.29103654623031616,0.24833960831165314,0.241841122508049,0.2781673073768616,0.3069535493850708,0.30740392208099365,0.2696402668952942],"type":"scatter"},{"x":[279],"y":[0.26202017068862915],"type":"scatter"},{"mode":"lines","x":[280,281,282,283,284,285,286,287,288],"y":[0.24842692911624908,0.28619247674942017,0.2528819441795349,0.24908055365085602,0.9039357304573059,0.27766215801239014,0.25981831550598145,0.26758456230163574,0.23517243564128876],"type":"scatter"},{"x":[289],"y":[0.29773902893066406],"type":"scatter"},{"mode":"lines","x":[290,291,292,293,294,295,296,297,298],"y":[0.27664870023727417,0.29978007078170776,0.25365251302719116,0.27598387002944946,0.2602352499961853,0.280139684677124,0.2982059717178345,0.9069998860359192,0.2539088726043701],"type":"scatter"},{"x":[299],"y":[0.25305336713790894],"type":"scatter"},{"mode":"lines","x":[300,301,302,303,304,305,306,307,308],"y":[0.3196021318435669,0.2751995325088501,0.252022922039032,0.2828983664512634,0.2923985719680786,0.27203768491744995,0.27496373653411865,0.3383294343948364,0.27156001329421997],"type":"scatter"},{"x":[309],"y":[0.31537705659866333],"type":"scatter"},{"mode":"lines","x":[310,311,312,313,314,315,316,317,318],"y":[0.9176526665687561,0.24402575194835663,0.25429296493530273,0.2652263641357422,0.27136069536209106,0.27711695432662964,0.32141029834747314,0.2944098711013794,0.2629697918891907],"type":"scatter"},{"x":[319],"y":[0.25927531719207764],"type":"scatter"},{"mode":"lines","x":[320,321,322,323,324,325,326,327,328],"y":[0.30612003803253174,0.29806244373321533,0.3264702558517456,0.9158216118812561,0.2661234140396118,0.2926921248435974,0.28536349534988403,0.3204585313796997,0.318146288394928],"type":"scatter"},{"x":[329],"y":[0.33731579780578613],"type":"scatter"},{"mode":"lines","x":[330,331,332,333,334,335,336,337,338],"y":[0.32797521352767944,0.3709683418273926,0.3303268551826477,0.32320576906204224,0.29691082239151,0.36953508853912354,0.9544722437858582,0.32701563835144043,0.3373773694038391],"type":"scatter"},{"x":[339],"y":[0.3587895631790161],"type":"scatter"},{"mode":"lines","x":[340,341,342,343,344,345,346,347,348],"y":[0.32379066944122314,0.3384826183319092,0.36073392629623413,0.33731579780578613,0.35112255811691284,0.33872759342193604,0.3446568250656128,0.3033568859100342,0.3282623887062073],"type":"scatter"},{"x":[349],"y":[0.9706849455833435],"type":"scatter"},{"mode":"lines","x":[350,351,352,353,354,355,356,357,358],"y":[0.3304217457771301,0.2614818215370178,0.30447977781295776,0.2596096396446228,0.34396815299987793,0.3069189190864563,0.3017694354057312,0.3349038362503052,0.29502832889556885],"type":"scatter"},{"x":[359],"y":[0.2707219123840332],"type":"scatter"},{"mode":"lines","x":[360,361,362,363,364,365,366,367,368],"y":[0.2595260739326477,0.28373539447784424,0.9304376244544983,0.2671389579772949,0.20915894210338593,0.33234333992004395,0.30240559577941895,0.3204585313796997,0.33857452869415283],"type":"scatter"},{"x":[369],"y":[0.3493380546569824],"type":"scatter"},{"mode":"lines","x":[370,371,372,373,374,375,376,377,378],"y":[0.3092661499977112,0.32150858640670776,0.31382930278778076,0.33471739292144775,0.3577123284339905,0.9485271573066711,0.3524309992790222,0.3159467577934265,0.34086108207702637],"type":"scatter"},{"x":[379],"y":[0.3546257019042969],"type":"scatter"},{"mode":"lines","x":[380,381,382,383,384,385,386,387,388],"y":[0.3313056230545044,0.337346613407135,0.3718298077583313,0.33462411165237427,0.340678870677948,0.31426769495010376,0.32931262254714966,0.30500441789627075,0.9690858721733093],"type":"scatter"},{"x":[389],"y":[0.29151594638824463],"type":"scatter"},{"mode":"lines","x":[390,391,392,393,394,395,396,397,398],"y":[0.27781766653060913,0.3244389295578003,0.34183043241500854,0.305283784866333,0.3467710614204407,0.358619749546051,0.3201294541358948,0.3357413411140442,0.35428041219711304],"type":"scatter"},{"x":[399],"y":[0.34360814094543457],"type":"scatter"},{"mode":"lines","x":[400,401,402,403,404,405,406,407,408],"y":[0.36634230613708496,0.9646288752555847,0.36327576637268066,0.2778565287590027,0.3470674157142639,0.3300420045852661,0.422146201133728,0.3709414005279541,0.3509475588798523],"type":"scatter"},{"x":[409],"y":[0.38632506132125854],"type":"scatter"},{"mode":"lines","x":[410,411,412,413,414,415,416,417,418],"y":[0.3805217146873474,0.3585348129272461,0.3954026699066162,0.3950348496437073,1.0000001192092896,0.35568737983703613,0.3320293426513672,0.35986220836639404,0.3759881854057312],"type":"scatter"},{"x":[419],"y":[0.3983982801437378],"type":"scatter"},{"mode":"lines","x":[420,421,422,423,424,425,426,427,428],"y":[0.3634147047996521,0.3921728730201721,0.3641359210014343,0.3452243208885193,0.320096492767334,0.36005932092666626,0.3716685175895691,0.9952238202095032,0.34375816583633423],"type":"scatter"},{"x":[429],"y":[0.27156001329421997],"type":"scatter"},{"mode":"lines","x":[430,431,432,433,434,435,436,437,438],"y":[0.35739970207214355,0.30916309356689453,0.3417094945907593,0.36252427101135254,0.34444743394851685,0.364993155002594,0.3947893977165222,0.3546544909477234,0.368529736995697],"type":"scatter"},{"x":[439],"y":[0.4060072898864746],"type":"scatter"},{"mode":"lines","x":[440,441,442,443,444,445,446,447,448],"y":[0.9865911602973938,0.31335633993148804,0.28377342224121094,0.37545889616012573,0.3045147657394409,0.371345579624176,0.3296300172805786,0.30377858877182007,0.3660125732421875],"type":"scatter"},{"x":[449],"y":[0.36079007387161255],"type":"scatter"},{"mode":"lines","x":[450,451,452,453,454,455,456,457,458],"y":[0.3127809166908264,0.31904059648513794,0.38122206926345825,0.969957172870636,0.347215473651886,0.2895187735557556,0.33209216594696045,0.32854926586151123,0.32301050424575806],"type":"scatter"},{"x":[459],"y":[0.3126792311668396],"type":"scatter"},{"mode":"lines","x":[460,461,462,463,464,465,466,467,468],"y":[0.3647722005844116,0.331463098526001,0.25085872411727905,0.3290584087371826,0.3049345016479492,0.347511351108551,0.9561248421669006,0.3071961998939514,0.28094738721847534],"type":"scatter"},{"x":[469],"y":[0.3044097423553467],"type":"scatter"},{"mode":"lines","x":[470,471,472,473,474,475,476,477,478],"y":[0.33820676803588867,0.34807252883911133,0.35634511709213257,0.27179890871047974,0.29593509435653687,0.32366079092025757,0.2407192438840866,0.2522379755973816,0.2812544107437134],"type":"scatter"},{"x":[479],"y":[0.9352672696113586],"type":"scatter"},{"mode":"lines","x":[480,481,482,483,484,485,486,487,488],"y":[0.20520852506160736,0.2347584217786789,0.3214758038520813,0.2876927852630615,0.2640800476074219,0.3049694895744324,0.296622097492218,0.32624536752700806,0.3175482749938965],"type":"scatter"},{"x":[489],"y":[0.2606514096260071],"type":"scatter"},{"mode":"lines","x":[490,491,492,493,494,495,496,497,498],"y":[0.290297269821167,0.28679364919662476,0.9180871844291687,0.28156107664108276,0.20292331278324127,0.2719581127166748,0.2681505084037781,0.3152428865432739,0.2849102020263672],"type":"scatter"},{"x":[499],"y":[0.28611719608306885],"type":"scatter"},{"mode":"lines","x":[500,501,502,503,504,505,506,507,508],"y":[0.342826247215271,0.264285147190094,0.30279362201690674,0.2821350693702698,0.16647161543369293,0.9089799523353577,0.3087158203125,0.22084985673427582,0.24680735170841217],"type":"scatter"},{"x":[509],"y":[0.2596096396446228],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"t: time (months)"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y(t): Response variable"}},"legend":{"tracegroupgap":0},"title":{"text":"CO2 Emissions per month from Petroleum since 1973"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('773aa592-0443-4ca5-a1ed-b33402ae4939');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="model-1-rnn-3" class="level3">
<h3 class="anchored" data-anchor-id="model-1-rnn-3">Model 1 = RNN</h3>
<section id="model-architecture-9" class="level4">
<h4 class="anchored" data-anchor-id="model-architecture-9">Model architecture</h4>
<div class="cell" data-execution_count="58">
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_9"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 simple_rnn_3 (SimpleRNN)    (None, 3)                 15        
                                                                 
 dense_9 (Dense)             (None, 1)                 4         
                                                                 
=================================================================
Total params: 19
Trainable params: 19
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="plot-training-and-validation-loss-mse-3" class="level4">
<h4 class="anchored" data-anchor-id="plot-training-and-validation-loss-mse-3">Plot training and validation loss (MSE)</h4>
<div class="cell" data-execution_count="60">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s2/2 [==============================] - 0s 3ms/step
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 20ms/step
(51, 9, 1) (51,) (51,) (12, 9, 1) (12,) (12,)
(51,) (51,)
0.03671631
0.008171727
Train MSE = 0.03672 RMSE = 0.19162
Test MSE = 0.00817 RMSE = 0.09040</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="30986bbf-de30-4dcd-a47c-40f86c0a6aa2" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("30986bbf-de30-4dcd-a47c-40f86c0a6aa2")) {                    Plotly.newPlot(                        "30986bbf-de30-4dcd-a47c-40f86c0a6aa2",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"xaxis":"x","y":[0.09408515691757202,0.08788059651851654,0.08435357362031937,0.08148808777332306,0.07918050140142441,0.07712918519973755,0.07558619976043701,0.07390102744102478,0.07252689450979233,0.07124063372612,0.07013098895549774,0.06906619668006897,0.06824643909931183,0.06753601133823395,0.06668250262737274,0.06602411717176437,0.06543894857168198,0.06492457538843155,0.06437547504901886,0.0641653910279274,0.06355023384094238,0.06317264586687088,0.06269863992929459,0.06270019710063934,0.06196833774447441,0.06160870939493179,0.0613713338971138,0.06093263626098633,0.06049863621592522,0.06017368286848068,0.06000049039721489,0.0594526045024395,0.059349048882722855,0.05894466117024422,0.058484047651290894,0.05813530832529068,0.058128487318754196,0.05765366554260254,0.05718244984745979,0.056960273534059525,0.056566525250673294,0.056387703865766525,0.055983949452638626,0.05572982877492905,0.05546676367521286,0.05520840361714363,0.054801516234874725,0.05441076308488846,0.054132480174303055,0.05383152514696121,0.05360652133822441,0.053502343595027924,0.053010422736406326,0.05278869345784187,0.052560918033123016,0.052355922758579254,0.05197039246559143,0.05164490267634392,0.05134899169206619,0.05125492811203003,0.050846945494413376,0.05101442337036133,0.05059558153152466,0.05018165707588196,0.05019894987344742,0.049736592918634415,0.049480777233839035,0.04930812120437622,0.049106817692518234,0.048899441957473755,0.048541076481342316,0.04845628887414932,0.04807585850358009,0.047925908118486404,0.04790673404932022,0.04753340408205986,0.04722309857606888,0.047008734196424484,0.046842776238918304,0.04676951840519905,0.04649538919329643,0.046234406530857086,0.045946188271045685,0.046245723962783813,0.04569808021187782,0.04546601325273514,0.04521526023745537,0.04530549421906471,0.0450935959815979,0.04469671472907066,0.044665899127721786,0.04436298832297325,0.044252824038267136,0.04428877308964729,0.04388246685266495,0.043648798018693924,0.04350052401423454,0.04354100674390793,0.043326910585165024,0.04317900165915489,0.04292900115251541,0.04285765066742897,0.04273165389895439,0.042378246784210205,0.04246310889720917,0.04215436801314354,0.04214682802557945,0.04182728752493858,0.04171852767467499,0.041610635817050934,0.04142506793141365,0.04126536846160889,0.041310109198093414,0.04119120165705681,0.040887732058763504,0.04078306630253792,0.04081321507692337,0.040469247847795486,0.04036785289645195,0.04040807485580444,0.040136031806468964,0.04019199311733246,0.03999902307987213,0.03986836597323418,0.03962673619389534,0.03960777074098587,0.03940718621015549,0.039419665932655334,0.0393192321062088,0.03911197930574417,0.03902020677924156,0.0388980433344841,0.038798738270998,0.03867217153310776,0.03865735977888107,0.038548726588487625,0.038354016840457916,0.03838612511754036,0.03832141309976578,0.038090772926807404,0.038111262023448944,0.0379396453499794,0.03797537833452225,0.03793769329786301,0.03771150857210159,0.037654828280210495,0.037668950855731964,0.0375959649682045,0.03747285157442093,0.03735962510108948,0.03724396973848343,0.03713313490152359,0.03713067248463631,0.03703651577234268,0.036987558007240295,0.036936722695827484,0.03678596019744873,0.03698273375630379,0.036987870931625366,0.03663354367017746,0.036746710538864136,0.03652258962392807,0.0365779884159565,0.03654400259256363,0.0363631471991539,0.036551035940647125,0.03636074811220169,0.03628868982195854,0.036260172724723816,0.0363428071141243,0.03625396639108658,0.03613487631082535,0.036067936569452286,0.03620848059654236,0.03594927489757538,0.03604457899928093,0.035925764590501785,0.0358646959066391,0.03572481498122215,0.03572757542133331,0.03572035953402519,0.035795532166957855,0.03563139587640762,0.0357588455080986,0.035584334284067154,0.03557894378900528,0.035522349178791046,0.03566654771566391,0.03557218238711357,0.03541292995214462,0.03542347997426987,0.035352401435375214,0.03543064743280411,0.03534232825040817,0.035327669233083725,0.03526153415441513,0.03525708615779877,0.03535271808505058,0.03519025817513466,0.03530501574277878],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"y":[0.11487842351198196,0.10807397961616516,0.10332829505205154,0.09918633103370667,0.09544038772583008,0.09197469055652618,0.08913397043943405,0.0863245353102684,0.08361832052469254,0.0813630223274231,0.07911620289087296,0.0770581066608429,0.07534439861774445,0.07387594878673553,0.07243714481592178,0.07114937156438828,0.07000188529491425,0.06893141567707062,0.06807798892259598,0.0673065111041069,0.06664644181728363,0.06607386469841003,0.0655355229973793,0.06535785645246506,0.06496407836675644,0.06450155377388,0.06396307796239853,0.06372860074043274,0.06347239762544632,0.06317555159330368,0.06279177963733673,0.06236919388175011,0.062042560428380966,0.0616474486887455,0.06149335950613022,0.061183761805295944,0.06090255826711655,0.06053581461310387,0.060303542762994766,0.060073066502809525,0.059768639504909515,0.05948612466454506,0.059191297739744186,0.058991704136133194,0.05873293802142143,0.05858689919114113,0.0584101639688015,0.05816809833049774,0.057892464101314545,0.05768047645688057,0.057489063590765,0.05721227079629898,0.056993450969457626,0.0566762238740921,0.05664782226085663,0.05644414201378822,0.05615032836794853,0.05591847002506256,0.05577613040804863,0.055634818971157074,0.05548578128218651,0.05539602041244507,0.055228665471076965,0.05496828630566597,0.05490595102310181,0.05464126169681549,0.054343804717063904,0.054105713963508606,0.05405055359005928,0.053903285413980484,0.053676292300224304,0.0534030944108963,0.05333451181650162,0.05322662740945816,0.053004924207925797,0.05290699005126953,0.05274995416402817,0.0525457002222538,0.052191153168678284,0.05207366123795509,0.05186809226870537,0.051648035645484924,0.0514739491045475,0.05161549150943756,0.05150332301855087,0.0513494610786438,0.05121506378054619,0.05100589990615845,0.05079319328069687,0.050663817673921585,0.05065067112445831,0.050366174429655075,0.05022311210632324,0.0501609668135643,0.05008475482463837,0.049928709864616394,0.04967474937438965,0.04940077289938927,0.04928238317370415,0.04912711679935455,0.04900132119655609,0.04902542009949684,0.04893998056650162,0.048790380358695984,0.04873184114694595,0.048669468611478806,0.048568882048130035,0.04846915230154991,0.04825481027364731,0.0481145940721035,0.048074353486299515,0.04781882464885712,0.04778696224093437,0.04767856374382973,0.047538913786411285,0.04751366749405861,0.04736929014325142,0.04724910110235214,0.047081269323825836,0.04699832573533058,0.04701560363173485,0.047012291848659515,0.047006238251924515,0.04677213728427887,0.04674382507801056,0.04659771919250488,0.046389829367399216,0.04645789787173271,0.046517789363861084,0.04652848467230797,0.04646199941635132,0.04641610011458397,0.0463852658867836,0.046197619289159775,0.04592883586883545,0.04584229364991188,0.04569155350327492,0.045684102922677994,0.04569372162222862,0.045656945556402206,0.04562504589557648,0.04558158293366432,0.04548020288348198,0.045461930334568024,0.04532325640320778,0.04533481225371361,0.045156266540288925,0.04505683481693268,0.04506782069802284,0.04495452716946602,0.044869594275951385,0.04488057643175125,0.04485710710287094,0.04476099833846092,0.0447036549448967,0.044587764889001846,0.044552210718393326,0.04469168558716774,0.04485724866390228,0.04470454156398773,0.04476837441325188,0.04473799094557762,0.04456824064254761,0.04451218619942665,0.044462621212005615,0.04445827007293701,0.04444941505789757,0.04447534307837486,0.04448212683200836,0.044417236000299454,0.044426172971725464,0.04430105537176132,0.04439253360033035,0.04434627667069435,0.04437335208058357,0.044298332184553146,0.044228941202163696,0.044222649186849594,0.04412006214261055,0.04406524822115898,0.04404420033097267,0.04408293589949608,0.04392802342772484,0.04397730901837349,0.04401467740535736,0.04401441290974617,0.04390637204051018,0.04398614540696144,0.04400220140814781,0.044016510248184204,0.043990060687065125,0.04383960738778114,0.04391641914844513,0.043779149651527405,0.043895140290260315,0.0437719002366066,0.04369666799902916,0.04373213276267052,0.043665267527103424,0.043751947581768036],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"training epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training and Validation Loss - RNN"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('30986bbf-de30-4dcd-a47c-40f86c0a6aa2');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="forecasting---next-5-years-60-months-9" class="level4">
<h4 class="anchored" data-anchor-id="forecasting---next-5-years-60-months-9">Forecasting - next 5 years (60 months)</h4>
<div class="cell" data-execution_count="61">
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 22ms/step</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="deeplearning_files/figure-html/cell-62-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="model-2---gru-3" class="level3">
<h3 class="anchored" data-anchor-id="model-2---gru-3">Model 2 - GRU</h3>
<section id="model-architecture-10" class="level4">
<h4 class="anchored" data-anchor-id="model-architecture-10">Model Architecture</h4>
<div class="cell" data-execution_count="62">
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_10"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 gru_3 (GRU)                 (None, 3)                 54        
                                                                 
 dense_10 (Dense)            (None, 1)                 4         
                                                                 
=================================================================
Total params: 58
Trainable params: 58
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="plot-training-and-validation-loss-6" class="level4">
<h4 class="anchored" data-anchor-id="plot-training-and-validation-loss-6">Plot training and validation loss</h4>
<div class="cell" data-execution_count="64">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 18ms/step
(51, 9, 1) (51,) (51,) (5, 9, 1) (5,) (5,)
(51,) (51,)
0.03283102
0.018419573
Train MSE = 0.03283 RMSE = 0.18119
Test MSE = 0.01842 RMSE = 0.13572</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="9e0611e6-ced3-46a9-9812-2512283ad487" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("9e0611e6-ced3-46a9-9812-2512283ad487")) {                    Plotly.newPlot(                        "9e0611e6-ced3-46a9-9812-2512283ad487",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"xaxis":"x","y":[0.07103973627090454,0.06727348268032074,0.06555498391389847,0.06447021663188934,0.0632394328713417,0.06249435991048813,0.061773188412189484,0.06105741113424301,0.060525137931108475,0.06020218878984451,0.05947493389248848,0.05904650688171387,0.058290980756282806,0.05784984305500984,0.05764096975326538,0.05692543834447861,0.05643131583929062,0.05594516545534134,0.05531498044729233,0.05510873720049858,0.05453977733850479,0.05392856523394585,0.0535268560051918,0.053346455097198486,0.05268329381942749,0.05237683653831482,0.052004821598529816,0.05141300708055496,0.050894297659397125,0.050711095333099365,0.05037561058998108,0.05003318935632706,0.04935436323285103,0.049376994371414185,0.04887779802083969,0.04853403568267822,0.0480039045214653,0.04780060797929764,0.047342441976070404,0.047105081379413605,0.04682410508394241,0.04624052345752716,0.04601095989346504,0.045748308300971985,0.045483119785785675,0.04497893527150154,0.04480063170194626,0.04480110481381416,0.044312503188848495,0.044021543115377426,0.043697990477085114,0.04337837174534798,0.04320438951253891,0.04313703253865242,0.04276525229215622,0.04229911416769028,0.042172662913799286,0.041808973997831345,0.04181000590324402,0.04134939983487129,0.041208893060684204,0.040862105786800385,0.04061276838183403,0.04036816209554672,0.04039495065808296,0.03995288163423538,0.03996790200471878,0.03973939269781113,0.03944934159517288,0.03939330205321312,0.03910776972770691,0.038718655705451965,0.03876527026295662,0.03840286657214165,0.03850843012332916,0.038035668432712555,0.03808099403977394,0.03790664300322533,0.03756992891430855,0.03743233531713486,0.03725859522819519,0.03713192418217659,0.037263210862874985,0.03693423792719841,0.03663138672709465,0.03684800863265991,0.036537058651447296,0.036424607038497925,0.03614600747823715,0.03604557365179062,0.03587052598595619,0.03611918166279793,0.03564506024122238,0.03571677207946777,0.035387422889471054,0.035514622926712036,0.03530307486653328,0.035380683839321136,0.035176731646060944,0.035094596445560455,0.035066425800323486,0.034811872988939285,0.03486693277955055,0.0346548818051815,0.0343979112803936,0.03496217355132103,0.034455593675374985,0.034287624061107635,0.034241821616888046,0.034010592848062515,0.03416776657104492,0.03435511142015457,0.03396070748567581,0.03399991989135742,0.03414852172136307,0.03373805806040764,0.03370890021324158,0.03361485153436661,0.03363607078790665,0.033409301191568375,0.033373210579156876,0.033319421112537384,0.03351987898349762,0.033360786736011505,0.03320550173521042,0.03307030722498894,0.03327444940805435,0.033118896186351776,0.032955266535282135,0.03290008753538132,0.033145517110824585,0.03304581716656685,0.032747216522693634,0.03284185379743576,0.03278731554746628,0.03264728933572769,0.0328083410859108,0.032584790140390396,0.03313791751861572,0.032513756304979324,0.032468874007463455,0.03241825848817825,0.032434456050395966,0.03241213038563728,0.03267112746834755,0.03228965401649475,0.0324910469353199,0.03225751966238022,0.03234555572271347,0.03237934410572052,0.03232228010892868,0.0323118157684803,0.032353322952985764,0.03221651166677475,0.03202535957098007,0.03222793713212013,0.03200965002179146,0.032140202820301056,0.0321086086332798,0.03214284032583237,0.032163143157958984,0.03192002698779106,0.03207816928625107,0.03206969425082207,0.031812410801649094,0.031949106603860855,0.03186853602528572,0.03177211806178093,0.03206808492541313,0.03195636346936226,0.03174800053238869,0.03166996315121651,0.03203900530934334,0.031928420066833496,0.03166789188981056,0.031927842646837234,0.03182603418827057,0.03160370513796806,0.03179148957133293,0.0316515676677227,0.03157569095492363,0.031644634902477264,0.0317508690059185,0.0318063348531723,0.03162378817796707,0.03177427500486374,0.0314338393509388,0.03158756345510483,0.03172968700528145,0.03142280876636505,0.031503282487392426,0.03160975128412247,0.0317557118833065,0.031398169696331024,0.03143581748008728,0.03141210228204727,0.03146900609135628,0.03169901669025421,0.03149903938174248,0.031644225120544434],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"y":[0.0790306031703949,0.07510128617286682,0.07288266718387604,0.07120119780302048,0.06971534341573715,0.06879685074090958,0.06776631623506546,0.06686779111623764,0.06635171920061111,0.06556715816259384,0.06485223025083542,0.06452403962612152,0.06388986855745316,0.0634130910038948,0.06292271614074707,0.062460605055093765,0.06186842918395996,0.06156585365533829,0.06106811761856079,0.06063491106033325,0.06013643741607666,0.059789370745420456,0.05940103903412819,0.059042323380708694,0.05855288356542587,0.05819244682788849,0.05779857933521271,0.05738856643438339,0.05708184093236923,0.05680204555392265,0.056532490998506546,0.05617900192737579,0.05582040548324585,0.05548933520913124,0.055160608142614365,0.05484024062752724,0.0545119047164917,0.05414051190018654,0.053880468010902405,0.05352065712213516,0.05329833924770355,0.05293462052941322,0.052642691880464554,0.05220131576061249,0.051814571022987366,0.0515088215470314,0.05124010890722275,0.0510169118642807,0.05098065361380577,0.050702158361673355,0.05033796653151512,0.05013857036828995,0.04980853572487831,0.04960080236196518,0.04933062568306923,0.04906778410077095,0.04879952594637871,0.048546984791755676,0.048375602811574936,0.0482562780380249,0.04805370420217514,0.04794732481241226,0.047597531229257584,0.04723048210144043,0.04713141918182373,0.04688168689608574,0.046942438930273056,0.0466579832136631,0.04647397994995117,0.04639036953449249,0.04603857919573784,0.04590960964560509,0.045956600457429886,0.04570090398192406,0.04561257362365723,0.045502711087465286,0.04527989774942398,0.04508131369948387,0.04484116658568382,0.044587668031454086,0.04463141784071922,0.04447908699512482,0.0444149523973465,0.044186051934957504,0.04389810934662819,0.04368257150053978,0.04368603602051735,0.04348234832286835,0.04339832812547684,0.04336489364504814,0.04330894723534584,0.0432475246489048,0.04296413064002991,0.042925912886857986,0.04282301291823387,0.04288889467716217,0.04262430965900421,0.04263044893741608,0.04249036684632301,0.04243258759379387,0.04234115779399872,0.0421455055475235,0.041998639702796936,0.04205421358346939,0.04186170920729637,0.041930340230464935,0.0416959673166275,0.041513584554195404,0.041370391845703125,0.04146025702357292,0.0413978137075901,0.04140399396419525,0.04118706285953522,0.041199102997779846,0.04126889631152153,0.04128881171345711,0.041104283183813095,0.04115011915564537,0.04089196398854256,0.04079463705420494,0.040717482566833496,0.04059480130672455,0.04048189893364906,0.04071060195565224,0.04048662260174751,0.04046659916639328,0.04054538905620575,0.04059285670518875,0.04055609926581383,0.040363334119319916,0.040401753038167953,0.040202196687459946,0.04015440121293068,0.04036788269877434,0.040510598570108414,0.040174346417188644,0.04007188603281975,0.040029462426900864,0.04025883600115776,0.04019967094063759,0.040030546486377716,0.04010365903377533,0.03979342803359032,0.03971847519278526,0.039784494787454605,0.03961845859885216,0.03968648612499237,0.03965853899717331,0.039599400013685226,0.03941166773438454,0.0392969511449337,0.03957032784819603,0.03953414410352707,0.0395636148750782,0.0394999124109745,0.03953130915760994,0.039586517959833145,0.03942016512155533,0.0395008884370327,0.03965653106570244,0.03965136036276817,0.03948676958680153,0.03948420658707619,0.03935360535979271,0.03931227698922157,0.03935284540057182,0.039349619299173355,0.03932741656899452,0.03940419852733612,0.03933999314904213,0.039238277822732925,0.0391809456050396,0.03921525925397873,0.03916035592556,0.03914495185017586,0.03905005007982254,0.038898710161447525,0.0390024334192276,0.03903032839298248,0.03911823779344559,0.039163898676633835,0.038866207003593445,0.03894004598259926,0.038948941975831985,0.03887031972408295,0.038973428308963776,0.039028167724609375,0.03873218968510628,0.03874436393380165,0.0387171246111393,0.03882644325494766,0.03876473009586334,0.03878280147910118,0.03873683512210846,0.038756366819143295,0.03874867036938667,0.038542672991752625,0.038725875318050385,0.038781024515628815,0.0388987734913826],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"training epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training and Validation Loss - GRU"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('9e0611e6-ced3-46a9-9812-2512283ad487');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="forecasting---next-5-years-60-months-10" class="level4">
<h4 class="anchored" data-anchor-id="forecasting---next-5-years-60-months-10">Forecasting - next 5 years (60 months)</h4>
<div class="cell" data-execution_count="65">
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 19ms/step</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="deeplearning_files/figure-html/cell-66-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="model-3---lstm-3" class="level3">
<h3 class="anchored" data-anchor-id="model-3---lstm-3">Model 3 - LSTM</h3>
<section id="model-architecture-11" class="level4">
<h4 class="anchored" data-anchor-id="model-architecture-11">Model Architecture</h4>
<div class="cell" data-execution_count="66">
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_11"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 lstm_3 (LSTM)               (None, 3)                 60        
                                                                 
 dense_11 (Dense)            (None, 1)                 4         
                                                                 
=================================================================
Total params: 64
Trainable params: 64
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="plot-training-and-validation-loss-7" class="level4">
<h4 class="anchored" data-anchor-id="plot-training-and-validation-loss-7">Plot training and validation loss</h4>
<div class="cell" data-execution_count="68">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s2/2 [==============================] - 0s 2ms/step
1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 19ms/step
(51, 9, 1) (51,) (51,) (5, 9, 1) (5,) (5,)
(51,) (51,)
0.03467253
0.01929382
Train MSE = 0.03467 RMSE = 0.18621
Test MSE = 0.01929 RMSE = 0.13890</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="83b196dd-423c-4fbe-8708-302a81dc041b" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("83b196dd-423c-4fbe-8708-302a81dc041b")) {                    Plotly.newPlot(                        "83b196dd-423c-4fbe-8708-302a81dc041b",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"xaxis":"x","y":[0.08767800033092499,0.07943614572286606,0.07450009882450104,0.07083404064178467,0.06794130802154541,0.06548414379358292,0.06352686136960983,0.062168579548597336,0.060617994517087936,0.05960511416196823,0.05885590240359306,0.05823429301381111,0.05742262676358223,0.05700742080807686,0.05644123628735542,0.05600130558013916,0.05561655014753342,0.055125582963228226,0.05485544726252556,0.054283250123262405,0.054069407284259796,0.053555410355329514,0.05319948121905327,0.053041793406009674,0.052356965839862823,0.05197736620903015,0.05193416029214859,0.05165408179163933,0.051061175763607025,0.05066826194524765,0.0507756844162941,0.05046449229121208,0.04975583031773567,0.04950251430273056,0.0494169145822525,0.04899650067090988,0.04925345629453659,0.048319749534130096,0.04810277372598648,0.04791800305247307,0.04749174043536186,0.047450244426727295,0.04698438197374344,0.04705718904733658,0.04659279063344002,0.04622679203748703,0.04633257910609245,0.04594864696264267,0.04557294398546219,0.045558176934719086,0.04525439813733101,0.04487362131476402,0.044904060661792755,0.04442082345485687,0.04419795423746109,0.04424021765589714,0.04418879374861717,0.044144243001937866,0.0435161329805851,0.043308697640895844,0.04332365095615387,0.042961202561855316,0.04282272979617119,0.04287903755903244,0.042423419654369354,0.04248857498168945,0.04217494651675224,0.041970059275627136,0.04199663922190666,0.0422201044857502,0.04166073352098465,0.04133140295743942,0.04130854085087776,0.04105498269200325,0.04109770059585571,0.04078880324959755,0.04074745625257492,0.04070253670215607,0.040703047066926956,0.040273383259773254,0.04035147279500961,0.04017086327075958,0.04003532975912094,0.03979431837797165,0.039881180971860886,0.03963962569832802,0.039646487683057785,0.03943203017115593,0.03927231580018997,0.03924049064517021,0.03899219632148743,0.0388973131775856,0.03928254544734955,0.03874341771006584,0.03880644962191582,0.038796473294496536,0.038547445088624954,0.038426224142313004,0.03857317939400673,0.038176167756319046,0.03821893781423569,0.03800154849886894,0.037963297218084335,0.03784402087330818,0.03810705244541168,0.03768983110785484,0.037806108593940735,0.0376770906150341,0.0376313216984272,0.03763150796294212,0.03738520294427872,0.037273094058036804,0.03741360455751419,0.03733927011489868,0.03722647577524185,0.037160567939281464,0.0370471253991127,0.036985620856285095,0.03716210648417473,0.036995939910411835,0.03686957433819771,0.03677402064204216,0.03674594312906265,0.036656253039836884,0.03728007525205612,0.03655629605054855,0.03645552322268486,0.03637334704399109,0.03642496466636658,0.036365997046232224,0.0364677831530571,0.03633943200111389,0.0362674817442894,0.03612213209271431,0.03636635094881058,0.036199260503053665,0.03620215132832527,0.03607511892914772,0.03617333248257637,0.03589509800076485,0.036014437675476074,0.03609943762421608,0.03578890115022659,0.035840630531311035,0.03592816740274429,0.03572500869631767,0.03578128665685654,0.03571860492229462,0.03567080572247505,0.03573821112513542,0.035628609359264374,0.035454608500003815,0.03583316504955292,0.03546511009335518,0.03541674464941025,0.03538437560200691,0.03566493093967438,0.03556438535451889,0.03532164916396141,0.03535370156168938,0.03523002937436104,0.03546328470110893,0.03519463166594505,0.03525456786155701,0.035203345119953156,0.0353839173913002,0.03504389151930809,0.03499390929937363,0.03539261966943741,0.03502633050084114,0.03512035682797432,0.03514055535197258,0.03505260497331619,0.03495296835899353,0.03494342789053917,0.034824974834918976,0.0351855643093586,0.035016514360904694,0.03477577120065689,0.034806475043296814,0.03483695909380913,0.03494992107152939,0.03486134856939316,0.03482304885983467,0.03473470360040665,0.03513070195913315,0.034767065197229385,0.034745268523693085,0.034707944840192795,0.03459080308675766,0.03481640666723251,0.03456465154886246,0.03477216139435768,0.034725453704595566,0.03471054881811142,0.03469423949718475,0.03453928232192993,0.03441997244954109,0.034858472645282745,0.0348665788769722],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199],"y":[0.11069484055042267,0.10169624537229538,0.095282644033432,0.08997568488121033,0.08541951328516006,0.08130861073732376,0.077923484146595,0.07523763924837112,0.07312144339084625,0.07104647904634476,0.06928703188896179,0.0679909735918045,0.06673424690961838,0.06587521731853485,0.06523233652114868,0.06429971009492874,0.06343793123960495,0.06298574060201645,0.06251757591962814,0.06208697333931923,0.06187561899423599,0.061589453369379044,0.06091909110546112,0.06032717227935791,0.060016557574272156,0.05950121954083443,0.059075817465782166,0.05886632204055786,0.058356475085020065,0.058084309101104736,0.05806607007980347,0.057821497321128845,0.057425227016210556,0.05711851269006729,0.056891974061727524,0.056715916842222214,0.05664435774087906,0.05619572475552559,0.05567629262804985,0.055428072810173035,0.05495360121130943,0.05472290515899658,0.054326675832271576,0.05403188616037369,0.053807105869054794,0.05367622524499893,0.05334383249282837,0.053377628326416016,0.053060173988342285,0.052823856472969055,0.05265694484114647,0.05247156694531441,0.05225004255771637,0.051975104957818985,0.05190081521868706,0.05176501348614693,0.051746916025877,0.05169270932674408,0.05142320320010185,0.051161106675863266,0.051128316670656204,0.05097425356507301,0.05080113559961319,0.050438690930604935,0.05028792843222618,0.050037726759910583,0.04998783767223358,0.049601152539253235,0.049391426146030426,0.049444083124399185,0.04919028654694557,0.048943936824798584,0.04896144941449165,0.04879039525985718,0.04866599664092064,0.04839229956269264,0.048227325081825256,0.048233699053525925,0.04815805330872536,0.04782388359308243,0.04774252325296402,0.04744364321231842,0.04734088480472565,0.04741014167666435,0.047339197248220444,0.047421302646398544,0.04730851575732231,0.04727746546268463,0.0470760241150856,0.04700993001461029,0.04683277755975723,0.04673696681857109,0.04666873440146446,0.04667189344763756,0.046623874455690384,0.046494875103235245,0.04638493061065674,0.04617484658956528,0.04615141078829765,0.04586206376552582,0.045814916491508484,0.04562237113714218,0.04568220674991608,0.04543900117278099,0.04553580656647682,0.04558425769209862,0.045531224459409714,0.045394573360681534,0.045114997774362564,0.04513150081038475,0.04509616270661354,0.044840700924396515,0.044673800468444824,0.04481631889939308,0.04467886686325073,0.0447402261197567,0.04458526149392128,0.044605545699596405,0.04464153200387955,0.0444561205804348,0.0443907231092453,0.044221799820661545,0.04417312890291214,0.04412708804011345,0.044562991708517075,0.04454907402396202,0.04443373903632164,0.0443861223757267,0.044278040528297424,0.04392199590802193,0.04407286271452904,0.04399816691875458,0.04391254112124443,0.04374980181455612,0.043920207768678665,0.04367060959339142,0.043491169810295105,0.043610915541648865,0.04350671544671059,0.043418433517217636,0.04345180094242096,0.043511465191841125,0.043514691293239594,0.04348020255565643,0.04326000064611435,0.043311312794685364,0.043108586221933365,0.043152712285518646,0.04295116290450096,0.04287751764059067,0.04275043308734894,0.0428822860121727,0.042960867285728455,0.04296987131237984,0.04276936501264572,0.04305820167064667,0.043178413063287735,0.043142467737197876,0.042970120906829834,0.04300081357359886,0.042929209768772125,0.042774662375450134,0.042775098234415054,0.04287964105606079,0.04284011200070381,0.042765773832798004,0.04275289550423622,0.042821552604436874,0.042754411697387695,0.04253865405917168,0.04260222613811493,0.04258701205253601,0.04284310340881348,0.042741987854242325,0.04252725467085838,0.04264930263161659,0.04260366037487984,0.04264535382390022,0.04253008961677551,0.04238082841038704,0.04231543838977814,0.04252924025058746,0.042750388383865356,0.04245692864060402,0.042479753494262695,0.042673952877521515,0.04266529157757759,0.04269988834857941,0.04257749393582344,0.04252992570400238,0.04253772273659706,0.04256560653448105,0.042531829327344894,0.04252605140209198,0.04234517738223076,0.04230331629514694,0.042258623987436295,0.04218984767794609,0.042243484407663345,0.0424225889146328],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"training epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training and Validation Loss - LSTM"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('83b196dd-423c-4fbe-8708-302a81dc041b');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="forecasting---next-5-years-60-months-11" class="level4">
<h4 class="anchored" data-anchor-id="forecasting---next-5-years-60-months-11">Forecasting - next 5 years (60 months)</h4>
<div class="cell" data-execution_count="69">
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s1/1 [==============================] - 0s 20ms/step</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="deeplearning_files/figure-html/cell-70-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="discussion-3" class="level3">
<h3 class="anchored" data-anchor-id="discussion-3">Discussion</h3>
<p>For predicting CO2 emissions from petroleum, the training RMSE are: <br> 1) RNN - 0.18713<br> 2) GRU - 0.18709<br> 3) LSTM - 0.18830<br> <br></p>
<p>And the test RMSE are:<br> 1) RNN - 0.09508<br> 2) GRU - 0.14254<br> 3) LSTM - 0.13025<br></p>
<p>Thus, the GRU model minimized RMSE for training predictions, while the RNN model minimized RMSE for test predictions. However, the RNN model may suffer from data leakage so the GRU model is likely the best model for predicting natural gas CO2 emissions going forward. Regularization improved the model performance.</p>
<p>Forecasting here worked better than expected. For all three models I forecasted the next 5 years (60) months, and the forecasted plots appear to mimic the seasonality and spikes of the previous 30 years. Across all three models, the first 4 years are well forecasted and display the expected spikes in emissions during the summer. However, by year 5 forecast weakens and the nuance and variation in the trend is smaller.</p>
<p>The SARIMA(0,1,1)(1,1,1) forecast shared the same seasonality, but exhibited a slight downwards trend across all 5 years. The ANN models exhibit no trend (only seasonality). The RMSE from the ARIMA model was 0.04678813, only slightly smaller than the ANN RMSE. The RNN had an RMSE of 0.09508, so with more model tuning could likely outperform the ARIMA model.</p>
</section>
</section>
</section>
<section id="comparison-of-deep-learning-to-traditional-ts-models" class="level1">
<h1>Comparison of Deep Learning to Traditional TS Models</h1>
<p>In this analysis, I used 3 types of Artificial Neural Networks (ANN) to predict CO2 emissions across 4 different fuel sources: coal, hydrogen gas, natural gas, and petroleum. The goal here was to better understand which fuel sources contribute the most to climate change as well as understand trends for how their usage/consumption is changing over time. I performed a similar analysis in the ARMA/ARIMA/SARIMA Models section. Above, I compared the RMSE results and forecast results of each ANN to the ARMA/ARIMA/SARIMA results but to recap: the traditional time series models underwent significant hyperparameter tuning and model tuning in order to achieve optimal results and minimize RMSE. The ANNs implemented above were simple neural networks with minimal layers, to explore how neural networks can be used in time series analysis. Model tuning was performed, but the NNs could be further robustly tuned to experiment wtih different numbers of recurrent_hidden_units, epochs, activation functions, layers, learning rates, etc. At baseline, the neural networks were able to achieve training RMSEs of around 0.18 across all models and test RMSEs between 0.03 and 0.09. This rivals traditional models after extensive optimization, indicating that the neural networks are far superior models for time series analysis. Recurrent Neural Networks, Gated Recurrent Unit networks, and Long-Short Term Memory networks are all specifically designed to handle sequential data (such as time series) and can handle complex relationships in data better than traditional methods. They are probably better suited for handling multivariate data that a VAR model would use, while traditional time series models do perform well on univariate data like we have here. Additionally, traditional time series models are easy to interpret - whereas neural networks are more convoluted and opaque in their processes and are thus difficult to interpret beyond model fit metrics.</p>
<p>However, both model types performed well in the task of predicting CO2 emissions by source. In forecasting, the ARMA/ARIMA/SARIMA models were able to capture both trend and seasonality for 5 years, while the neural networks performed spectacularly for 4 years and then faltered for year 5 predictions. NN forecasting also didn’t do a great job forecasting overall trend (increases or decreases in CO2 emissions), even though they captured month to month spikes in emissions quite well.</p>
<p>Overall, both types of models can be useful depending on the data, and experimenting with both in order to achieve the optimal forecasting model is a good practice when dealing with any time series data.</p>
<p>Source code for the above analysis: <a href="https://github.com/eliserust/TimeSeries/blob/main/deeplearning.qmd">Github</a></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>